var Ty=Object.create;var $i=Object.defineProperty;var Py=Object.getOwnPropertyDescriptor;var Ey=Object.getOwnPropertyNames;var Iy=Object.getPrototypeOf,Ry=Object.prototype.hasOwnProperty;var z=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ki=(t,e)=>{for(var r in e)$i(t,r,{get:e[r],enumerable:!0})},Ny=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Ey(e))!Ry.call(t,o)&&o!==r&&$i(t,o,{get:()=>e[o],enumerable:!(n=Py(e,o))||n.enumerable});return t};var ud=(t,e,r)=>(r=t!=null?Ty(Iy(t)):{},Ny(e||!t||!t.__esModule?$i(r,"default",{value:t,enumerable:!0}):r,t));var Xn=z(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.regexpCode=X.getEsmExportName=X.getProperty=X.safeStringify=X.stringify=X.strConcat=X.addCodeArg=X.str=X._=X.nil=X._Code=X.Name=X.IDENTIFIER=X._CodeOrName=void 0;var Wn=class{};X._CodeOrName=Wn;X.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var Tr=class extends Wn{constructor(e){if(super(),!X.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};X.Name=Tr;var rt=class extends Wn{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof Tr&&(r[n.str]=(r[n.str]||0)+1),r),{})}};X._Code=rt;X.nil=new rt("");function sm(t,...e){let r=[t[0]],n=0;for(;n<e.length;)au(r,e[n]),r.push(t[++n]);return new rt(r)}X._=sm;var iu=new rt("+");function im(t,...e){let r=[Yn(t[0])],n=0;for(;n<e.length;)r.push(iu),au(r,e[n]),r.push(iu,Yn(t[++n]));return E$(r),new rt(r)}X.str=im;function au(t,e){e instanceof rt?t.push(...e._items):e instanceof Tr?t.push(e):t.push(N$(e))}X.addCodeArg=au;function E$(t){let e=1;for(;e<t.length-1;){if(t[e]===iu){let r=I$(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function I$(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof Tr||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof Tr))return`"${t}${e.slice(1)}`}function R$(t,e){return e.emptyStr()?t:t.emptyStr()?e:im`${t}${e}`}X.strConcat=R$;function N$(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Yn(Array.isArray(t)?t.join(","):t)}function O$(t){return new rt(Yn(t))}X.stringify=O$;function Yn(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}X.safeStringify=Yn;function Z$(t){return typeof t=="string"&&X.IDENTIFIER.test(t)?new rt(`.${t}`):sm`[${t}]`}X.getProperty=Z$;function j$(t){if(typeof t=="string"&&X.IDENTIFIER.test(t))return new rt(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}X.getEsmExportName=j$;function C$(t){return new rt(t.toString())}X.regexpCode=C$});var lu=z(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.ValueScope=Fe.ValueScopeName=Fe.Scope=Fe.varKinds=Fe.UsedValueState=void 0;var Ve=Xn(),cu=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},Is;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(Is||(Fe.UsedValueState=Is={}));Fe.varKinds={const:new Ve.Name("const"),let:new Ve.Name("let"),var:new Ve.Name("var")};var Rs=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof Ve.Name?e:this.name(e)}name(e){return new Ve.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};Fe.Scope=Rs;var Ns=class extends Ve.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,Ve._)`.${new Ve.Name(r)}[${n}]`}};Fe.ValueScopeName=Ns;var A$=(0,Ve._)`\n`,uu=class extends Rs{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?A$:Ve.nil}}get(){return this._scope}name(e){return new Ns(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let o=this.toName(e),{prefix:s}=o,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[s];if(a){let l=a.get(i);if(l)return l}else a=this._values[s]=new Map;a.set(i,o);let c=this._scope[s]||(this._scope[s]=[]),u=c.length;return c[u]=r.ref,o.setValue(r,{property:s,itemIndex:u}),o}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,Ve._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,o=>{if(o.value===void 0)throw new Error(`CodeGen: name "${o}" has no value`);return o.value.code},r,n)}_reduceValues(e,r,n={},o){let s=Ve.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,Is.Started);let l=r(u);if(l){let d=this.opts.es5?Fe.varKinds.var:Fe.varKinds.const;s=(0,Ve._)`${s}${d} ${u} = ${l};${this.opts._n}`}else if(l=o?.(u))s=(0,Ve._)`${s}${l}${this.opts._n}`;else throw new cu(u);c.set(u,Is.Completed)})}return s}};Fe.ValueScope=uu});var U=z(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.or=V.and=V.not=V.CodeGen=V.operators=V.varKinds=V.ValueScopeName=V.ValueScope=V.Scope=V.Name=V.regexpCode=V.stringify=V.getProperty=V.nil=V.strConcat=V.str=V._=void 0;var J=Xn(),lt=lu(),Kt=Xn();Object.defineProperty(V,"_",{enumerable:!0,get:function(){return Kt._}});Object.defineProperty(V,"str",{enumerable:!0,get:function(){return Kt.str}});Object.defineProperty(V,"strConcat",{enumerable:!0,get:function(){return Kt.strConcat}});Object.defineProperty(V,"nil",{enumerable:!0,get:function(){return Kt.nil}});Object.defineProperty(V,"getProperty",{enumerable:!0,get:function(){return Kt.getProperty}});Object.defineProperty(V,"stringify",{enumerable:!0,get:function(){return Kt.stringify}});Object.defineProperty(V,"regexpCode",{enumerable:!0,get:function(){return Kt.regexpCode}});Object.defineProperty(V,"Name",{enumerable:!0,get:function(){return Kt.Name}});var Cs=lu();Object.defineProperty(V,"Scope",{enumerable:!0,get:function(){return Cs.Scope}});Object.defineProperty(V,"ValueScope",{enumerable:!0,get:function(){return Cs.ValueScope}});Object.defineProperty(V,"ValueScopeName",{enumerable:!0,get:function(){return Cs.ValueScopeName}});Object.defineProperty(V,"varKinds",{enumerable:!0,get:function(){return Cs.varKinds}});V.operators={GT:new J._Code(">"),GTE:new J._Code(">="),LT:new J._Code("<"),LTE:new J._Code("<="),EQ:new J._Code("==="),NEQ:new J._Code("!=="),NOT:new J._Code("!"),OR:new J._Code("||"),AND:new J._Code("&&"),ADD:new J._Code("+")};var Rt=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},du=class extends Rt{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?lt.varKinds.var:this.varKind,o=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${o};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=on(this.rhs,e,r)),this}get names(){return this.rhs instanceof J._CodeOrName?this.rhs.names:{}}},Os=class extends Rt{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof J.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=on(this.rhs,e,r),this}get names(){let e=this.lhs instanceof J.Name?{}:{...this.lhs.names};return js(e,this.rhs)}},pu=class extends Os{constructor(e,r,n,o){super(e,n,o),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},fu=class extends Rt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},mu=class extends Rt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},hu=class extends Rt{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},gu=class extends Rt{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=on(this.code,e,r),this}get names(){return this.code instanceof J._CodeOrName?this.code.names:{}}},Qn=class extends Rt{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,o=n.length;for(;o--;){let s=n[o];s.optimizeNames(e,r)||(M$(e,s.names),n.splice(o,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>Ir(e,r.names),{})}},Nt=class extends Qn{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},yu=class extends Qn{},nn=class extends Nt{};nn.kind="else";var Pr=class t extends Nt{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new nn(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(am(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=on(this.condition,e,r),this}get names(){let e=super.names;return js(e,this.condition),this.else&&Ir(e,this.else.names),e}};Pr.kind="if";var Er=class extends Nt{};Er.kind="for";var _u=class extends Er{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=on(this.iteration,e,r),this}get names(){return Ir(super.names,this.iteration.names)}},vu=class extends Er{constructor(e,r,n,o){super(),this.varKind=e,this.name=r,this.from=n,this.to=o}render(e){let r=e.es5?lt.varKinds.var:this.varKind,{name:n,from:o,to:s}=this;return`for(${r} ${n}=${o}; ${n}<${s}; ${n}++)`+super.render(e)}get names(){let e=js(super.names,this.from);return js(e,this.to)}},Zs=class extends Er{constructor(e,r,n,o){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=o}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=on(this.iterable,e,r),this}get names(){return Ir(super.names,this.iterable.names)}},eo=class extends Nt{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};eo.kind="func";var to=class extends Qn{render(e){return"return "+super.render(e)}};to.kind="return";var xu=class extends Nt{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,o;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(o=this.finally)===null||o===void 0||o.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&Ir(e,this.catch.names),this.finally&&Ir(e,this.finally.names),e}},ro=class extends Nt{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};ro.kind="catch";var no=class extends Nt{render(e){return"finally"+super.render(e)}};no.kind="finally";var bu=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new lt.Scope({parent:e}),this._nodes=[new yu]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,o){let s=this._scope.toName(r);return n!==void 0&&o&&(this._constants[s.str]=n),this._leafNode(new du(e,s,n)),s}const(e,r,n){return this._def(lt.varKinds.const,e,r,n)}let(e,r,n){return this._def(lt.varKinds.let,e,r,n)}var(e,r,n){return this._def(lt.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new Os(e,r,n))}add(e,r){return this._leafNode(new pu(e,V.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==J.nil&&this._leafNode(new gu(e)),this}object(...e){let r=["{"];for(let[n,o]of e)r.length>1&&r.push(","),r.push(n),(n!==o||this.opts.es5)&&(r.push(":"),(0,J.addCodeArg)(r,o));return r.push("}"),new J._Code(r)}if(e,r,n){if(this._blockNode(new Pr(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new Pr(e))}else(){return this._elseNode(new nn)}endIf(){return this._endBlockNode(Pr,nn)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new _u(e),r)}forRange(e,r,n,o,s=this.opts.es5?lt.varKinds.var:lt.varKinds.let){let i=this._scope.toName(e);return this._for(new vu(s,i,r,n),()=>o(i))}forOf(e,r,n,o=lt.varKinds.const){let s=this._scope.toName(e);if(this.opts.es5){let i=r instanceof J.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,J._)`${i}.length`,a=>{this.var(s,(0,J._)`${i}[${a}]`),n(s)})}return this._for(new Zs("of",o,s,r),()=>n(s))}forIn(e,r,n,o=this.opts.es5?lt.varKinds.var:lt.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,J._)`Object.keys(${r})`,n);let s=this._scope.toName(e);return this._for(new Zs("in",o,s,r),()=>n(s))}endFor(){return this._endBlockNode(Er)}label(e){return this._leafNode(new fu(e))}break(e){return this._leafNode(new mu(e))}return(e){let r=new to;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(to)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let o=new xu;if(this._blockNode(o),this.code(e),r){let s=this.name("e");this._currNode=o.catch=new ro(s),r(s)}return n&&(this._currNode=o.finally=new no,this.code(n)),this._endBlockNode(ro,no)}throw(e){return this._leafNode(new hu(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=J.nil,n,o){return this._blockNode(new eo(e,r,n)),o&&this.code(o).endFunc(),this}endFunc(){return this._endBlockNode(eo)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof Pr))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};V.CodeGen=bu;function Ir(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function js(t,e){return e instanceof J._CodeOrName?Ir(t,e.names):t}function on(t,e,r){if(t instanceof J.Name)return n(t);if(!o(t))return t;return new J._Code(t._items.reduce((s,i)=>(i instanceof J.Name&&(i=n(i)),i instanceof J._Code?s.push(...i._items):s.push(i),s),[]));function n(s){let i=r[s.str];return i===void 0||e[s.str]!==1?s:(delete e[s.str],i)}function o(s){return s instanceof J._Code&&s._items.some(i=>i instanceof J.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function M$(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function am(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,J._)`!${$u(t)}`}V.not=am;var D$=cm(V.operators.AND);function q$(...t){return t.reduce(D$)}V.and=q$;var L$=cm(V.operators.OR);function U$(...t){return t.reduce(L$)}V.or=U$;function cm(t){return(e,r)=>e===J.nil?r:r===J.nil?e:(0,J._)`${$u(e)} ${t} ${$u(r)}`}function $u(t){return t instanceof J.Name?t:(0,J._)`(${t})`}});var W=z(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.checkStrictMode=F.getErrorPath=F.Type=F.useFunc=F.setEvaluated=F.evaluatedPropsToName=F.mergeEvaluated=F.eachItem=F.unescapeJsonPointer=F.escapeJsonPointer=F.escapeFragment=F.unescapeFragment=F.schemaRefOrVal=F.schemaHasRulesButRef=F.schemaHasRules=F.checkUnknownRules=F.alwaysValidSchema=F.toHash=void 0;var ne=U(),V$=Xn();function F$(t){let e={};for(let r of t)e[r]=!0;return e}F.toHash=F$;function H$(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(dm(t,e),!pm(e,t.self.RULES.all))}F.alwaysValidSchema=H$;function dm(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let o=n.RULES.keywords;for(let s in e)o[s]||hm(t,`unknown keyword: "${s}"`)}F.checkUnknownRules=dm;function pm(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}F.schemaHasRules=pm;function B$(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}F.schemaHasRulesButRef=B$;function G$({topSchemaRef:t,schemaPath:e},r,n,o){if(!o){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,ne._)`${r}`}return(0,ne._)`${t}${e}${(0,ne.getProperty)(n)}`}F.schemaRefOrVal=G$;function K$(t){return fm(decodeURIComponent(t))}F.unescapeFragment=K$;function J$(t){return encodeURIComponent(wu(t))}F.escapeFragment=J$;function wu(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}F.escapeJsonPointer=wu;function fm(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}F.unescapeJsonPointer=fm;function W$(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}F.eachItem=W$;function um({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(o,s,i,a)=>{let c=i===void 0?s:i instanceof ne.Name?(s instanceof ne.Name?t(o,s,i):e(o,s,i),i):s instanceof ne.Name?(e(o,i,s),s):r(s,i);return a===ne.Name&&!(c instanceof ne.Name)?n(o,c):c}}F.mergeEvaluated={props:um({mergeNames:(t,e,r)=>t.if((0,ne._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,ne._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,ne._)`${r} || {}`).code((0,ne._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,ne._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,ne._)`${r} || {}`),Su(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:mm}),items:um({mergeNames:(t,e,r)=>t.if((0,ne._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,ne._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,ne._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,ne._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function mm(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,ne._)`{}`);return e!==void 0&&Su(t,r,e),r}F.evaluatedPropsToName=mm;function Su(t,e,r){Object.keys(r).forEach(n=>t.assign((0,ne._)`${e}${(0,ne.getProperty)(n)}`,!0))}F.setEvaluated=Su;var lm={};function Y$(t,e){return t.scopeValue("func",{ref:e,code:lm[e.code]||(lm[e.code]=new V$._Code(e.code))})}F.useFunc=Y$;var ku;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(ku||(F.Type=ku={}));function X$(t,e,r){if(t instanceof ne.Name){let n=e===ku.Num;return r?n?(0,ne._)`"[" + ${t} + "]"`:(0,ne._)`"['" + ${t} + "']"`:n?(0,ne._)`"/" + ${t}`:(0,ne._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,ne.getProperty)(t).toString():"/"+wu(t)}F.getErrorPath=X$;function hm(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}F.checkStrictMode=hm});var Ot=z(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});var Ne=U(),Q$={data:new Ne.Name("data"),valCxt:new Ne.Name("valCxt"),instancePath:new Ne.Name("instancePath"),parentData:new Ne.Name("parentData"),parentDataProperty:new Ne.Name("parentDataProperty"),rootData:new Ne.Name("rootData"),dynamicAnchors:new Ne.Name("dynamicAnchors"),vErrors:new Ne.Name("vErrors"),errors:new Ne.Name("errors"),this:new Ne.Name("this"),self:new Ne.Name("self"),scope:new Ne.Name("scope"),json:new Ne.Name("json"),jsonPos:new Ne.Name("jsonPos"),jsonLen:new Ne.Name("jsonLen"),jsonPart:new Ne.Name("jsonPart")};zu.default=Q$});var oo=z(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.extendErrors=Oe.resetErrorsCount=Oe.reportExtraError=Oe.reportError=Oe.keyword$DataError=Oe.keywordError=void 0;var Y=U(),As=W(),Ae=Ot();Oe.keywordError={message:({keyword:t})=>(0,Y.str)`must pass "${t}" keyword validation`};Oe.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,Y.str)`"${t}" keyword must be ${e} ($data)`:(0,Y.str)`"${t}" keyword is invalid ($data)`};function e0(t,e=Oe.keywordError,r,n){let{it:o}=t,{gen:s,compositeRule:i,allErrors:a}=o,c=_m(t,e,r);n??(i||a)?gm(s,c):ym(o,(0,Y._)`[${c}]`)}Oe.reportError=e0;function t0(t,e=Oe.keywordError,r){let{it:n}=t,{gen:o,compositeRule:s,allErrors:i}=n,a=_m(t,e,r);gm(o,a),s||i||ym(n,Ae.default.vErrors)}Oe.reportExtraError=t0;function r0(t,e){t.assign(Ae.default.errors,e),t.if((0,Y._)`${Ae.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,Y._)`${Ae.default.vErrors}.length`,e),()=>t.assign(Ae.default.vErrors,null)))}Oe.resetErrorsCount=r0;function n0({gen:t,keyword:e,schemaValue:r,data:n,errsCount:o,it:s}){if(o===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",o,Ae.default.errors,a=>{t.const(i,(0,Y._)`${Ae.default.vErrors}[${a}]`),t.if((0,Y._)`${i}.instancePath === undefined`,()=>t.assign((0,Y._)`${i}.instancePath`,(0,Y.strConcat)(Ae.default.instancePath,s.errorPath))),t.assign((0,Y._)`${i}.schemaPath`,(0,Y.str)`${s.errSchemaPath}/${e}`),s.opts.verbose&&(t.assign((0,Y._)`${i}.schema`,r),t.assign((0,Y._)`${i}.data`,n))})}Oe.extendErrors=n0;function gm(t,e){let r=t.const("err",e);t.if((0,Y._)`${Ae.default.vErrors} === null`,()=>t.assign(Ae.default.vErrors,(0,Y._)`[${r}]`),(0,Y._)`${Ae.default.vErrors}.push(${r})`),t.code((0,Y._)`${Ae.default.errors}++`)}function ym(t,e){let{gen:r,validateName:n,schemaEnv:o}=t;o.$async?r.throw((0,Y._)`new ${t.ValidationError}(${e})`):(r.assign((0,Y._)`${n}.errors`,e),r.return(!1))}var Rr={keyword:new Y.Name("keyword"),schemaPath:new Y.Name("schemaPath"),params:new Y.Name("params"),propertyName:new Y.Name("propertyName"),message:new Y.Name("message"),schema:new Y.Name("schema"),parentSchema:new Y.Name("parentSchema")};function _m(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,Y._)`{}`:o0(t,e,r)}function o0(t,e,r={}){let{gen:n,it:o}=t,s=[s0(o,r),i0(t,r)];return a0(t,e,s),n.object(...s)}function s0({errorPath:t},{instancePath:e}){let r=e?(0,Y.str)`${t}${(0,As.getErrorPath)(e,As.Type.Str)}`:t;return[Ae.default.instancePath,(0,Y.strConcat)(Ae.default.instancePath,r)]}function i0({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let o=n?e:(0,Y.str)`${e}/${t}`;return r&&(o=(0,Y.str)`${o}${(0,As.getErrorPath)(r,As.Type.Str)}`),[Rr.schemaPath,o]}function a0(t,{params:e,message:r},n){let{keyword:o,data:s,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([Rr.keyword,o],[Rr.params,typeof e=="function"?e(t):e||(0,Y._)`{}`]),c.messages&&n.push([Rr.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([Rr.schema,i],[Rr.parentSchema,(0,Y._)`${l}${d}`],[Ae.default.data,s]),u&&n.push([Rr.propertyName,u])}});var xm=z(sn=>{"use strict";Object.defineProperty(sn,"__esModule",{value:!0});sn.boolOrEmptySchema=sn.topBoolOrEmptySchema=void 0;var c0=oo(),u0=U(),l0=Ot(),d0={message:"boolean schema is false"};function p0(t){let{gen:e,schema:r,validateName:n}=t;r===!1?vm(t,!1):typeof r=="object"&&r.$async===!0?e.return(l0.default.data):(e.assign((0,u0._)`${n}.errors`,null),e.return(!0))}sn.topBoolOrEmptySchema=p0;function f0(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),vm(t)):r.var(e,!0)}sn.boolOrEmptySchema=f0;function vm(t,e){let{gen:r,data:n}=t,o={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,c0.reportError)(o,d0,void 0,e)}});var Tu=z(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.getRules=an.isJSONType=void 0;var m0=["string","number","integer","boolean","null","object","array"],h0=new Set(m0);function g0(t){return typeof t=="string"&&h0.has(t)}an.isJSONType=g0;function y0(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}an.getRules=y0});var Pu=z(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.shouldUseRule=Jt.shouldUseGroup=Jt.schemaHasRulesForType=void 0;function _0({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&bm(t,n)}Jt.schemaHasRulesForType=_0;function bm(t,e){return e.rules.some(r=>$m(t,r))}Jt.shouldUseGroup=bm;function $m(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Jt.shouldUseRule=$m});var so=z(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.reportTypeError=Ze.checkDataTypes=Ze.checkDataType=Ze.coerceAndCheckDataType=Ze.getJSONTypes=Ze.getSchemaTypes=Ze.DataType=void 0;var v0=Tu(),x0=Pu(),b0=oo(),q=U(),km=W(),cn;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(cn||(Ze.DataType=cn={}));function $0(t){let e=wm(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Ze.getSchemaTypes=$0;function wm(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(v0.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Ze.getJSONTypes=wm;function k0(t,e){let{gen:r,data:n,opts:o}=t,s=w0(e,o.coerceTypes),i=e.length>0&&!(s.length===0&&e.length===1&&(0,x0.schemaHasRulesForType)(t,e[0]));if(i){let a=Iu(e,n,o.strictNumbers,cn.Wrong);r.if(a,()=>{s.length?S0(t,e,s):Ru(t)})}return i}Ze.coerceAndCheckDataType=k0;var Sm=new Set(["string","number","integer","boolean","null"]);function w0(t,e){return e?t.filter(r=>Sm.has(r)||e==="array"&&r==="array"):[]}function S0(t,e,r){let{gen:n,data:o,opts:s}=t,i=n.let("dataType",(0,q._)`typeof ${o}`),a=n.let("coerced",(0,q._)`undefined`);s.coerceTypes==="array"&&n.if((0,q._)`${i} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,()=>n.assign(o,(0,q._)`${o}[0]`).assign(i,(0,q._)`typeof ${o}`).if(Iu(e,o,s.strictNumbers),()=>n.assign(a,o))),n.if((0,q._)`${a} !== undefined`);for(let u of r)(Sm.has(u)||u==="array"&&s.coerceTypes==="array")&&c(u);n.else(),Ru(t),n.endIf(),n.if((0,q._)`${a} !== undefined`,()=>{n.assign(o,a),z0(t,a)});function c(u){switch(u){case"string":n.elseIf((0,q._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,q._)`"" + ${o}`).elseIf((0,q._)`${o} === null`).assign(a,(0,q._)`""`);return;case"number":n.elseIf((0,q._)`${i} == "boolean" || ${o} === null
              || (${i} == "string" && ${o} && ${o} == +${o})`).assign(a,(0,q._)`+${o}`);return;case"integer":n.elseIf((0,q._)`${i} === "boolean" || ${o} === null
              || (${i} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(a,(0,q._)`+${o}`);return;case"boolean":n.elseIf((0,q._)`${o} === "false" || ${o} === 0 || ${o} === null`).assign(a,!1).elseIf((0,q._)`${o} === "true" || ${o} === 1`).assign(a,!0);return;case"null":n.elseIf((0,q._)`${o} === "" || ${o} === 0 || ${o} === false`),n.assign(a,null);return;case"array":n.elseIf((0,q._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${o} === null`).assign(a,(0,q._)`[${o}]`)}}}function z0({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,q._)`${e} !== undefined`,()=>t.assign((0,q._)`${e}[${r}]`,n))}function Eu(t,e,r,n=cn.Correct){let o=n===cn.Correct?q.operators.EQ:q.operators.NEQ,s;switch(t){case"null":return(0,q._)`${e} ${o} null`;case"array":s=(0,q._)`Array.isArray(${e})`;break;case"object":s=(0,q._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":s=i((0,q._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":s=i();break;default:return(0,q._)`typeof ${e} ${o} ${t}`}return n===cn.Correct?s:(0,q.not)(s);function i(a=q.nil){return(0,q.and)((0,q._)`typeof ${e} == "number"`,a,r?(0,q._)`isFinite(${e})`:q.nil)}}Ze.checkDataType=Eu;function Iu(t,e,r,n){if(t.length===1)return Eu(t[0],e,r,n);let o,s=(0,km.toHash)(t);if(s.array&&s.object){let i=(0,q._)`typeof ${e} != "object"`;o=s.null?i:(0,q._)`!${e} || ${i}`,delete s.null,delete s.array,delete s.object}else o=q.nil;s.number&&delete s.integer;for(let i in s)o=(0,q.and)(o,Eu(i,e,r,n));return o}Ze.checkDataTypes=Iu;var T0={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,q._)`{type: ${t}}`:(0,q._)`{type: ${e}}`};function Ru(t){let e=P0(t);(0,b0.reportError)(e,T0)}Ze.reportTypeError=Ru;function P0(t){let{gen:e,data:r,schema:n}=t,o=(0,km.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:o,schemaValue:o,parentSchema:n,params:{},it:t}}});var Tm=z(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.assignDefaults=void 0;var un=U(),E0=W();function I0(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let o in r)zm(t,o,r[o].default);else e==="array"&&Array.isArray(n)&&n.forEach((o,s)=>zm(t,s,o.default))}Ms.assignDefaults=I0;function zm(t,e,r){let{gen:n,compositeRule:o,data:s,opts:i}=t;if(r===void 0)return;let a=(0,un._)`${s}${(0,un.getProperty)(e)}`;if(o){(0,E0.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,un._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,un._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,un._)`${a} = ${(0,un.stringify)(r)}`)}});var nt=z(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.validateUnion=re.validateArray=re.usePattern=re.callValidateCode=re.schemaProperties=re.allSchemaProperties=re.noPropertyInData=re.propertyInData=re.isOwnProperty=re.hasPropFunc=re.reportMissingProp=re.checkMissingProp=re.checkReportMissingProp=void 0;var le=U(),Nu=W(),Wt=Ot(),R0=W();function N0(t,e){let{gen:r,data:n,it:o}=t;r.if(Zu(r,n,e,o.opts.ownProperties),()=>{t.setParams({missingProperty:(0,le._)`${e}`},!0),t.error()})}re.checkReportMissingProp=N0;function O0({gen:t,data:e,it:{opts:r}},n,o){return(0,le.or)(...n.map(s=>(0,le.and)(Zu(t,e,s,r.ownProperties),(0,le._)`${o} = ${s}`)))}re.checkMissingProp=O0;function Z0(t,e){t.setParams({missingProperty:e},!0),t.error()}re.reportMissingProp=Z0;function Pm(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,le._)`Object.prototype.hasOwnProperty`})}re.hasPropFunc=Pm;function Ou(t,e,r){return(0,le._)`${Pm(t)}.call(${e}, ${r})`}re.isOwnProperty=Ou;function j0(t,e,r,n){let o=(0,le._)`${e}${(0,le.getProperty)(r)} !== undefined`;return n?(0,le._)`${o} && ${Ou(t,e,r)}`:o}re.propertyInData=j0;function Zu(t,e,r,n){let o=(0,le._)`${e}${(0,le.getProperty)(r)} === undefined`;return n?(0,le.or)(o,(0,le.not)(Ou(t,e,r))):o}re.noPropertyInData=Zu;function Em(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}re.allSchemaProperties=Em;function C0(t,e){return Em(e).filter(r=>!(0,Nu.alwaysValidSchema)(t,e[r]))}re.schemaProperties=C0;function A0({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:o,errorPath:s},it:i},a,c,u){let l=u?(0,le._)`${t}, ${e}, ${n}${o}`:e,d=[[Wt.default.instancePath,(0,le.strConcat)(Wt.default.instancePath,s)],[Wt.default.parentData,i.parentData],[Wt.default.parentDataProperty,i.parentDataProperty],[Wt.default.rootData,Wt.default.rootData]];i.opts.dynamicRef&&d.push([Wt.default.dynamicAnchors,Wt.default.dynamicAnchors]);let h=(0,le._)`${l}, ${r.object(...d)}`;return c!==le.nil?(0,le._)`${a}.call(${c}, ${h})`:(0,le._)`${a}(${h})`}re.callValidateCode=A0;var M0=(0,le._)`new RegExp`;function D0({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:o}=e.code,s=o(r,n);return t.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,le._)`${o.code==="new RegExp"?M0:(0,R0.useFunc)(t,o)}(${r}, ${n})`})}re.usePattern=D0;function q0(t){let{gen:e,data:r,keyword:n,it:o}=t,s=e.name("valid");if(o.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(s,!0),i(()=>e.break()),s;function i(a){let c=e.const("len",(0,le._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:Nu.Type.Num},s),e.if((0,le.not)(s),a)})}}re.validateArray=q0;function L0(t){let{gen:e,schema:r,keyword:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,Nu.alwaysValidSchema)(o,c))&&!o.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,le._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,le.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}re.validateUnion=L0});var Nm=z(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.validateKeywordUsage=vt.validSchemaType=vt.funcKeywordCode=vt.macroKeywordCode=void 0;var Me=U(),Nr=Ot(),U0=nt(),V0=oo();function F0(t,e){let{gen:r,keyword:n,schema:o,parentSchema:s,it:i}=t,a=e.macro.call(i.self,o,s,i),c=Rm(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:Me.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}vt.macroKeywordCode=F0;function H0(t,e){var r;let{gen:n,keyword:o,schema:s,parentSchema:i,$data:a,it:c}=t;G0(c,e);let u=!a&&e.compile?e.compile.call(c.self,s,i,c):e.validate,l=Rm(n,o,u),d=n.let("valid");t.block$data(d,h),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function h(){if(e.errors===!1)m(),e.modifying&&Im(t),g(()=>t.error());else{let v=e.async?f():p();e.modifying&&Im(t),g(()=>B0(t,v))}}function f(){let v=n.let("ruleErrs",null);return n.try(()=>m((0,Me._)`await `),x=>n.assign(d,!1).if((0,Me._)`${x} instanceof ${c.ValidationError}`,()=>n.assign(v,(0,Me._)`${x}.errors`),()=>n.throw(x))),v}function p(){let v=(0,Me._)`${l}.errors`;return n.assign(v,null),m(Me.nil),v}function m(v=e.async?(0,Me._)`await `:Me.nil){let x=c.opts.passContext?Nr.default.this:Nr.default.self,k=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,Me._)`${v}${(0,U0.callValidateCode)(t,l,x,k)}`,e.modifying)}function g(v){var x;n.if((0,Me.not)((x=e.valid)!==null&&x!==void 0?x:d),v)}}vt.funcKeywordCode=H0;function Im(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Me._)`${n.parentData}[${n.parentDataProperty}]`))}function B0(t,e){let{gen:r}=t;r.if((0,Me._)`Array.isArray(${e})`,()=>{r.assign(Nr.default.vErrors,(0,Me._)`${Nr.default.vErrors} === null ? ${e} : ${Nr.default.vErrors}.concat(${e})`).assign(Nr.default.errors,(0,Me._)`${Nr.default.vErrors}.length`),(0,V0.extendErrors)(t)},()=>t.error())}function G0({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function Rm(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Me.stringify)(r)})}function K0(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}vt.validSchemaType=K0;function J0({schema:t,opts:e,self:r,errSchemaPath:n},o,s){if(Array.isArray(o.keyword)?!o.keyword.includes(s):o.keyword!==s)throw new Error("ajv implementation error");let i=o.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${s}: ${i.join(",")}`);if(o.validateSchema&&!o.validateSchema(t[s])){let c=`keyword "${s}" value is invalid at path "${n}": `+r.errorsText(o.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}vt.validateKeywordUsage=J0});var Zm=z(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.extendSubschemaMode=Yt.extendSubschemaData=Yt.getSubschema=void 0;var xt=U(),Om=W();function W0(t,{keyword:e,schemaProp:r,schema:n,schemaPath:o,errSchemaPath:s,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,xt._)`${t.schemaPath}${(0,xt.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,xt._)`${t.schemaPath}${(0,xt.getProperty)(e)}${(0,xt.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,Om.escapeFragment)(r)}`}}if(n!==void 0){if(o===void 0||s===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:o,topSchemaRef:i,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}Yt.getSubschema=W0;function Y0(t,e,{dataProp:r,dataPropType:n,data:o,dataTypes:s,propertyName:i}){if(o!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,h=a.let("data",(0,xt._)`${e.data}${(0,xt.getProperty)(r)}`,!0);c(h),t.errorPath=(0,xt.str)`${u}${(0,Om.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,xt._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(o!==void 0){let u=o instanceof xt.Name?o:a.let("data",o,!0);c(u),i!==void 0&&(t.propertyName=i)}s&&(t.dataTypes=s);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Yt.extendSubschemaData=Y0;function X0(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:o,allErrors:s}){n!==void 0&&(t.compositeRule=n),o!==void 0&&(t.createErrors=o),s!==void 0&&(t.allErrors=s),t.jtdDiscriminator=e,t.jtdMetadata=r}Yt.extendSubschemaMode=X0});var ju=z((uN,jm)=>{"use strict";jm.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;o--!==0;){var i=s[o];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var Am=z((lN,Cm)=>{"use strict";var Xt=Cm.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},o=r.post||function(){};Ds(e,n,o,t,"",t)};Xt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Xt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Xt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Xt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Ds(t,e,r,n,o,s,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,o,s,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Xt.arrayKeywords)for(var h=0;h<d.length;h++)Ds(t,e,r,d[h],o+"/"+l+"/"+h,s,o,l,n,h)}else if(l in Xt.propsKeywords){if(d&&typeof d=="object")for(var f in d)Ds(t,e,r,d[f],o+"/"+l+"/"+Q0(f),s,o,l,n,f)}else(l in Xt.keywords||t.allKeys&&!(l in Xt.skipKeywords))&&Ds(t,e,r,d,o+"/"+l,s,o,l,n)}r(n,o,s,i,a,c,u)}}function Q0(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var io=z(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.getSchemaRefs=He.resolveUrl=He.normalizeId=He._getFullPath=He.getFullPath=He.inlineRef=void 0;var ek=W(),tk=ju(),rk=Am(),nk=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function ok(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Cu(t):e?Mm(t)<=e:!1}He.inlineRef=ok;var sk=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Cu(t){for(let e in t){if(sk.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(Cu)||typeof r=="object"&&Cu(r))return!0}return!1}function Mm(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!nk.has(r)&&(typeof t[r]=="object"&&(0,ek.eachItem)(t[r],n=>e+=Mm(n)),e===1/0))return 1/0}return e}function Dm(t,e="",r){r!==!1&&(e=ln(e));let n=t.parse(e);return qm(t,n)}He.getFullPath=Dm;function qm(t,e){return t.serialize(e).split("#")[0]+"#"}He._getFullPath=qm;var ik=/#\/?$/;function ln(t){return t?t.replace(ik,""):""}He.normalizeId=ln;function ak(t,e,r){return r=ln(r),t.resolve(e,r)}He.resolveUrl=ak;var ck=/^[a-z_][-a-z0-9._]*$/i;function uk(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,o=ln(t[r]||e),s={"":o},i=Dm(n,o,!1),a={},c=new Set;return rk(t,{allKeys:!0},(d,h,f,p)=>{if(p===void 0)return;let m=i+h,g=s[p];typeof d[r]=="string"&&(g=v.call(this,d[r])),x.call(this,d.$anchor),x.call(this,d.$dynamicAnchor),s[h]=g;function v(k){let S=this.opts.uriResolver.resolve;if(k=ln(g?S(g,k):k),c.has(k))throw l(k);c.add(k);let O=this.refs[k];return typeof O=="string"&&(O=this.refs[O]),typeof O=="object"?u(d,O.schema,k):k!==ln(m)&&(k[0]==="#"?(u(d,a[k],k),a[k]=d):this.refs[k]=m),k}function x(k){if(typeof k=="string"){if(!ck.test(k))throw new Error(`invalid anchor "${k}"`);v.call(this,`#${k}`)}}}),a;function u(d,h,f){if(h!==void 0&&!tk(d,h))throw l(f)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}He.getSchemaRefs=uk});var uo=z(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.getData=Qt.KeywordCxt=Qt.validateFunctionCode=void 0;var Hm=xm(),Lm=so(),Mu=Pu(),qs=so(),lk=Tm(),co=Nm(),Au=Zm(),N=U(),M=Ot(),dk=io(),Zt=W(),ao=oo();function pk(t){if(Km(t)&&(Jm(t),Gm(t))){hk(t);return}Bm(t,()=>(0,Hm.topBoolOrEmptySchema)(t))}Qt.validateFunctionCode=pk;function Bm({gen:t,validateName:e,schema:r,schemaEnv:n,opts:o},s){o.code.es5?t.func(e,(0,N._)`${M.default.data}, ${M.default.valCxt}`,n.$async,()=>{t.code((0,N._)`"use strict"; ${Um(r,o)}`),mk(t,o),t.code(s)}):t.func(e,(0,N._)`${M.default.data}, ${fk(o)}`,n.$async,()=>t.code(Um(r,o)).code(s))}function fk(t){return(0,N._)`{${M.default.instancePath}="", ${M.default.parentData}, ${M.default.parentDataProperty}, ${M.default.rootData}=${M.default.data}${t.dynamicRef?(0,N._)`, ${M.default.dynamicAnchors}={}`:N.nil}}={}`}function mk(t,e){t.if(M.default.valCxt,()=>{t.var(M.default.instancePath,(0,N._)`${M.default.valCxt}.${M.default.instancePath}`),t.var(M.default.parentData,(0,N._)`${M.default.valCxt}.${M.default.parentData}`),t.var(M.default.parentDataProperty,(0,N._)`${M.default.valCxt}.${M.default.parentDataProperty}`),t.var(M.default.rootData,(0,N._)`${M.default.valCxt}.${M.default.rootData}`),e.dynamicRef&&t.var(M.default.dynamicAnchors,(0,N._)`${M.default.valCxt}.${M.default.dynamicAnchors}`)},()=>{t.var(M.default.instancePath,(0,N._)`""`),t.var(M.default.parentData,(0,N._)`undefined`),t.var(M.default.parentDataProperty,(0,N._)`undefined`),t.var(M.default.rootData,M.default.data),e.dynamicRef&&t.var(M.default.dynamicAnchors,(0,N._)`{}`)})}function hk(t){let{schema:e,opts:r,gen:n}=t;Bm(t,()=>{r.$comment&&e.$comment&&Ym(t),xk(t),n.let(M.default.vErrors,null),n.let(M.default.errors,0),r.unevaluated&&gk(t),Wm(t),kk(t)})}function gk(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,N._)`${r}.evaluated`),e.if((0,N._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,N._)`${t.evaluated}.props`,(0,N._)`undefined`)),e.if((0,N._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,N._)`${t.evaluated}.items`,(0,N._)`undefined`))}function Um(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,N._)`/*# sourceURL=${r} */`:N.nil}function yk(t,e){if(Km(t)&&(Jm(t),Gm(t))){_k(t,e);return}(0,Hm.boolOrEmptySchema)(t,e)}function Gm({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function Km(t){return typeof t.schema!="boolean"}function _k(t,e){let{schema:r,gen:n,opts:o}=t;o.$comment&&r.$comment&&Ym(t),bk(t),$k(t);let s=n.const("_errs",M.default.errors);Wm(t,s),n.var(e,(0,N._)`${s} === ${M.default.errors}`)}function Jm(t){(0,Zt.checkUnknownRules)(t),vk(t)}function Wm(t,e){if(t.opts.jtd)return Vm(t,[],!1,e);let r=(0,Lm.getSchemaTypes)(t.schema),n=(0,Lm.coerceAndCheckDataType)(t,r);Vm(t,r,!n,e)}function vk(t){let{schema:e,errSchemaPath:r,opts:n,self:o}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,Zt.schemaHasRulesButRef)(e,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function xk(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Zt.checkStrictMode)(t,"default is ignored in the schema root")}function bk(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,dk.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function $k(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function Ym({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:o}){let s=r.$comment;if(o.$comment===!0)t.code((0,N._)`${M.default.self}.logger.log(${s})`);else if(typeof o.$comment=="function"){let i=(0,N.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,N._)`${M.default.self}.opts.$comment(${s}, ${i}, ${a}.schema)`)}}function kk(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:o,opts:s}=t;r.$async?e.if((0,N._)`${M.default.errors} === 0`,()=>e.return(M.default.data),()=>e.throw((0,N._)`new ${o}(${M.default.vErrors})`)):(e.assign((0,N._)`${n}.errors`,M.default.vErrors),s.unevaluated&&wk(t),e.return((0,N._)`${M.default.errors} === 0`))}function wk({gen:t,evaluated:e,props:r,items:n}){r instanceof N.Name&&t.assign((0,N._)`${e}.props`,r),n instanceof N.Name&&t.assign((0,N._)`${e}.items`,n)}function Vm(t,e,r,n){let{gen:o,schema:s,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(s.$ref&&(c.ignoreKeywordsWithRef||!(0,Zt.schemaHasRulesButRef)(s,l))){o.block(()=>Qm(t,"$ref",l.all.$ref.definition));return}c.jtd||Sk(t,e),o.block(()=>{for(let h of l.rules)d(h);d(l.post)});function d(h){(0,Mu.shouldUseGroup)(s,h)&&(h.type?(o.if((0,qs.checkDataType)(h.type,i,c.strictNumbers)),Fm(t,h),e.length===1&&e[0]===h.type&&r&&(o.else(),(0,qs.reportTypeError)(t)),o.endIf()):Fm(t,h),a||o.if((0,N._)`${M.default.errors} === ${n||0}`))}}function Fm(t,e){let{gen:r,schema:n,opts:{useDefaults:o}}=t;o&&(0,lk.assignDefaults)(t,e.type),r.block(()=>{for(let s of e.rules)(0,Mu.shouldUseRule)(n,s)&&Qm(t,s.keyword,s.definition,e.type)})}function Sk(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(zk(t,e),t.opts.allowUnionTypes||Tk(t,e),Pk(t,t.dataTypes))}function zk(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{Xm(t.dataTypes,r)||Du(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),Ik(t,e)}}function Tk(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Du(t,"use allowUnionTypes to allow union type keyword")}function Pk(t,e){let r=t.self.RULES.all;for(let n in r){let o=r[n];if(typeof o=="object"&&(0,Mu.shouldUseRule)(t.schema,o)){let{type:s}=o.definition;s.length&&!s.some(i=>Ek(e,i))&&Du(t,`missing type "${s.join(",")}" for keyword "${n}"`)}}}function Ek(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function Xm(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function Ik(t,e){let r=[];for(let n of t.dataTypes)Xm(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function Du(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,Zt.checkStrictMode)(t,e,t.opts.strictTypes)}var Ls=class{constructor(e,r,n){if((0,co.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Zt.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",eh(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,co.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",M.default.errors))}result(e,r,n){this.failResult((0,N.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,N.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,N._)`${r} !== undefined && (${(0,N.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?ao.reportExtraError:ao.reportError)(this,this.def.error,r)}$dataError(){(0,ao.reportError)(this,this.def.$dataError||ao.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,ao.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=N.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=N.nil,r=N.nil){if(!this.$data)return;let{gen:n,schemaCode:o,schemaType:s,def:i}=this;n.if((0,N.or)((0,N._)`${o} === undefined`,r)),e!==N.nil&&n.assign(e,!0),(s.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==N.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:o,it:s}=this;return(0,N.or)(i(),a());function i(){if(n.length){if(!(r instanceof N.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,N._)`${(0,qs.checkDataTypes)(c,r,s.opts.strictNumbers,qs.DataType.Wrong)}`}return N.nil}function a(){if(o.validateSchema){let c=e.scopeValue("validate$data",{ref:o.validateSchema});return(0,N._)`!${c}(${r})`}return N.nil}}subschema(e,r){let n=(0,Au.getSubschema)(this.it,e);(0,Au.extendSubschemaData)(n,this.it,e),(0,Au.extendSubschemaMode)(n,e);let o={...this.it,...n,items:void 0,props:void 0};return yk(o,r),o}mergeEvaluated(e,r){let{it:n,gen:o}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=Zt.mergeEvaluated.props(o,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=Zt.mergeEvaluated.items(o,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:o}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return o.if(r,()=>this.mergeEvaluated(e,N.Name)),!0}};Qt.KeywordCxt=Ls;function Qm(t,e,r,n){let o=new Ls(t,r,e);"code"in r?r.code(o,n):o.$data&&r.validate?(0,co.funcKeywordCode)(o,r):"macro"in r?(0,co.macroKeywordCode)(o,r):(r.compile||r.validate)&&(0,co.funcKeywordCode)(o,r)}var Rk=/^\/(?:[^~]|~0|~1)*$/,Nk=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function eh(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let o,s;if(t==="")return M.default.rootData;if(t[0]==="/"){if(!Rk.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);o=t,s=M.default.rootData}else{let u=Nk.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(o=u[2],o==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(s=r[e-l],!o)return s}let i=s,a=o.split("/");for(let u of a)u&&(s=(0,N._)`${s}${(0,N.getProperty)((0,Zt.unescapeJsonPointer)(u))}`,i=(0,N._)`${i} && ${s}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}Qt.getData=eh});var Us=z(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});var qu=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Lu.default=qu});var lo=z(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:!0});var Uu=io(),Vu=class extends Error{constructor(e,r,n,o){super(o||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Uu.resolveUrl)(e,r,n),this.missingSchema=(0,Uu.normalizeId)((0,Uu.getFullPath)(e,this.missingRef))}};Fu.default=Vu});var Fs=z(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.resolveSchema=ot.getCompilingSchema=ot.resolveRef=ot.compileSchema=ot.SchemaEnv=void 0;var dt=U(),Ok=Us(),Or=Ot(),pt=io(),th=W(),Zk=uo(),dn=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,pt.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};ot.SchemaEnv=dn;function Bu(t){let e=rh.call(this,t);if(e)return e;let r=(0,pt.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:o}=this.opts.code,{ownProperties:s}=this.opts,i=new dt.CodeGen(this.scope,{es5:n,lines:o,ownProperties:s}),a;t.$async&&(a=i.scopeValue("Error",{ref:Ok.default,code:(0,dt._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:Or.default.data,parentData:Or.default.parentData,parentDataProperty:Or.default.parentDataProperty,dataNames:[Or.default.data],dataPathArr:[dt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,dt.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:dt.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,dt._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,Zk.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(Or.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let f=new Function(`${Or.default.self}`,`${Or.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:p,items:m}=u;f.evaluated={props:p instanceof dt.Name?void 0:p,items:m instanceof dt.Name?void 0:m,dynamicProps:p instanceof dt.Name,dynamicItems:m instanceof dt.Name},f.source&&(f.source.evaluated=(0,dt.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}ot.compileSchema=Bu;function jk(t,e,r){var n;r=(0,pt.resolveUrl)(this.opts.uriResolver,e,r);let o=t.refs[r];if(o)return o;let s=Mk.call(this,t,r);if(s===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(s=new dn({schema:i,schemaId:a,root:t,baseId:e}))}if(s!==void 0)return t.refs[r]=Ck.call(this,s)}ot.resolveRef=jk;function Ck(t){return(0,pt.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Bu.call(this,t)}function rh(t){for(let e of this._compilations)if(Ak(e,t))return e}ot.getCompilingSchema=rh;function Ak(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function Mk(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||Vs.call(this,t,e)}function Vs(t,e){let r=this.opts.uriResolver.parse(e),n=(0,pt._getFullPath)(this.opts.uriResolver,r),o=(0,pt.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===o)return Hu.call(this,r,t);let s=(0,pt.normalizeId)(n),i=this.refs[s]||this.schemas[s];if(typeof i=="string"){let a=Vs.call(this,t,i);return typeof a?.schema!="object"?void 0:Hu.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Bu.call(this,i),s===(0,pt.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(o=(0,pt.resolveUrl)(this.opts.uriResolver,o,u)),new dn({schema:a,schemaId:c,root:t,baseId:o})}return Hu.call(this,r,i)}}ot.resolveSchema=Vs;var Dk=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Hu(t,{baseId:e,schema:r,root:n}){var o;if(((o=t.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,th.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!Dk.has(a)&&u&&(e=(0,pt.resolveUrl)(this.opts.uriResolver,e,u))}let s;if(typeof r!="boolean"&&r.$ref&&!(0,th.schemaHasRulesButRef)(r,this.RULES)){let a=(0,pt.resolveUrl)(this.opts.uriResolver,e,r.$ref);s=Vs.call(this,n,a)}let{schemaId:i}=this.opts;if(s=s||new dn({schema:r,schemaId:i,root:n,baseId:e}),s.schema!==s.root.schema)return s}});var nh=z((gN,qk)=>{qk.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Ku=z((yN,ah)=>{"use strict";var Lk=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),sh=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function Gu(t){let e="",r=0,n=0;for(n=0;n<t.length;n++)if(r=t[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n];break}for(n+=1;n<t.length;n++){if(r=t[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n]}return e}var Uk=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function oh(t){return t.length=0,!0}function Vk(t,e,r){if(t.length){let n=Gu(t);if(n!=="")e.push(n);else return r.error=!0,!1;t.length=0}return!0}function Fk(t){let e=0,r={error:!1,address:"",zone:""},n=[],o=[],s=!1,i=!1,a=Vk;for(let c=0;c<t.length;c++){let u=t[c];if(!(u==="["||u==="]"))if(u===":"){if(s===!0&&(i=!0),!a(o,n,r))break;if(++e>7){r.error=!0;break}c>0&&t[c-1]===":"&&(s=!0),n.push(":");continue}else if(u==="%"){if(!a(o,n,r))break;a=oh}else{o.push(u);continue}}return o.length&&(a===oh?r.zone=o.join(""):i?n.push(o.join("")):n.push(Gu(o))),r.address=n.join(""),r}function ih(t){if(Hk(t,":")<2)return{host:t,isIPV6:!1};let e=Fk(t);if(e.error)return{host:t,isIPV6:!1};{let r=e.address,n=e.address;return e.zone&&(r+="%"+e.zone,n+="%25"+e.zone),{host:r,isIPV6:!0,escapedHost:n}}}function Hk(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}function Bk(t){let e=t,r=[],n=-1,o=0;for(;o=e.length;){if(o===1){if(e===".")break;if(e==="/"){r.push("/");break}else{r.push(e);break}}else if(o===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){r.push("/");break}}else if(o===3&&e==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),r.length!==0&&r.pop();continue}}if((n=e.indexOf("/",1))===-1){r.push(e);break}else r.push(e.slice(0,n)),e=e.slice(n)}return r.join("")}function Gk(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function Kk(t){let e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let r=unescape(t.host);if(!sh(r)){let n=ih(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=t.host}e.push(r)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}ah.exports={nonSimpleDomain:Uk,recomposeAuthority:Kk,normalizeComponentEncoding:Gk,removeDotSegments:Bk,isIPv4:sh,isUUID:Lk,normalizeIPv6:ih,stringArrayToHexStripped:Gu}});var ph=z((_N,dh)=>{"use strict";var{isUUID:Jk}=Ku(),Wk=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,Yk=["http","https","ws","wss","urn","urn:uuid"];function Xk(t){return Yk.indexOf(t)!==-1}function Ju(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function ch(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function uh(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function Qk(t){return t.secure=Ju(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function ew(t){if((t.port===(Ju(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function tw(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(Wk);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let o=`${n}:${e.nid||t.nid}`,s=Wu(o);t.path=void 0,s&&(t=s.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function rw(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),o=`${r}:${e.nid||n}`,s=Wu(o);s&&(t=s.serialize(t,e));let i=t,a=t.nss;return i.path=`${n||e.nid}:${a}`,e.skipEscape=!0,i}function nw(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!Jk(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function ow(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var lh={scheme:"http",domainHost:!0,parse:ch,serialize:uh},sw={scheme:"https",domainHost:lh.domainHost,parse:ch,serialize:uh},Hs={scheme:"ws",domainHost:!0,parse:Qk,serialize:ew},iw={scheme:"wss",domainHost:Hs.domainHost,parse:Hs.parse,serialize:Hs.serialize},aw={scheme:"urn",parse:tw,serialize:rw,skipNormalize:!0},cw={scheme:"urn:uuid",parse:nw,serialize:ow,skipNormalize:!0},Bs={http:lh,https:sw,ws:Hs,wss:iw,urn:aw,"urn:uuid":cw};Object.setPrototypeOf(Bs,null);function Wu(t){return t&&(Bs[t]||Bs[t.toLowerCase()])||void 0}dh.exports={wsIsSecure:Ju,SCHEMES:Bs,isValidSchemeName:Xk,getSchemeHandler:Wu}});var hh=z((vN,Ks)=>{"use strict";var{normalizeIPv6:uw,removeDotSegments:po,recomposeAuthority:lw,normalizeComponentEncoding:Gs,isIPv4:dw,nonSimpleDomain:pw}=Ku(),{SCHEMES:fw,getSchemeHandler:fh}=ph();function mw(t,e){return typeof t=="string"?t=bt(jt(t,e),e):typeof t=="object"&&(t=jt(bt(t,e),e)),t}function hw(t,e,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},o=mh(jt(t,n),jt(e,n),n,!0);return n.skipEscape=!0,bt(o,n)}function mh(t,e,r,n){let o={};return n||(t=jt(bt(t,r),r),e=jt(bt(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(o.scheme=e.scheme,o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=po(e.path||""),o.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=po(e.path||""),o.query=e.query):(e.path?(e.path[0]==="/"?o.path=po(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?o.path="/"+e.path:t.path?o.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:o.path=e.path,o.path=po(o.path)),o.query=e.query):(o.path=t.path,e.query!==void 0?o.query=e.query:o.query=t.query),o.userinfo=t.userinfo,o.host=t.host,o.port=t.port),o.scheme=t.scheme),o.fragment=e.fragment,o}function gw(t,e,r){return typeof t=="string"?(t=unescape(t),t=bt(Gs(jt(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=bt(Gs(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=bt(Gs(jt(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=bt(Gs(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function bt(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),o=[],s=fh(n.scheme||r.scheme);s&&s.serialize&&s.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&o.push(r.scheme,":");let i=lw(r);if(i!==void 0&&(n.reference!=="suffix"&&o.push("//"),o.push(i),r.path&&r.path[0]!=="/"&&o.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!s||!s.absolutePath)&&(a=po(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),o.push(a)}return r.query!==void 0&&o.push("?",r.query),r.fragment!==void 0&&o.push("#",r.fragment),o.join("")}var yw=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function jt(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},o=!1;r.reference==="suffix"&&(r.scheme?t=r.scheme+":"+t:t="//"+t);let s=t.match(yw);if(s){if(n.scheme=s[1],n.userinfo=s[3],n.host=s[4],n.port=parseInt(s[5],10),n.path=s[6]||"",n.query=s[7],n.fragment=s[8],isNaN(n.port)&&(n.port=s[5]),n.host)if(dw(n.host)===!1){let c=uw(n.host);n.host=c.host.toLowerCase(),o=c.isIPV6}else o=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let i=fh(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&o===!1&&pw(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(t.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var Yu={SCHEMES:fw,normalize:mw,resolve:hw,resolveComponent:mh,equal:gw,serialize:bt,parse:jt};Ks.exports=Yu;Ks.exports.default=Yu;Ks.exports.fastUri=Yu});var yh=z(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});var gh=hh();gh.code='require("ajv/dist/runtime/uri").default';Xu.default=gh});var Sh=z(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.CodeGen=Ee.Name=Ee.nil=Ee.stringify=Ee.str=Ee._=Ee.KeywordCxt=void 0;var _w=uo();Object.defineProperty(Ee,"KeywordCxt",{enumerable:!0,get:function(){return _w.KeywordCxt}});var pn=U();Object.defineProperty(Ee,"_",{enumerable:!0,get:function(){return pn._}});Object.defineProperty(Ee,"str",{enumerable:!0,get:function(){return pn.str}});Object.defineProperty(Ee,"stringify",{enumerable:!0,get:function(){return pn.stringify}});Object.defineProperty(Ee,"nil",{enumerable:!0,get:function(){return pn.nil}});Object.defineProperty(Ee,"Name",{enumerable:!0,get:function(){return pn.Name}});Object.defineProperty(Ee,"CodeGen",{enumerable:!0,get:function(){return pn.CodeGen}});var vw=Us(),$h=lo(),xw=Tu(),fo=Fs(),bw=U(),mo=io(),Js=so(),el=W(),_h=nh(),$w=yh(),kh=(t,e)=>new RegExp(t,e);kh.code="new RegExp";var kw=["removeAdditional","useDefaults","coerceTypes"],ww=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Sw={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},zw={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},vh=200;function Tw(t){var e,r,n,o,s,i,a,c,u,l,d,h,f,p,m,g,v,x,k,S,O,ue,We,qr,xi;let $n=t.strict,bi=(e=t.code)===null||e===void 0?void 0:e.optimize,ad=bi===!0||bi===void 0?1:bi||0,cd=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:kh,zy=(o=t.uriResolver)!==null&&o!==void 0?o:$w.default;return{strictSchema:(i=(s=t.strictSchema)!==null&&s!==void 0?s:$n)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:$n)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:$n)!==null&&l!==void 0?l:"log",strictTuples:(h=(d=t.strictTuples)!==null&&d!==void 0?d:$n)!==null&&h!==void 0?h:"log",strictRequired:(p=(f=t.strictRequired)!==null&&f!==void 0?f:$n)!==null&&p!==void 0?p:!1,code:t.code?{...t.code,optimize:ad,regExp:cd}:{optimize:ad,regExp:cd},loopRequired:(m=t.loopRequired)!==null&&m!==void 0?m:vh,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:vh,meta:(v=t.meta)!==null&&v!==void 0?v:!0,messages:(x=t.messages)!==null&&x!==void 0?x:!0,inlineRefs:(k=t.inlineRefs)!==null&&k!==void 0?k:!0,schemaId:(S=t.schemaId)!==null&&S!==void 0?S:"$id",addUsedSchema:(O=t.addUsedSchema)!==null&&O!==void 0?O:!0,validateSchema:(ue=t.validateSchema)!==null&&ue!==void 0?ue:!0,validateFormats:(We=t.validateFormats)!==null&&We!==void 0?We:!0,unicodeRegExp:(qr=t.unicodeRegExp)!==null&&qr!==void 0?qr:!0,int32range:(xi=t.int32range)!==null&&xi!==void 0?xi:!0,uriResolver:zy}}var ho=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...Tw(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new bw.ValueScope({scope:{},prefixes:ww,es5:r,lines:n}),this.logger=Ow(e.logger);let o=e.validateFormats;e.validateFormats=!1,this.RULES=(0,xw.getRules)(),xh.call(this,Sw,e,"NOT SUPPORTED"),xh.call(this,zw,e,"DEPRECATED","warn"),this._metaOpts=Rw.call(this),e.formats&&Ew.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&Iw.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),Pw.call(this),e.validateFormats=o}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,o=_h;n==="id"&&(o={..._h},o.id=o.$id,delete o.$id),r&&e&&this.addMetaSchema(o,o[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let o=n(r);return"$async"in n||(this.errors=n.errors),o}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return o.call(this,e,r);async function o(l,d){await s.call(this,l.$schema);let h=this._addSchema(l,d);return h.validate||i.call(this,h)}async function s(l){l&&!this.getSchema(l)&&await o.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof $h.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await s.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,o=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,o);return this}let s;if(typeof e=="object"){let{schemaId:i}=this.opts;if(s=e[i],s!==void 0&&typeof s!="string")throw new Error(`schema ${i} must be string`)}return r=(0,mo.normalizeId)(r||s),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,o,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let o=this.validate(n,e);if(!o&&r){let s="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(s);else throw new Error(s)}return o}getSchema(e){let r;for(;typeof(r=bh.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,o=new fo.SchemaEnv({schema:{},schemaId:n});if(r=fo.resolveSchema.call(this,o,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=bh.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,mo.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(jw.call(this,n,r),!r)return(0,el.eachItem)(n,s=>Qu.call(this,s)),this;Aw.call(this,r);let o={...r,type:(0,Js.getJSONTypes)(r.type),schemaType:(0,Js.getJSONTypes)(r.schemaType)};return(0,el.eachItem)(n,o.type.length===0?s=>Qu.call(this,s,o):s=>o.type.forEach(i=>Qu.call(this,s,o,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let o=n.rules.findIndex(s=>s.keyword===e);o>=0&&n.rules.splice(o,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(o=>`${n}${o.instancePath} ${o.message}`).reduce((o,s)=>o+r+s)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let o of r){let s=o.split("/").slice(1),i=e;for(let a of s)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=wh(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let o=e[n];(!r||r.test(n))&&(typeof o=="string"?delete e[n]:o&&!o.meta&&(this._cache.delete(o.schema),delete e[n]))}}_addSchema(e,r,n,o=this.opts.validateSchema,s=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,mo.normalizeId)(i||n);let u=mo.getSchemaRefs.call(this,e,n);return c=new fo.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),s&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),o&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):fo.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{fo.compileSchema.call(this,e)}finally{this.opts=r}}};ho.ValidationError=vw.default;ho.MissingRefError=$h.default;Ee.default=ho;function xh(t,e,r,n="error"){for(let o in t){let s=o;s in e&&this.logger[n](`${r}: option ${o}. ${t[s]}`)}}function bh(t){return t=(0,mo.normalizeId)(t),this.schemas[t]||this.refs[t]}function Pw(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function Ew(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function Iw(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function Rw(){let t={...this.opts};for(let e of kw)delete t[e];return t}var Nw={log(){},warn(){},error(){}};function Ow(t){if(t===!1)return Nw;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var Zw=/^[a-z_$][a-z0-9_$:-]*$/i;function jw(t,e){let{RULES:r}=this;if((0,el.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!Zw.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Qu(t,e,r){var n;let o=e?.post;if(r&&o)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,i=o?s.post:s.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},s.rules.push(i)),s.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,Js.getJSONTypes)(e.type),schemaType:(0,Js.getJSONTypes)(e.schemaType)}};e.before?Cw.call(this,i,a,e.before):i.rules.push(a),s.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function Cw(t,e,r){let n=t.rules.findIndex(o=>o.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function Aw(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=wh(e)),t.validateSchema=this.compile(e,!0))}var Mw={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function wh(t){return{anyOf:[t,Mw]}}});var zh=z(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});var Dw={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};tl.default=Dw});var Ih=z(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.callRef=Zr.getValidate=void 0;var qw=lo(),Th=nt(),Be=U(),fn=Ot(),Ph=Fs(),Ws=W(),Lw={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:o,schemaEnv:s,validateName:i,opts:a,self:c}=n,{root:u}=s;if((r==="#"||r==="#/")&&o===u.baseId)return d();let l=Ph.resolveRef.call(c,u,o,r);if(l===void 0)throw new qw.default(n.opts.uriResolver,o,r);if(l instanceof Ph.SchemaEnv)return h(l);return f(l);function d(){if(s===u)return Ys(t,i,s,s.$async);let p=e.scopeValue("root",{ref:u});return Ys(t,(0,Be._)`${p}.validate`,u,u.$async)}function h(p){let m=Eh(t,p);Ys(t,m,p,p.$async)}function f(p){let m=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,Be.stringify)(p)}:{ref:p}),g=e.name("valid"),v=t.subschema({schema:p,dataTypes:[],schemaPath:Be.nil,topSchemaRef:m,errSchemaPath:r},g);t.mergeEvaluated(v),t.ok(g)}}};function Eh(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,Be._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Zr.getValidate=Eh;function Ys(t,e,r,n){let{gen:o,it:s}=t,{allErrors:i,schemaEnv:a,opts:c}=s,u=c.passContext?fn.default.this:Be.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let p=o.let("valid");o.try(()=>{o.code((0,Be._)`await ${(0,Th.callValidateCode)(t,e,u)}`),f(e),i||o.assign(p,!0)},m=>{o.if((0,Be._)`!(${m} instanceof ${s.ValidationError})`,()=>o.throw(m)),h(m),i||o.assign(p,!1)}),t.ok(p)}function d(){t.result((0,Th.callValidateCode)(t,e,u),()=>f(e),()=>h(e))}function h(p){let m=(0,Be._)`${p}.errors`;o.assign(fn.default.vErrors,(0,Be._)`${fn.default.vErrors} === null ? ${m} : ${fn.default.vErrors}.concat(${m})`),o.assign(fn.default.errors,(0,Be._)`${fn.default.vErrors}.length`)}function f(p){var m;if(!s.opts.unevaluated)return;let g=(m=r?.validate)===null||m===void 0?void 0:m.evaluated;if(s.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(s.props=Ws.mergeEvaluated.props(o,g.props,s.props));else{let v=o.var("props",(0,Be._)`${p}.evaluated.props`);s.props=Ws.mergeEvaluated.props(o,v,s.props,Be.Name)}if(s.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(s.items=Ws.mergeEvaluated.items(o,g.items,s.items));else{let v=o.var("items",(0,Be._)`${p}.evaluated.items`);s.items=Ws.mergeEvaluated.items(o,v,s.items,Be.Name)}}}Zr.callRef=Ys;Zr.default=Lw});var Rh=z(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});var Uw=zh(),Vw=Ih(),Fw=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Uw.default,Vw.default];rl.default=Fw});var Nh=z(nl=>{"use strict";Object.defineProperty(nl,"__esModule",{value:!0});var Xs=U(),er=Xs.operators,Qs={maximum:{okStr:"<=",ok:er.LTE,fail:er.GT},minimum:{okStr:">=",ok:er.GTE,fail:er.LT},exclusiveMaximum:{okStr:"<",ok:er.LT,fail:er.GTE},exclusiveMinimum:{okStr:">",ok:er.GT,fail:er.LTE}},Hw={message:({keyword:t,schemaCode:e})=>(0,Xs.str)`must be ${Qs[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Xs._)`{comparison: ${Qs[t].okStr}, limit: ${e}}`},Bw={keyword:Object.keys(Qs),type:"number",schemaType:"number",$data:!0,error:Hw,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,Xs._)`${r} ${Qs[e].fail} ${n} || isNaN(${r})`)}};nl.default=Bw});var Oh=z(ol=>{"use strict";Object.defineProperty(ol,"__esModule",{value:!0});var go=U(),Gw={message:({schemaCode:t})=>(0,go.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,go._)`{multipleOf: ${t}}`},Kw={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Gw,code(t){let{gen:e,data:r,schemaCode:n,it:o}=t,s=o.opts.multipleOfPrecision,i=e.let("res"),a=s?(0,go._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${s}`:(0,go._)`${i} !== parseInt(${i})`;t.fail$data((0,go._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};ol.default=Kw});var jh=z(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});function Zh(t){let e=t.length,r=0,n=0,o;for(;n<e;)r++,o=t.charCodeAt(n++),o>=55296&&o<=56319&&n<e&&(o=t.charCodeAt(n),(o&64512)===56320&&n++);return r}sl.default=Zh;Zh.code='require("ajv/dist/runtime/ucs2length").default'});var Ch=z(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});var jr=U(),Jw=W(),Ww=jh(),Yw={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,jr.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,jr._)`{limit: ${t}}`},Xw={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Yw,code(t){let{keyword:e,data:r,schemaCode:n,it:o}=t,s=e==="maxLength"?jr.operators.GT:jr.operators.LT,i=o.opts.unicode===!1?(0,jr._)`${r}.length`:(0,jr._)`${(0,Jw.useFunc)(t.gen,Ww.default)}(${r})`;t.fail$data((0,jr._)`${i} ${s} ${n}`)}};il.default=Xw});var Ah=z(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});var Qw=nt(),eS=W(),mn=U(),tS={message:({schemaCode:t})=>(0,mn.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,mn._)`{pattern: ${t}}`},rS={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:tS,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:s,it:i}=t,a=i.opts.unicodeRegExp?"u":"";if(n){let{regExp:c}=i.opts.code,u=c.code==="new RegExp"?(0,mn._)`new RegExp`:(0,eS.useFunc)(e,c),l=e.let("valid");e.try(()=>e.assign(l,(0,mn._)`${u}(${s}, ${a}).test(${r})`),()=>e.assign(l,!1)),t.fail$data((0,mn._)`!${l}`)}else{let c=(0,Qw.usePattern)(t,o);t.fail$data((0,mn._)`!${c}.test(${r})`)}}};al.default=rS});var Mh=z(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});var yo=U(),nS={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,yo.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,yo._)`{limit: ${t}}`},oS={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:nS,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxProperties"?yo.operators.GT:yo.operators.LT;t.fail$data((0,yo._)`Object.keys(${r}).length ${o} ${n}`)}};cl.default=oS});var Dh=z(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});var _o=nt(),vo=U(),sS=W(),iS={message:({params:{missingProperty:t}})=>(0,vo.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,vo._)`{missingProperty: ${t}}`},aS={keyword:"required",type:"object",schemaType:"array",$data:!0,error:iS,code(t){let{gen:e,schema:r,schemaCode:n,data:o,$data:s,it:i}=t,{opts:a}=i;if(!s&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let f=t.parentSchema.properties,{definedProperties:p}=t.it;for(let m of r)if(f?.[m]===void 0&&!p.has(m)){let g=i.schemaEnv.baseId+i.errSchemaPath,v=`required property "${m}" is not defined at "${g}" (strictRequired)`;(0,sS.checkStrictMode)(i,v,i.opts.strictRequired)}}function u(){if(c||s)t.block$data(vo.nil,d);else for(let f of r)(0,_o.checkReportMissingProp)(t,f)}function l(){let f=e.let("missing");if(c||s){let p=e.let("valid",!0);t.block$data(p,()=>h(f,p)),t.ok(p)}else e.if((0,_o.checkMissingProp)(t,r,f)),(0,_o.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,_o.noPropertyInData)(e,o,f,a.ownProperties),()=>t.error())})}function h(f,p){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(p,(0,_o.propertyInData)(e,o,f,a.ownProperties)),e.if((0,vo.not)(p),()=>{t.error(),e.break()})},vo.nil)}}};ul.default=aS});var qh=z(ll=>{"use strict";Object.defineProperty(ll,"__esModule",{value:!0});var xo=U(),cS={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,xo.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,xo._)`{limit: ${t}}`},uS={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:cS,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxItems"?xo.operators.GT:xo.operators.LT;t.fail$data((0,xo._)`${r}.length ${o} ${n}`)}};ll.default=uS});var ei=z(dl=>{"use strict";Object.defineProperty(dl,"__esModule",{value:!0});var Lh=ju();Lh.code='require("ajv/dist/runtime/equal").default';dl.default=Lh});var Uh=z(fl=>{"use strict";Object.defineProperty(fl,"__esModule",{value:!0});var pl=so(),Ie=U(),lS=W(),dS=ei(),pS={message:({params:{i:t,j:e}})=>(0,Ie.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ie._)`{i: ${t}, j: ${e}}`},fS={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:pS,code(t){let{gen:e,data:r,$data:n,schema:o,parentSchema:s,schemaCode:i,it:a}=t;if(!n&&!o)return;let c=e.let("valid"),u=s.items?(0,pl.getSchemaTypes)(s.items):[];t.block$data(c,l,(0,Ie._)`${i} === false`),t.ok(c);function l(){let p=e.let("i",(0,Ie._)`${r}.length`),m=e.let("j");t.setParams({i:p,j:m}),e.assign(c,!0),e.if((0,Ie._)`${p} > 1`,()=>(d()?h:f)(p,m))}function d(){return u.length>0&&!u.some(p=>p==="object"||p==="array")}function h(p,m){let g=e.name("item"),v=(0,pl.checkDataTypes)(u,g,a.opts.strictNumbers,pl.DataType.Wrong),x=e.const("indices",(0,Ie._)`{}`);e.for((0,Ie._)`;${p}--;`,()=>{e.let(g,(0,Ie._)`${r}[${p}]`),e.if(v,(0,Ie._)`continue`),u.length>1&&e.if((0,Ie._)`typeof ${g} == "string"`,(0,Ie._)`${g} += "_"`),e.if((0,Ie._)`typeof ${x}[${g}] == "number"`,()=>{e.assign(m,(0,Ie._)`${x}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,Ie._)`${x}[${g}] = ${p}`)})}function f(p,m){let g=(0,lS.useFunc)(e,dS.default),v=e.name("outer");e.label(v).for((0,Ie._)`;${p}--;`,()=>e.for((0,Ie._)`${m} = ${p}; ${m}--;`,()=>e.if((0,Ie._)`${g}(${r}[${p}], ${r}[${m}])`,()=>{t.error(),e.assign(c,!1).break(v)})))}}};fl.default=fS});var Vh=z(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});var ml=U(),mS=W(),hS=ei(),gS={message:"must be equal to constant",params:({schemaCode:t})=>(0,ml._)`{allowedValue: ${t}}`},yS={keyword:"const",$data:!0,error:gS,code(t){let{gen:e,data:r,$data:n,schemaCode:o,schema:s}=t;n||s&&typeof s=="object"?t.fail$data((0,ml._)`!${(0,mS.useFunc)(e,hS.default)}(${r}, ${o})`):t.fail((0,ml._)`${s} !== ${r}`)}};hl.default=yS});var Fh=z(gl=>{"use strict";Object.defineProperty(gl,"__esModule",{value:!0});var bo=U(),_S=W(),vS=ei(),xS={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,bo._)`{allowedValues: ${t}}`},bS={keyword:"enum",schemaType:"array",$data:!0,error:xS,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:s,it:i}=t;if(!n&&o.length===0)throw new Error("enum must have non-empty array");let a=o.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,_S.useFunc)(e,vS.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(o))throw new Error("ajv implementation error");let f=e.const("vSchema",s);l=(0,bo.or)(...o.map((p,m)=>h(f,m)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",s,f=>e.if((0,bo._)`${u()}(${r}, ${f})`,()=>e.assign(l,!0).break()))}function h(f,p){let m=o[p];return typeof m=="object"&&m!==null?(0,bo._)`${u()}(${r}, ${f}[${p}])`:(0,bo._)`${r} === ${m}`}}};gl.default=bS});var Hh=z(yl=>{"use strict";Object.defineProperty(yl,"__esModule",{value:!0});var $S=Nh(),kS=Oh(),wS=Ch(),SS=Ah(),zS=Mh(),TS=Dh(),PS=qh(),ES=Uh(),IS=Vh(),RS=Fh(),NS=[$S.default,kS.default,wS.default,SS.default,zS.default,TS.default,PS.default,ES.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},IS.default,RS.default];yl.default=NS});var vl=z($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.validateAdditionalItems=void 0;var Cr=U(),_l=W(),OS={message:({params:{len:t}})=>(0,Cr.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Cr._)`{limit: ${t}}`},ZS={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:OS,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,_l.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Bh(t,n)}};function Bh(t,e){let{gen:r,schema:n,data:o,keyword:s,it:i}=t;i.items=!0;let a=r.const("len",(0,Cr._)`${o}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Cr._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,_l.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,Cr._)`${a} <= ${e.length}`);r.if((0,Cr.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:s,dataProp:l,dataPropType:_l.Type.Num},u),i.allErrors||r.if((0,Cr.not)(u),()=>r.break())})}}$o.validateAdditionalItems=Bh;$o.default=ZS});var xl=z(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.validateTuple=void 0;var Gh=U(),ti=W(),jS=nt(),CS={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return Kh(t,"additionalItems",e);r.items=!0,!(0,ti.alwaysValidSchema)(r,e)&&t.ok((0,jS.validateArray)(t))}};function Kh(t,e,r=t.schema){let{gen:n,parentSchema:o,data:s,keyword:i,it:a}=t;l(o),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=ti.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,Gh._)`${s}.length`);r.forEach((d,h)=>{(0,ti.alwaysValidSchema)(a,d)||(n.if((0,Gh._)`${u} > ${h}`,()=>t.subschema({keyword:i,schemaProp:h,dataProp:h},c)),t.ok(c))});function l(d){let{opts:h,errSchemaPath:f}=a,p=r.length,m=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(h.strictTuples&&!m){let g=`"${i}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,ti.checkStrictMode)(a,g,h.strictTuples)}}}ko.validateTuple=Kh;ko.default=CS});var Jh=z(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});var AS=xl(),MS={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,AS.validateTuple)(t,"items")};bl.default=MS});var Yh=z($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});var Wh=U(),DS=W(),qS=nt(),LS=vl(),US={message:({params:{len:t}})=>(0,Wh.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Wh._)`{limit: ${t}}`},VS={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:US,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:o}=r;n.items=!0,!(0,DS.alwaysValidSchema)(n,e)&&(o?(0,LS.validateAdditionalItems)(t,o):t.ok((0,qS.validateArray)(t)))}};$l.default=VS});var Xh=z(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});var st=U(),ri=W(),FS={message:({params:{min:t,max:e}})=>e===void 0?(0,st.str)`must contain at least ${t} valid item(s)`:(0,st.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,st._)`{minContains: ${t}}`:(0,st._)`{minContains: ${t}, maxContains: ${e}}`},HS={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:FS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t,i,a,{minContains:c,maxContains:u}=n;s.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,st._)`${o}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,ri.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,ri.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,ri.alwaysValidSchema)(s,r)){let m=(0,st._)`${l} >= ${i}`;a!==void 0&&(m=(0,st._)`${m} && ${l} <= ${a}`),t.pass(m);return}s.items=!0;let d=e.name("valid");a===void 0&&i===1?f(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,st._)`${o}.length > 0`,h)):(e.let(d,!1),h()),t.result(d,()=>t.reset());function h(){let m=e.name("_valid"),g=e.let("count",0);f(m,()=>e.if(m,()=>p(g)))}function f(m,g){e.forRange("i",0,l,v=>{t.subschema({keyword:"contains",dataProp:v,dataPropType:ri.Type.Num,compositeRule:!0},m),g()})}function p(m){e.code((0,st._)`${m}++`),a===void 0?e.if((0,st._)`${m} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,st._)`${m} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,st._)`${m} >= ${i}`,()=>e.assign(d,!0)))}}};kl.default=HS});var tg=z($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.validateSchemaDeps=$t.validatePropertyDeps=$t.error=void 0;var wl=U(),BS=W(),wo=nt();$t.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,wl.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,wl._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var GS={keyword:"dependencies",type:"object",schemaType:"object",error:$t.error,code(t){let[e,r]=KS(t);Qh(t,e),eg(t,r)}};function KS({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let o=Array.isArray(t[n])?e:r;o[n]=t[n]}return[e,r]}function Qh(t,e=t.schema){let{gen:r,data:n,it:o}=t;if(Object.keys(e).length===0)return;let s=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,wo.propertyInData)(r,n,i,o.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),o.allErrors?r.if(c,()=>{for(let u of a)(0,wo.checkReportMissingProp)(t,u)}):(r.if((0,wl._)`${c} && (${(0,wo.checkMissingProp)(t,a,s)})`),(0,wo.reportMissingProp)(t,s),r.else())}}$t.validatePropertyDeps=Qh;function eg(t,e=t.schema){let{gen:r,data:n,keyword:o,it:s}=t,i=r.name("valid");for(let a in e)(0,BS.alwaysValidSchema)(s,e[a])||(r.if((0,wo.propertyInData)(r,n,a,s.opts.ownProperties),()=>{let c=t.subschema({keyword:o,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}$t.validateSchemaDeps=eg;$t.default=GS});var ng=z(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});var rg=U(),JS=W(),WS={message:"property name must be valid",params:({params:t})=>(0,rg._)`{propertyName: ${t.propertyName}}`},YS={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:WS,code(t){let{gen:e,schema:r,data:n,it:o}=t;if((0,JS.alwaysValidSchema)(o,r))return;let s=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},s),e.if((0,rg.not)(s),()=>{t.error(!0),o.allErrors||e.break()})}),t.ok(s)}};Sl.default=YS});var Tl=z(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});var ni=nt(),ft=U(),XS=Ot(),oi=W(),QS={message:"must NOT have additional properties",params:({params:t})=>(0,ft._)`{additionalProperty: ${t.additionalProperty}}`},ez={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:QS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,errsCount:s,it:i}=t;if(!s)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,oi.alwaysValidSchema)(i,r))return;let u=(0,ni.allSchemaProperties)(n.properties),l=(0,ni.allSchemaProperties)(n.patternProperties);d(),t.ok((0,ft._)`${s} === ${XS.default.errors}`);function d(){e.forIn("key",o,g=>{!u.length&&!l.length?p(g):e.if(h(g),()=>p(g))})}function h(g){let v;if(u.length>8){let x=(0,oi.schemaRefOrVal)(i,n.properties,"properties");v=(0,ni.isOwnProperty)(e,x,g)}else u.length?v=(0,ft.or)(...u.map(x=>(0,ft._)`${g} === ${x}`)):v=ft.nil;return l.length&&(v=(0,ft.or)(v,...l.map(x=>(0,ft._)`${(0,ni.usePattern)(t,x)}.test(${g})`))),(0,ft.not)(v)}function f(g){e.code((0,ft._)`delete ${o}[${g}]`)}function p(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){f(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,oi.alwaysValidSchema)(i,r)){let v=e.name("valid");c.removeAdditional==="failing"?(m(g,v,!1),e.if((0,ft.not)(v),()=>{t.reset(),f(g)})):(m(g,v),a||e.if((0,ft.not)(v),()=>e.break()))}}function m(g,v,x){let k={keyword:"additionalProperties",dataProp:g,dataPropType:oi.Type.Str};x===!1&&Object.assign(k,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(k,v)}}};zl.default=ez});var ig=z(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});var tz=uo(),og=nt(),Pl=W(),sg=Tl(),rz={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t;s.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&sg.default.code(new tz.KeywordCxt(s,sg.default,"additionalProperties"));let i=(0,og.allSchemaProperties)(r);for(let d of i)s.definedProperties.add(d);s.opts.unevaluated&&i.length&&s.props!==!0&&(s.props=Pl.mergeEvaluated.props(e,(0,Pl.toHash)(i),s.props));let a=i.filter(d=>!(0,Pl.alwaysValidSchema)(s,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,og.propertyInData)(e,o,d,s.opts.ownProperties)),l(d),s.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return s.opts.useDefaults&&!s.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};El.default=rz});var lg=z(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});var ag=nt(),si=U(),cg=W(),ug=W(),nz={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:o,it:s}=t,{opts:i}=s,a=(0,ag.allSchemaProperties)(r),c=a.filter(m=>(0,cg.alwaysValidSchema)(s,r[m]));if(a.length===0||c.length===a.length&&(!s.opts.unevaluated||s.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&o.properties,l=e.name("valid");s.props!==!0&&!(s.props instanceof si.Name)&&(s.props=(0,ug.evaluatedPropsToName)(e,s.props));let{props:d}=s;h();function h(){for(let m of a)u&&f(m),s.allErrors?p(m):(e.var(l,!0),p(m),e.if(l))}function f(m){for(let g in u)new RegExp(m).test(g)&&(0,cg.checkStrictMode)(s,`property ${g} matches pattern ${m} (use allowMatchingProperties)`)}function p(m){e.forIn("key",n,g=>{e.if((0,si._)`${(0,ag.usePattern)(t,m)}.test(${g})`,()=>{let v=c.includes(m);v||t.subschema({keyword:"patternProperties",schemaProp:m,dataProp:g,dataPropType:ug.Type.Str},l),s.opts.unevaluated&&d!==!0?e.assign((0,si._)`${d}[${g}]`,!0):!v&&!s.allErrors&&e.if((0,si.not)(l),()=>e.break())})})}}};Il.default=nz});var dg=z(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});var oz=W(),sz={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,oz.alwaysValidSchema)(n,r)){t.fail();return}let o=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),t.failResult(o,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};Rl.default=sz});var pg=z(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});var iz=nt(),az={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:iz.validateUnion,error:{message:"must match a schema in anyOf"}};Nl.default=az});var fg=z(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});var ii=U(),cz=W(),uz={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,ii._)`{passingSchemas: ${t.passing}}`},lz={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:uz,code(t){let{gen:e,schema:r,parentSchema:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(o.opts.discriminator&&n.discriminator)return;let s=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){s.forEach((l,d)=>{let h;(0,cz.alwaysValidSchema)(o,l)?e.var(c,!0):h=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,ii._)`${c} && ${i}`).assign(i,!1).assign(a,(0,ii._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),h&&t.mergeEvaluated(h,ii.Name)})})}}};Ol.default=lz});var mg=z(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});var dz=W(),pz={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let o=e.name("valid");r.forEach((s,i)=>{if((0,dz.alwaysValidSchema)(n,s))return;let a=t.subschema({keyword:"allOf",schemaProp:i},o);t.ok(o),t.mergeEvaluated(a)})}};Zl.default=pz});var yg=z(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});var ai=U(),gg=W(),fz={message:({params:t})=>(0,ai.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,ai._)`{failingKeyword: ${t.ifClause}}`},mz={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:fz,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,gg.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let o=hg(n,"then"),s=hg(n,"else");if(!o&&!s)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),o&&s){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else o?e.if(a,u("then")):e.if((0,ai.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let h=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(h,i),d?e.assign(d,(0,ai._)`${l}`):t.setParams({ifClause:l})}}}};function hg(t,e){let r=t.schema[e];return r!==void 0&&!(0,gg.alwaysValidSchema)(t,r)}jl.default=mz});var _g=z(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});var hz=W(),gz={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,hz.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};Cl.default=gz});var vg=z(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});var yz=vl(),_z=Jh(),vz=xl(),xz=Yh(),bz=Xh(),$z=tg(),kz=ng(),wz=Tl(),Sz=ig(),zz=lg(),Tz=dg(),Pz=pg(),Ez=fg(),Iz=mg(),Rz=yg(),Nz=_g();function Oz(t=!1){let e=[Tz.default,Pz.default,Ez.default,Iz.default,Rz.default,Nz.default,kz.default,wz.default,$z.default,Sz.default,zz.default];return t?e.push(_z.default,xz.default):e.push(yz.default,vz.default),e.push(bz.default),e}Al.default=Oz});var xg=z(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});var _e=U(),Zz={message:({schemaCode:t})=>(0,_e.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,_e._)`{format: ${t}}`},jz={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:Zz,code(t,e){let{gen:r,data:n,$data:o,schema:s,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;o?h():f();function h(){let p=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),m=r.const("fDef",(0,_e._)`${p}[${i}]`),g=r.let("fType"),v=r.let("format");r.if((0,_e._)`typeof ${m} == "object" && !(${m} instanceof RegExp)`,()=>r.assign(g,(0,_e._)`${m}.type || "string"`).assign(v,(0,_e._)`${m}.validate`),()=>r.assign(g,(0,_e._)`"string"`).assign(v,m)),t.fail$data((0,_e.or)(x(),k()));function x(){return c.strictSchema===!1?_e.nil:(0,_e._)`${i} && !${v}`}function k(){let S=l.$async?(0,_e._)`(${m}.async ? await ${v}(${n}) : ${v}(${n}))`:(0,_e._)`${v}(${n})`,O=(0,_e._)`(typeof ${v} == "function" ? ${S} : ${v}.test(${n}))`;return(0,_e._)`${v} && ${v} !== true && ${g} === ${e} && !${O}`}}function f(){let p=d.formats[s];if(!p){x();return}if(p===!0)return;let[m,g,v]=k(p);m===e&&t.pass(S());function x(){if(c.strictSchema===!1){d.logger.warn(O());return}throw new Error(O());function O(){return`unknown format "${s}" ignored in schema at path "${u}"`}}function k(O){let ue=O instanceof RegExp?(0,_e.regexpCode)(O):c.code.formats?(0,_e._)`${c.code.formats}${(0,_e.getProperty)(s)}`:void 0,We=r.scopeValue("formats",{key:s,ref:O,code:ue});return typeof O=="object"&&!(O instanceof RegExp)?[O.type||"string",O.validate,(0,_e._)`${We}.validate`]:["string",O,We]}function S(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!l.$async)throw new Error("async format in sync schema");return(0,_e._)`await ${v}(${n})`}return typeof g=="function"?(0,_e._)`${v}(${n})`:(0,_e._)`${v}.test(${n})`}}}};Ml.default=jz});var bg=z(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});var Cz=xg(),Az=[Cz.default];Dl.default=Az});var $g=z(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.contentVocabulary=hn.metadataVocabulary=void 0;hn.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];hn.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var wg=z(ql=>{"use strict";Object.defineProperty(ql,"__esModule",{value:!0});var Mz=Rh(),Dz=Hh(),qz=vg(),Lz=bg(),kg=$g(),Uz=[Mz.default,Dz.default,(0,qz.default)(),Lz.default,kg.metadataVocabulary,kg.contentVocabulary];ql.default=Uz});var zg=z(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.DiscrError=void 0;var Sg;(function(t){t.Tag="tag",t.Mapping="mapping"})(Sg||(ci.DiscrError=Sg={}))});var Pg=z(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});var gn=U(),Ll=zg(),Tg=Fs(),Vz=lo(),Fz=W(),Hz={message:({params:{discrError:t,tagName:e}})=>t===Ll.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,gn._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},Bz={keyword:"discriminator",type:"object",schemaType:"object",error:Hz,code(t){let{gen:e,data:r,schema:n,parentSchema:o,it:s}=t,{oneOf:i}=o;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,gn._)`${r}${(0,gn.getProperty)(a)}`);e.if((0,gn._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:Ll.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let f=h();e.if(!1);for(let p in f)e.elseIf((0,gn._)`${u} === ${p}`),e.assign(c,d(f[p]));e.else(),t.error(!1,{discrError:Ll.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(f){let p=e.name("valid"),m=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(m,gn.Name),p}function h(){var f;let p={},m=v(o),g=!0;for(let S=0;S<i.length;S++){let O=i[S];if(O?.$ref&&!(0,Fz.schemaHasRulesButRef)(O,s.self.RULES)){let We=O.$ref;if(O=Tg.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,We),O instanceof Tg.SchemaEnv&&(O=O.schema),O===void 0)throw new Vz.default(s.opts.uriResolver,s.baseId,We)}let ue=(f=O?.properties)===null||f===void 0?void 0:f[a];if(typeof ue!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(m||v(O)),x(ue,S)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return p;function v({required:S}){return Array.isArray(S)&&S.includes(a)}function x(S,O){if(S.const)k(S.const,O);else if(S.enum)for(let ue of S.enum)k(ue,O);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function k(S,O){if(typeof S!="string"||S in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[S]=O}}}};Ul.default=Bz});var Eg=z((aO,Gz)=>{Gz.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Fl=z((de,Vl)=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.MissingRefError=de.ValidationError=de.CodeGen=de.Name=de.nil=de.stringify=de.str=de._=de.KeywordCxt=de.Ajv=void 0;var Kz=Sh(),Jz=wg(),Wz=Pg(),Ig=Eg(),Yz=["/properties"],ui="http://json-schema.org/draft-07/schema",yn=class extends Kz.default{_addVocabularies(){super._addVocabularies(),Jz.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(Wz.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(Ig,Yz):Ig;this.addMetaSchema(e,ui,!1),this.refs["http://json-schema.org/schema"]=ui}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(ui)?ui:void 0)}};de.Ajv=yn;Vl.exports=de=yn;Vl.exports.Ajv=yn;Object.defineProperty(de,"__esModule",{value:!0});de.default=yn;var Xz=uo();Object.defineProperty(de,"KeywordCxt",{enumerable:!0,get:function(){return Xz.KeywordCxt}});var _n=U();Object.defineProperty(de,"_",{enumerable:!0,get:function(){return _n._}});Object.defineProperty(de,"str",{enumerable:!0,get:function(){return _n.str}});Object.defineProperty(de,"stringify",{enumerable:!0,get:function(){return _n.stringify}});Object.defineProperty(de,"nil",{enumerable:!0,get:function(){return _n.nil}});Object.defineProperty(de,"Name",{enumerable:!0,get:function(){return _n.Name}});Object.defineProperty(de,"CodeGen",{enumerable:!0,get:function(){return _n.CodeGen}});var Qz=Us();Object.defineProperty(de,"ValidationError",{enumerable:!0,get:function(){return Qz.default}});var eT=lo();Object.defineProperty(de,"MissingRefError",{enumerable:!0,get:function(){return eT.default}})});var Mg=z(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.formatNames=wt.fastFormats=wt.fullFormats=void 0;function kt(t,e){return{validate:t,compare:e}}wt.fullFormats={date:kt(Zg,Kl),time:kt(Bl(!0),Jl),"date-time":kt(Rg(!0),Cg),"iso-time":kt(Bl(),jg),"iso-date-time":kt(Rg(),Ag),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:iT,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:fT,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:aT,int32:{type:"number",validate:lT},int64:{type:"number",validate:dT},float:{type:"number",validate:Og},double:{type:"number",validate:Og},password:!0,binary:!0};wt.fastFormats={...wt.fullFormats,date:kt(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,Kl),time:kt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Jl),"date-time":kt(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Cg),"iso-time":kt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,jg),"iso-date-time":kt(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Ag),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};wt.formatNames=Object.keys(wt.fullFormats);function tT(t){return t%4===0&&(t%100!==0||t%400===0)}var rT=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,nT=[0,31,28,31,30,31,30,31,31,30,31,30,31];function Zg(t){let e=rT.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],o=+e[3];return n>=1&&n<=12&&o>=1&&o<=(n===2&&tT(r)?29:nT[n])}function Kl(t,e){if(t&&e)return t>e?1:t<e?-1:0}var Hl=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Bl(t){return function(r){let n=Hl.exec(r);if(!n)return!1;let o=+n[1],s=+n[2],i=+n[3],a=n[4],c=n[5]==="-"?-1:1,u=+(n[6]||0),l=+(n[7]||0);if(u>23||l>59||t&&!a)return!1;if(o<=23&&s<=59&&i<60)return!0;let d=s-l*c,h=o-u*c-(d<0?1:0);return(h===23||h===-1)&&(d===59||d===-1)&&i<61}}function Jl(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),n=new Date("2020-01-01T"+e).valueOf();if(r&&n)return r-n}function jg(t,e){if(!(t&&e))return;let r=Hl.exec(t),n=Hl.exec(e);if(r&&n)return t=r[1]+r[2]+r[3],e=n[1]+n[2]+n[3],t>e?1:t<e?-1:0}var Gl=/t|\s/i;function Rg(t){let e=Bl(t);return function(n){let o=n.split(Gl);return o.length===2&&Zg(o[0])&&e(o[1])}}function Cg(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),n=new Date(e).valueOf();if(r&&n)return r-n}function Ag(t,e){if(!(t&&e))return;let[r,n]=t.split(Gl),[o,s]=e.split(Gl),i=Kl(r,o);if(i!==void 0)return i||Jl(n,s)}var oT=/\/|:/,sT=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function iT(t){return oT.test(t)&&sT.test(t)}var Ng=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function aT(t){return Ng.lastIndex=0,Ng.test(t)}var cT=-(2**31),uT=2**31-1;function lT(t){return Number.isInteger(t)&&t<=uT&&t>=cT}function dT(t){return Number.isInteger(t)}function Og(){return!0}var pT=/[^\\]\\Z/;function fT(t){if(pT.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Dg=z(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.formatLimitDefinition=void 0;var mT=Fl(),mt=U(),tr=mt.operators,li={formatMaximum:{okStr:"<=",ok:tr.LTE,fail:tr.GT},formatMinimum:{okStr:">=",ok:tr.GTE,fail:tr.LT},formatExclusiveMaximum:{okStr:"<",ok:tr.LT,fail:tr.GTE},formatExclusiveMinimum:{okStr:">",ok:tr.GT,fail:tr.LTE}},hT={message:({keyword:t,schemaCode:e})=>(0,mt.str)`should be ${li[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,mt._)`{comparison: ${li[t].okStr}, limit: ${e}}`};vn.formatLimitDefinition={keyword:Object.keys(li),type:"string",schemaType:"string",$data:!0,error:hT,code(t){let{gen:e,data:r,schemaCode:n,keyword:o,it:s}=t,{opts:i,self:a}=s;if(!i.validateFormats)return;let c=new mT.KeywordCxt(s,a.RULES.all.format.definition,"format");c.$data?u():l();function u(){let h=e.scopeValue("formats",{ref:a.formats,code:i.code.formats}),f=e.const("fmt",(0,mt._)`${h}[${c.schemaCode}]`);t.fail$data((0,mt.or)((0,mt._)`typeof ${f} != "object"`,(0,mt._)`${f} instanceof RegExp`,(0,mt._)`typeof ${f}.compare != "function"`,d(f)))}function l(){let h=c.schema,f=a.formats[h];if(!f||f===!0)return;if(typeof f!="object"||f instanceof RegExp||typeof f.compare!="function")throw new Error(`"${o}": format "${h}" does not define "compare" function`);let p=e.scopeValue("formats",{key:h,ref:f,code:i.code.formats?(0,mt._)`${i.code.formats}${(0,mt.getProperty)(h)}`:void 0});t.fail$data(d(p))}function d(h){return(0,mt._)`${h}.compare(${r}, ${n}) ${li[o].fail} 0`}},dependencies:["format"]};var gT=t=>(t.addKeyword(vn.formatLimitDefinition),t);vn.default=gT});var Vg=z((So,Ug)=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});var xn=Mg(),yT=Dg(),Wl=U(),qg=new Wl.Name("fullFormats"),_T=new Wl.Name("fastFormats"),Yl=(t,e={keywords:!0})=>{if(Array.isArray(e))return Lg(t,e,xn.fullFormats,qg),t;let[r,n]=e.mode==="fast"?[xn.fastFormats,_T]:[xn.fullFormats,qg],o=e.formats||xn.formatNames;return Lg(t,o,r,n),e.keywords&&(0,yT.default)(t),t};Yl.get=(t,e="full")=>{let n=(e==="fast"?xn.fastFormats:xn.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function Lg(t,e,r,n){var o,s;(o=(s=t.opts.code).formats)!==null&&o!==void 0||(s.formats=(0,Wl._)`require("ajv-formats/dist/formats").${n}`);for(let i of e)t.addFormat(i,r[i])}Ug.exports=So=Yl;Object.defineProperty(So,"__esModule",{value:!0});So.default=Yl});import Sy from"os";var Q={};ki(Q,{BRAND:()=>o_,DIRTY:()=>or,EMPTY_PATH:()=>Cy,INVALID:()=>j,NEVER:()=>L_,OK:()=>Re,ParseStatus:()=>we,Schema:()=>L,ZodAny:()=>qt,ZodArray:()=>Et,ZodBigInt:()=>ir,ZodBoolean:()=>ar,ZodBranded:()=>wn,ZodCatch:()=>_r,ZodDate:()=>cr,ZodDefault:()=>yr,ZodDiscriminatedUnion:()=>Ro,ZodEffects:()=>Xe,ZodEnum:()=>hr,ZodError:()=>De,ZodFirstPartyTypeKind:()=>$,ZodFunction:()=>Oo,ZodIntersection:()=>pr,ZodIssueCode:()=>b,ZodLazy:()=>fr,ZodLiteral:()=>mr,ZodMap:()=>Br,ZodNaN:()=>Kr,ZodNativeEnum:()=>gr,ZodNever:()=>it,ZodNull:()=>lr,ZodNullable:()=>yt,ZodNumber:()=>sr,ZodObject:()=>Le,ZodOptional:()=>qe,ZodParsedType:()=>T,ZodPipeline:()=>Sn,ZodPromise:()=>Lt,ZodReadonly:()=>vr,ZodRecord:()=>No,ZodSchema:()=>L,ZodSet:()=>Gr,ZodString:()=>Dt,ZodSymbol:()=>Fr,ZodTransformer:()=>Xe,ZodTuple:()=>gt,ZodType:()=>L,ZodUndefined:()=>ur,ZodUnion:()=>dr,ZodUnknown:()=>Pt,ZodVoid:()=>Hr,addIssueToContext:()=>w,any:()=>f_,array:()=>y_,bigint:()=>c_,boolean:()=>xd,coerce:()=>q_,custom:()=>yd,date:()=>u_,datetimeRegex:()=>hd,defaultErrorMap:()=>zt,discriminatedUnion:()=>x_,effect:()=>N_,enum:()=>E_,function:()=>z_,getErrorMap:()=>Lr,getParsedType:()=>ht,instanceof:()=>i_,intersection:()=>b_,isAborted:()=>Eo,isAsync:()=>Ur,isDirty:()=>Io,isValid:()=>Mt,late:()=>s_,lazy:()=>T_,literal:()=>P_,makeIssue:()=>kn,map:()=>w_,nan:()=>a_,nativeEnum:()=>I_,never:()=>h_,null:()=>p_,nullable:()=>Z_,number:()=>vd,object:()=>Ti,objectUtil:()=>wi,oboolean:()=>D_,onumber:()=>M_,optional:()=>O_,ostring:()=>A_,pipeline:()=>C_,preprocess:()=>j_,promise:()=>R_,quotelessJson:()=>Oy,record:()=>k_,set:()=>S_,setErrorMap:()=>jy,strictObject:()=>__,string:()=>_d,symbol:()=>l_,transformer:()=>N_,tuple:()=>$_,undefined:()=>d_,union:()=>v_,unknown:()=>m_,util:()=>H,void:()=>g_});var H;(function(t){t.assertEqual=o=>{};function e(o){}t.assertIs=e;function r(o){throw new Error}t.assertNever=r,t.arrayToEnum=o=>{let s={};for(let i of o)s[i]=i;return s},t.getValidEnumValues=o=>{let s=t.objectKeys(o).filter(a=>typeof o[o[a]]!="number"),i={};for(let a of s)i[a]=o[a];return t.objectValues(i)},t.objectValues=o=>t.objectKeys(o).map(function(s){return o[s]}),t.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let s=[];for(let i in o)Object.prototype.hasOwnProperty.call(o,i)&&s.push(i);return s},t.find=(o,s)=>{for(let i of o)if(s(i))return i},t.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,s=" | "){return o.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}t.joinValues=n,t.jsonStringifyReplacer=(o,s)=>typeof s=="bigint"?s.toString():s})(H||(H={}));var wi;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(wi||(wi={}));var T=H.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ht=t=>{switch(typeof t){case"undefined":return T.undefined;case"string":return T.string;case"number":return Number.isNaN(t)?T.nan:T.number;case"boolean":return T.boolean;case"function":return T.function;case"bigint":return T.bigint;case"symbol":return T.symbol;case"object":return Array.isArray(t)?T.array:t===null?T.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?T.promise:typeof Map<"u"&&t instanceof Map?T.map:typeof Set<"u"&&t instanceof Set?T.set:typeof Date<"u"&&t instanceof Date?T.date:T.object;default:return T.unknown}};var b=H.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Oy=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),De=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(o);else if(i.code==="invalid_return_type")o(i.returnTypeError);else if(i.code==="invalid_arguments")o(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,H.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let o of this.issues)if(o.path.length>0){let s=o.path[0];r[s]=r[s]||[],r[s].push(e(o))}else n.push(e(o));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};De.create=t=>new De(t);var Zy=(t,e)=>{let r;switch(t.code){case b.invalid_type:t.received===T.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case b.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,H.jsonStringifyReplacer)}`;break;case b.unrecognized_keys:r=`Unrecognized key(s) in object: ${H.joinValues(t.keys,", ")}`;break;case b.invalid_union:r="Invalid input";break;case b.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${H.joinValues(t.options)}`;break;case b.invalid_enum_value:r=`Invalid enum value. Expected ${H.joinValues(t.options)}, received '${t.received}'`;break;case b.invalid_arguments:r="Invalid function arguments";break;case b.invalid_return_type:r="Invalid function return type";break;case b.invalid_date:r="Invalid date";break;case b.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:H.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case b.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case b.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case b.custom:r="Invalid input";break;case b.invalid_intersection_types:r="Intersection results could not be merged";break;case b.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case b.not_finite:r="Number must be finite";break;default:r=e.defaultError,H.assertNever(t)}return{message:r}},zt=Zy;var ld=zt;function jy(t){ld=t}function Lr(){return ld}var kn=t=>{let{data:e,path:r,errorMaps:n,issueData:o}=t,s=[...r,...o.path||[]],i={...o,path:s};if(o.message!==void 0)return{...o,path:s,message:o.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(i,{data:e,defaultError:a}).message;return{...o,path:s,message:a}},Cy=[];function w(t,e){let r=Lr(),n=kn({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===zt?void 0:zt].filter(o=>!!o)});t.common.issues.push(n)}var we=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let o of r){if(o.status==="aborted")return j;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let o of r){let s=await o.key,i=await o.value;n.push({key:s,value:i})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let o of r){let{key:s,value:i}=o;if(s.status==="aborted"||i.status==="aborted")return j;s.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof i.value<"u"||o.alwaysSet)&&(n[s.value]=i.value)}return{status:e.value,value:n}}},j=Object.freeze({status:"aborted"}),or=t=>({status:"dirty",value:t}),Re=t=>({status:"valid",value:t}),Eo=t=>t.status==="aborted",Io=t=>t.status==="dirty",Mt=t=>t.status==="valid",Ur=t=>typeof Promise<"u"&&t instanceof Promise;var E;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(E||(E={}));var Ye=class{constructor(e,r,n,o){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},dd=(t,e)=>{if(Mt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new De(t.common.issues);return this._error=r,this._error}}};function D(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:o}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(i,a)=>{let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:o}}var L=class{get description(){return this._def.description}_getType(e){return ht(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:ht(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new we,ctx:{common:e.parent.common,data:e.data,parsedType:ht(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Ur(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ht(e)},o=this._parseSync({data:e,path:n.path,parent:n});return dd(n,o)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ht(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Mt(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Mt(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ht(e)},o=this._parse({data:e,path:n.path,parent:n}),s=await(Ur(o)?o:Promise.resolve(o));return dd(n,s)}refine(e,r){let n=o=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,s)=>{let i=e(o),a=()=>s.addIssue({code:b.custom,...n(o)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof r=="function"?r(n,o):r),!1))}_refinement(e){return new Xe({schema:this,typeName:$.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return qe.create(this,this._def)}nullable(){return yt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Et.create(this)}promise(){return Lt.create(this,this._def)}or(e){return dr.create([this,e],this._def)}and(e){return pr.create(this,e,this._def)}transform(e){return new Xe({...D(this._def),schema:this,typeName:$.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new yr({...D(this._def),innerType:this,defaultValue:r,typeName:$.ZodDefault})}brand(){return new wn({typeName:$.ZodBranded,type:this,...D(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new _r({...D(this._def),innerType:this,catchValue:r,typeName:$.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Sn.create(this,e)}readonly(){return vr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Ay=/^c[^\s-]{8,}$/i,My=/^[0-9a-z]+$/,Dy=/^[0-9A-HJKMNP-TV-Z]{26}$/i,qy=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ly=/^[a-z0-9_-]{21}$/i,Uy=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Vy=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Fy=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Hy="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Si,By=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Gy=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Ky=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Jy=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Wy=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Yy=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,fd="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Xy=new RegExp(`^${fd}$`);function md(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function Qy(t){return new RegExp(`^${md(t)}$`)}function hd(t){let e=`${fd}T${md(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function e_(t,e){return!!((e==="v4"||!e)&&By.test(t)||(e==="v6"||!e)&&Ky.test(t))}function t_(t,e){if(!Uy.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function r_(t,e){return!!((e==="v4"||!e)&&Gy.test(t)||(e==="v6"||!e)&&Jy.test(t))}var Dt=class t extends L{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==T.string){let s=this._getOrReturnCtx(e);return w(s,{code:b.invalid_type,expected:T.string,received:s.parsedType}),j}let n=new we,o;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(o=this._getOrReturnCtx(e,o),w(o,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(o=this._getOrReturnCtx(e,o),w(o,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){let i=e.data.length>s.value,a=e.data.length<s.value;(i||a)&&(o=this._getOrReturnCtx(e,o),i?w(o,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&w(o,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")Fy.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"email",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")Si||(Si=new RegExp(Hy,"u")),Si.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"emoji",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")qy.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"uuid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")Ly.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"nanoid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")Ay.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"cuid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")My.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"cuid2",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")Dy.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"ulid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),w(o,{validation:"url",code:b.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"regex",code:b.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(o=this._getOrReturnCtx(e,o),w(o,{code:b.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(o=this._getOrReturnCtx(e,o),w(o,{code:b.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(o=this._getOrReturnCtx(e,o),w(o,{code:b.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?hd(s).test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{code:b.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?Xy.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{code:b.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?Qy(s).test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{code:b.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?Vy.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"duration",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?e_(e.data,s.version)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"ip",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?t_(e.data,s.alg)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"jwt",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?r_(e.data,s.version)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"cidr",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?Wy.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"base64",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?Yy.test(e.data)||(o=this._getOrReturnCtx(e,o),w(o,{validation:"base64url",code:b.invalid_string,message:s.message}),n.dirty()):H.assertNever(s);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(o=>e.test(o),{validation:r,code:b.invalid_string,...E.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...E.errToObj(e)})}url(e){return this._addCheck({kind:"url",...E.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...E.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...E.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...E.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...E.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...E.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...E.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...E.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...E.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...E.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...E.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...E.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...E.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...E.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...E.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...E.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...E.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...E.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...E.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...E.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...E.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...E.errToObj(r)})}nonempty(e){return this.min(1,E.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Dt.create=t=>new Dt({checks:[],typeName:$.ZodString,coerce:t?.coerce??!1,...D(t)});function n_(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}var sr=class t extends L{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==T.number){let s=this._getOrReturnCtx(e);return w(s,{code:b.invalid_type,expected:T.number,received:s.parsedType}),j}let n,o=new we;for(let s of this._def.checks)s.kind==="int"?H.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{code:b.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),w(n,{code:b.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),w(n,{code:b.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="multipleOf"?n_(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),w(n,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{code:b.not_finite,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,E.toString(r))}gt(e,r){return this.setLimit("min",e,!1,E.toString(r))}lte(e,r){return this.setLimit("max",e,!0,E.toString(r))}lt(e,r){return this.setLimit("max",e,!1,E.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:E.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:E.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:E.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:E.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:E.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:E.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&H.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};sr.create=t=>new sr({checks:[],typeName:$.ZodNumber,coerce:t?.coerce||!1,...D(t)});var ir=class t extends L{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==T.bigint)return this._getInvalidInput(e);let n,o=new we;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),w(n,{code:b.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),w(n,{code:b.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),w(n,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return w(r,{code:b.invalid_type,expected:T.bigint,received:r.parsedType}),j}gte(e,r){return this.setLimit("min",e,!0,E.toString(r))}gt(e,r){return this.setLimit("min",e,!1,E.toString(r))}lte(e,r){return this.setLimit("max",e,!0,E.toString(r))}lt(e,r){return this.setLimit("max",e,!1,E.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:E.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:E.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};ir.create=t=>new ir({checks:[],typeName:$.ZodBigInt,coerce:t?.coerce??!1,...D(t)});var ar=class extends L{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==T.boolean){let n=this._getOrReturnCtx(e);return w(n,{code:b.invalid_type,expected:T.boolean,received:n.parsedType}),j}return Re(e.data)}};ar.create=t=>new ar({typeName:$.ZodBoolean,coerce:t?.coerce||!1,...D(t)});var cr=class t extends L{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==T.date){let s=this._getOrReturnCtx(e);return w(s,{code:b.invalid_type,expected:T.date,received:s.parsedType}),j}if(Number.isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return w(s,{code:b.invalid_date}),j}let n=new we,o;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(o=this._getOrReturnCtx(e,o),w(o,{code:b.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(o=this._getOrReturnCtx(e,o),w(o,{code:b.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):H.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:E.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:E.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};cr.create=t=>new cr({checks:[],coerce:t?.coerce||!1,typeName:$.ZodDate,...D(t)});var Fr=class extends L{_parse(e){if(this._getType(e)!==T.symbol){let n=this._getOrReturnCtx(e);return w(n,{code:b.invalid_type,expected:T.symbol,received:n.parsedType}),j}return Re(e.data)}};Fr.create=t=>new Fr({typeName:$.ZodSymbol,...D(t)});var ur=class extends L{_parse(e){if(this._getType(e)!==T.undefined){let n=this._getOrReturnCtx(e);return w(n,{code:b.invalid_type,expected:T.undefined,received:n.parsedType}),j}return Re(e.data)}};ur.create=t=>new ur({typeName:$.ZodUndefined,...D(t)});var lr=class extends L{_parse(e){if(this._getType(e)!==T.null){let n=this._getOrReturnCtx(e);return w(n,{code:b.invalid_type,expected:T.null,received:n.parsedType}),j}return Re(e.data)}};lr.create=t=>new lr({typeName:$.ZodNull,...D(t)});var qt=class extends L{constructor(){super(...arguments),this._any=!0}_parse(e){return Re(e.data)}};qt.create=t=>new qt({typeName:$.ZodAny,...D(t)});var Pt=class extends L{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Re(e.data)}};Pt.create=t=>new Pt({typeName:$.ZodUnknown,...D(t)});var it=class extends L{_parse(e){let r=this._getOrReturnCtx(e);return w(r,{code:b.invalid_type,expected:T.never,received:r.parsedType}),j}};it.create=t=>new it({typeName:$.ZodNever,...D(t)});var Hr=class extends L{_parse(e){if(this._getType(e)!==T.undefined){let n=this._getOrReturnCtx(e);return w(n,{code:b.invalid_type,expected:T.void,received:n.parsedType}),j}return Re(e.data)}};Hr.create=t=>new Hr({typeName:$.ZodVoid,...D(t)});var Et=class t extends L{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),o=this._def;if(r.parsedType!==T.array)return w(r,{code:b.invalid_type,expected:T.array,received:r.parsedType}),j;if(o.exactLength!==null){let i=r.data.length>o.exactLength.value,a=r.data.length<o.exactLength.value;(i||a)&&(w(r,{code:i?b.too_big:b.too_small,minimum:a?o.exactLength.value:void 0,maximum:i?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&r.data.length<o.minLength.value&&(w(r,{code:b.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(w(r,{code:b.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>o.type._parseAsync(new Ye(r,i,r.path,a)))).then(i=>we.mergeArray(n,i));let s=[...r.data].map((i,a)=>o.type._parseSync(new Ye(r,i,r.path,a)));return we.mergeArray(n,s)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:E.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:E.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:E.toString(r)}})}nonempty(e){return this.min(1,e)}};Et.create=(t,e)=>new Et({type:t,minLength:null,maxLength:null,exactLength:null,typeName:$.ZodArray,...D(e)});function Vr(t){if(t instanceof Le){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=qe.create(Vr(n))}return new Le({...t._def,shape:()=>e})}else return t instanceof Et?new Et({...t._def,type:Vr(t.element)}):t instanceof qe?qe.create(Vr(t.unwrap())):t instanceof yt?yt.create(Vr(t.unwrap())):t instanceof gt?gt.create(t.items.map(e=>Vr(e))):t}var Le=class t extends L{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=H.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==T.object){let u=this._getOrReturnCtx(e);return w(u,{code:b.invalid_type,expected:T.object,received:u.parsedType}),j}let{status:n,ctx:o}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof it&&this._def.unknownKeys==="strip"))for(let u in o.data)i.includes(u)||a.push(u);let c=[];for(let u of i){let l=s[u],d=o.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Ye(o,d,o.path,u)),alwaysSet:u in o.data})}if(this._def.catchall instanceof it){let u=this._def.unknownKeys;if(u==="passthrough")for(let l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:o.data[l]}});else if(u==="strict")a.length>0&&(w(o,{code:b.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let l of a){let d=o.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Ye(o,d,o.path,l)),alwaysSet:l in o.data})}}return o.common.async?Promise.resolve().then(async()=>{let u=[];for(let l of c){let d=await l.key,h=await l.value;u.push({key:d,value:h,alwaysSet:l.alwaysSet})}return u}).then(u=>we.mergeObjectSync(n,u)):we.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return E.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let o=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:E.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:$.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of H.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of H.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return Vr(this)}partial(e){let r={};for(let n of H.objectKeys(this.shape)){let o=this.shape[n];e&&!e[n]?r[n]=o:r[n]=o.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of H.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof qe;)s=s._def.innerType;r[n]=s}return new t({...this._def,shape:()=>r})}keyof(){return gd(H.objectKeys(this.shape))}};Le.create=(t,e)=>new Le({shape:()=>t,unknownKeys:"strip",catchall:it.create(),typeName:$.ZodObject,...D(e)});Le.strictCreate=(t,e)=>new Le({shape:()=>t,unknownKeys:"strict",catchall:it.create(),typeName:$.ZodObject,...D(e)});Le.lazycreate=(t,e)=>new Le({shape:t,unknownKeys:"strip",catchall:it.create(),typeName:$.ZodObject,...D(e)});var dr=class extends L{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function o(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=s.map(a=>new De(a.ctx.common.issues));return w(r,{code:b.invalid_union,unionErrors:i}),j}if(r.common.async)return Promise.all(n.map(async s=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(o);{let s,i=[];for(let c of n){let u={...r,common:{...r.common,issues:[]},parent:null},l=c._parseSync({data:r.data,path:r.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!s&&(s={result:l,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let a=i.map(c=>new De(c));return w(r,{code:b.invalid_union,unionErrors:a}),j}}get options(){return this._def.options}};dr.create=(t,e)=>new dr({options:t,typeName:$.ZodUnion,...D(e)});var Tt=t=>t instanceof fr?Tt(t.schema):t instanceof Xe?Tt(t.innerType()):t instanceof mr?[t.value]:t instanceof hr?t.options:t instanceof gr?H.objectValues(t.enum):t instanceof yr?Tt(t._def.innerType):t instanceof ur?[void 0]:t instanceof lr?[null]:t instanceof qe?[void 0,...Tt(t.unwrap())]:t instanceof yt?[null,...Tt(t.unwrap())]:t instanceof wn||t instanceof vr?Tt(t.unwrap()):t instanceof _r?Tt(t._def.innerType):[],Ro=class t extends L{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.object)return w(r,{code:b.invalid_type,expected:T.object,received:r.parsedType}),j;let n=this.discriminator,o=r.data[n],s=this.optionsMap.get(o);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(w(r,{code:b.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),j)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let o=new Map;for(let s of r){let i=Tt(s.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(o.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);o.set(a,s)}}return new t({typeName:$.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:o,...D(n)})}};function zi(t,e){let r=ht(t),n=ht(e);if(t===e)return{valid:!0,data:t};if(r===T.object&&n===T.object){let o=H.objectKeys(e),s=H.objectKeys(t).filter(a=>o.indexOf(a)!==-1),i={...t,...e};for(let a of s){let c=zi(t[a],e[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===T.array&&n===T.array){if(t.length!==e.length)return{valid:!1};let o=[];for(let s=0;s<t.length;s++){let i=t[s],a=e[s],c=zi(i,a);if(!c.valid)return{valid:!1};o.push(c.data)}return{valid:!0,data:o}}else return r===T.date&&n===T.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var pr=class extends L{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=(s,i)=>{if(Eo(s)||Eo(i))return j;let a=zi(s.value,i.value);return a.valid?((Io(s)||Io(i))&&r.dirty(),{status:r.value,value:a.data}):(w(n,{code:b.invalid_intersection_types}),j)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,i])=>o(s,i)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};pr.create=(t,e,r)=>new pr({left:t,right:e,typeName:$.ZodIntersection,...D(r)});var gt=class t extends L{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.array)return w(n,{code:b.invalid_type,expected:T.array,received:n.parsedType}),j;if(n.data.length<this._def.items.length)return w(n,{code:b.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),j;!this._def.rest&&n.data.length>this._def.items.length&&(w(n,{code:b.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let s=[...n.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new Ye(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(s).then(i=>we.mergeArray(r,i)):we.mergeArray(r,s)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};gt.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new gt({items:t,typeName:$.ZodTuple,rest:null,...D(e)})};var No=class t extends L{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.object)return w(n,{code:b.invalid_type,expected:T.object,received:n.parsedType}),j;let o=[],s=this._def.keyType,i=this._def.valueType;for(let a in n.data)o.push({key:s._parse(new Ye(n,a,n.path,a)),value:i._parse(new Ye(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?we.mergeObjectAsync(r,o):we.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof L?new t({keyType:e,valueType:r,typeName:$.ZodRecord,...D(n)}):new t({keyType:Dt.create(),valueType:e,typeName:$.ZodRecord,...D(r)})}},Br=class extends L{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.map)return w(n,{code:b.invalid_type,expected:T.map,received:n.parsedType}),j;let o=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map(([a,c],u)=>({key:o._parse(new Ye(n,a,n.path,[u,"key"])),value:s._parse(new Ye(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return j;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return j;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}}}};Br.create=(t,e,r)=>new Br({valueType:e,keyType:t,typeName:$.ZodMap,...D(r)});var Gr=class t extends L{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.set)return w(n,{code:b.invalid_type,expected:T.set,received:n.parsedType}),j;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(w(n,{code:b.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(w(n,{code:b.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),r.dirty());let s=this._def.valueType;function i(c){let u=new Set;for(let l of c){if(l.status==="aborted")return j;l.status==="dirty"&&r.dirty(),u.add(l.value)}return{status:r.value,value:u}}let a=[...n.data.values()].map((c,u)=>s._parse(new Ye(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:E.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:E.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Gr.create=(t,e)=>new Gr({valueType:t,minSize:null,maxSize:null,typeName:$.ZodSet,...D(e)});var Oo=class t extends L{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.function)return w(r,{code:b.invalid_type,expected:T.function,received:r.parsedType}),j;function n(a,c){return kn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Lr(),zt].filter(u=>!!u),issueData:{code:b.invalid_arguments,argumentsError:c}})}function o(a,c){return kn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Lr(),zt].filter(u=>!!u),issueData:{code:b.invalid_return_type,returnTypeError:c}})}let s={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof Lt){let a=this;return Re(async function(...c){let u=new De([]),l=await a._def.args.parseAsync(c,s).catch(f=>{throw u.addIssue(n(c,f)),u}),d=await Reflect.apply(i,this,l);return await a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw u.addIssue(o(d,f)),u})})}else{let a=this;return Re(function(...c){let u=a._def.args.safeParse(c,s);if(!u.success)throw new De([n(c,u.error)]);let l=Reflect.apply(i,this,u.data),d=a._def.returns.safeParse(l,s);if(!d.success)throw new De([o(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:gt.create(e).rest(Pt.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||gt.create([]).rest(Pt.create()),returns:r||Pt.create(),typeName:$.ZodFunction,...D(n)})}},fr=class extends L{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};fr.create=(t,e)=>new fr({getter:t,typeName:$.ZodLazy,...D(e)});var mr=class extends L{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return w(r,{received:r.data,code:b.invalid_literal,expected:this._def.value}),j}return{status:"valid",value:e.data}}get value(){return this._def.value}};mr.create=(t,e)=>new mr({value:t,typeName:$.ZodLiteral,...D(e)});function gd(t,e){return new hr({values:t,typeName:$.ZodEnum,...D(e)})}var hr=class t extends L{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return w(r,{expected:H.joinValues(n),received:r.parsedType,code:b.invalid_type}),j}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return w(r,{received:r.data,code:b.invalid_enum_value,options:n}),j}return Re(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};hr.create=gd;var gr=class extends L{_parse(e){let r=H.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==T.string&&n.parsedType!==T.number){let o=H.objectValues(r);return w(n,{expected:H.joinValues(o),received:n.parsedType,code:b.invalid_type}),j}if(this._cache||(this._cache=new Set(H.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let o=H.objectValues(r);return w(n,{received:n.data,code:b.invalid_enum_value,options:o}),j}return Re(e.data)}get enum(){return this._def.values}};gr.create=(t,e)=>new gr({values:t,typeName:$.ZodNativeEnum,...D(e)});var Lt=class extends L{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.promise&&r.common.async===!1)return w(r,{code:b.invalid_type,expected:T.promise,received:r.parsedType}),j;let n=r.parsedType===T.promise?r.data:Promise.resolve(r.data);return Re(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};Lt.create=(t,e)=>new Lt({type:t,typeName:$.ZodPromise,...D(e)});var Xe=class extends L{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=this._def.effect||null,s={addIssue:i=>{w(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),o.type==="preprocess"){let i=o.transform(n.data,s);if(n.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return j;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?j:c.status==="dirty"?or(c.value):r.value==="dirty"?or(c.value):c});{if(r.value==="aborted")return j;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?j:a.status==="dirty"?or(a.value):r.value==="dirty"?or(a.value):a}}if(o.type==="refinement"){let i=a=>{let c=o.refinement(a,s);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?j:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?j:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(o.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Mt(i))return j;let a=o.transform(i.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>Mt(i)?Promise.resolve(o.transform(i.value,s)).then(a=>({status:r.value,value:a})):j);H.assertNever(o)}};Xe.create=(t,e,r)=>new Xe({schema:t,typeName:$.ZodEffects,effect:e,...D(r)});Xe.createWithPreprocess=(t,e,r)=>new Xe({schema:e,effect:{type:"preprocess",transform:t},typeName:$.ZodEffects,...D(r)});var qe=class extends L{_parse(e){return this._getType(e)===T.undefined?Re(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};qe.create=(t,e)=>new qe({innerType:t,typeName:$.ZodOptional,...D(e)});var yt=class extends L{_parse(e){return this._getType(e)===T.null?Re(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};yt.create=(t,e)=>new yt({innerType:t,typeName:$.ZodNullable,...D(e)});var yr=class extends L{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===T.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};yr.create=(t,e)=>new yr({innerType:t,typeName:$.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...D(e)});var _r=class extends L{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Ur(o)?o.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new De(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new De(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};_r.create=(t,e)=>new _r({innerType:t,typeName:$.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...D(e)});var Kr=class extends L{_parse(e){if(this._getType(e)!==T.nan){let n=this._getOrReturnCtx(e);return w(n,{code:b.invalid_type,expected:T.nan,received:n.parsedType}),j}return{status:"valid",value:e.data}}};Kr.create=t=>new Kr({typeName:$.ZodNaN,...D(t)});var o_=Symbol("zod_brand"),wn=class extends L{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},Sn=class t extends L{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?j:s.status==="dirty"?(r.dirty(),or(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?j:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:$.ZodPipeline})}},vr=class extends L{_parse(e){let r=this._def.innerType._parse(e),n=o=>(Mt(o)&&(o.value=Object.freeze(o.value)),o);return Ur(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};vr.create=(t,e)=>new vr({innerType:t,typeName:$.ZodReadonly,...D(e)});function pd(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function yd(t,e={},r){return t?qt.create().superRefine((n,o)=>{let s=t(n);if(s instanceof Promise)return s.then(i=>{if(!i){let a=pd(e,n),c=a.fatal??r??!0;o.addIssue({code:"custom",...a,fatal:c})}});if(!s){let i=pd(e,n),a=i.fatal??r??!0;o.addIssue({code:"custom",...i,fatal:a})}}):qt.create()}var s_={object:Le.lazycreate},$;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})($||($={}));var i_=(t,e={message:`Input not instance of ${t.name}`})=>yd(r=>r instanceof t,e),_d=Dt.create,vd=sr.create,a_=Kr.create,c_=ir.create,xd=ar.create,u_=cr.create,l_=Fr.create,d_=ur.create,p_=lr.create,f_=qt.create,m_=Pt.create,h_=it.create,g_=Hr.create,y_=Et.create,Ti=Le.create,__=Le.strictCreate,v_=dr.create,x_=Ro.create,b_=pr.create,$_=gt.create,k_=No.create,w_=Br.create,S_=Gr.create,z_=Oo.create,T_=fr.create,P_=mr.create,E_=hr.create,I_=gr.create,R_=Lt.create,N_=Xe.create,O_=qe.create,Z_=yt.create,j_=Xe.createWithPreprocess,C_=Sn.create,A_=()=>_d().optional(),M_=()=>vd().optional(),D_=()=>xd().optional(),q_={string:(t=>Dt.create({...t,coerce:!0})),number:(t=>sr.create({...t,coerce:!0})),boolean:(t=>ar.create({...t,coerce:!0})),bigint:(t=>ir.create({...t,coerce:!0})),date:(t=>cr.create({...t,coerce:!0}))};var L_=j;var U_=Object.freeze({status:"aborted"});function _(t,e,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(t),e(a,c);for(let l in i.prototype)l in a||Object.defineProperty(a,l,{value:i.prototype[l].bind(a)});a._zod.constr=i,a._zod.def=c}let o=r?.Parent??Object;class s extends o{}Object.defineProperty(s,"name",{value:t});function i(a){var c;let u=r?.Parent?new s:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(let l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}var It=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},Zo={};function Ge(t){return t&&Object.assign(Zo,t),Zo}var B={};ki(B,{BIGINT_FORMAT_RANGES:()=>$d,Class:()=>Ei,NUMBER_FORMAT_RANGES:()=>Ci,aborted:()=>br,allowsEval:()=>Oi,assert:()=>G_,assertEqual:()=>V_,assertIs:()=>H_,assertNever:()=>B_,assertNotEqual:()=>F_,assignProp:()=>Ni,cached:()=>Pn,captureStackTrace:()=>Co,cleanEnum:()=>iv,cleanRegex:()=>In,clone:()=>Ke,createTransparentProxy:()=>Q_,defineLazy:()=>oe,esc:()=>xr,escapeRegex:()=>Ut,extend:()=>rv,finalizeIssue:()=>at,floatSafeRemainder:()=>Ri,getElementAtPath:()=>K_,getEnumValues:()=>Tn,getLengthableOrigin:()=>Rn,getParsedType:()=>X_,getSizableOrigin:()=>kd,isObject:()=>Jr,isPlainObject:()=>Wr,issue:()=>Ai,joinValues:()=>jo,jsonStringifyReplacer:()=>Ii,merge:()=>nv,normalizeParams:()=>C,nullish:()=>En,numKeys:()=>Y_,omit:()=>tv,optionalKeys:()=>ji,partial:()=>ov,pick:()=>ev,prefixIssues:()=>_t,primitiveTypes:()=>bd,promiseAllObject:()=>J_,propertyKeyTypes:()=>Zi,randomString:()=>W_,required:()=>sv,stringifyPrimitive:()=>Ao,unwrapMessage:()=>zn});function V_(t){return t}function F_(t){return t}function H_(t){}function B_(t){throw new Error}function G_(t){}function Tn(t){let e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,o])=>e.indexOf(+n)===-1).map(([n,o])=>o)}function jo(t,e="|"){return t.map(r=>Ao(r)).join(e)}function Ii(t,e){return typeof e=="bigint"?e.toString():e}function Pn(t){return{get value(){{let r=t();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function En(t){return t==null}function In(t){let e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function Ri(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}function oe(t,e,r){Object.defineProperty(t,e,{get(){{let o=r();return t[e]=o,o}throw new Error("cached value already set")},set(o){Object.defineProperty(t,e,{value:o})},configurable:!0})}function Ni(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function K_(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function J_(t){let e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{let o={};for(let s=0;s<e.length;s++)o[e[s]]=n[s];return o})}function W_(t=10){let e="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function xr(t){return JSON.stringify(t)}var Co=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Jr(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}var Oi=Pn(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let t=Function;return new t(""),!0}catch{return!1}});function Wr(t){if(Jr(t)===!1)return!1;let e=t.constructor;if(e===void 0)return!0;let r=e.prototype;return!(Jr(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Y_(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}var X_=t=>{let e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},Zi=new Set(["string","number","symbol"]),bd=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Ut(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ke(t,e,r){let n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function C(t){let e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function Q_(t){let e;return new Proxy({},{get(r,n,o){return e??(e=t()),Reflect.get(e,n,o)},set(r,n,o,s){return e??(e=t()),Reflect.set(e,n,o,s)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,o){return e??(e=t()),Reflect.defineProperty(e,n,o)}})}function Ao(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function ji(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}var Ci={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},$d={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function ev(t,e){let r={},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&(r[o]=n.shape[o])}return Ke(t,{...t._zod.def,shape:r,checks:[]})}function tv(t,e){let r={...t._zod.def.shape},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&delete r[o]}return Ke(t,{...t._zod.def,shape:r,checks:[]})}function rv(t,e){if(!Wr(e))throw new Error("Invalid input to extend: expected a plain object");let r={...t._zod.def,get shape(){let n={...t._zod.def.shape,...e};return Ni(this,"shape",n),n},checks:[]};return Ke(t,r)}function nv(t,e){return Ke(t,{...t._zod.def,get shape(){let r={...t._zod.def.shape,...e._zod.def.shape};return Ni(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function ov(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in n))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=t?new t({type:"optional",innerType:n[s]}):n[s])}else for(let s in n)o[s]=t?new t({type:"optional",innerType:n[s]}):n[s];return Ke(e,{...e._zod.def,shape:o,checks:[]})}function sv(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=new t({type:"nonoptional",innerType:n[s]}))}else for(let s in n)o[s]=new t({type:"nonoptional",innerType:n[s]});return Ke(e,{...e._zod.def,shape:o,checks:[]})}function br(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function _t(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function zn(t){return typeof t=="string"?t:t?.message}function at(t,e,r){let n={...t,path:t.path??[]};if(!t.message){let o=zn(t.inst?._zod.def?.error?.(t))??zn(e?.error?.(t))??zn(r.customError?.(t))??zn(r.localeError?.(t))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function kd(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function Rn(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Ai(...t){let[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function iv(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}var Ei=class{constructor(...e){}};var wd=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,Ii,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},Mo=_("$ZodError",wd),Nn=_("$ZodError",wd,{Parent:Error});function Mi(t,e=r=>r.message){let r={},n=[];for(let o of t.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:r}}function Di(t,e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>o({issues:a}));else if(i.code==="invalid_key")o({issues:i.issues});else if(i.code==="invalid_element")o({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(t),n}var qi=t=>(e,r,n,o)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new It;if(i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>at(c,s,Ge())));throw Co(a,o?.callee),a}return i.value},Li=qi(Nn),Ui=t=>async(e,r,n,o)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>at(c,s,Ge())));throw Co(a,o?.callee),a}return i.value},Vi=Ui(Nn),Fi=t=>(e,r,n)=>{let o=n?{...n,async:!1}:{async:!1},s=e._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new It;return s.issues.length?{success:!1,error:new(t??Mo)(s.issues.map(i=>at(i,o,Ge())))}:{success:!0,data:s.value}},$r=Fi(Nn),Hi=t=>async(e,r,n)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},s=e._zod.run({value:r,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(i=>at(i,o,Ge())))}:{success:!0,data:s.value}},kr=Hi(Nn);var Sd=/^[cC][^\s-]{8,}$/,zd=/^[0-9a-z]+$/,Td=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Pd=/^[0-9a-vA-V]{20}$/,Ed=/^[A-Za-z0-9]{27}$/,Id=/^[a-zA-Z0-9_-]{21}$/,Rd=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var Nd=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Bi=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;var Od=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;var cv="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Zd(){return new RegExp(cv,"u")}var jd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Cd=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Ad=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Md=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Dd=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Gi=/^[A-Za-z0-9_-]*$/,qd=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var Ld=/^\+(?:[0-9]){6,14}[0-9]$/,Ud="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Vd=new RegExp(`^${Ud}$`);function Fd(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Hd(t){return new RegExp(`^${Fd(t)}$`)}function Bd(t){let e=Fd({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${e}(?:${r.join("|")})`;return new RegExp(`^${Ud}T(?:${n})$`)}var Gd=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)};var Kd=/^\d+$/,Jd=/^-?\d+(?:\.\d+)?/i,Wd=/true|false/i,Yd=/null/i;var Xd=/^[^A-Z]*$/,Qd=/^[^a-z]*$/;var Se=_("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),ep={number:"number",bigint:"bigint",object:"date"},Ki=_("$ZodCheckLessThan",(t,e)=>{Se.init(t,e);let r=ep[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?o.maximum=e.value:o.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Ji=_("$ZodCheckGreaterThan",(t,e)=>{Se.init(t,e);let r=ep[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?o.minimum=e.value:o.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),tp=_("$ZodCheckMultipleOf",(t,e)=>{Se.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):Ri(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),rp=_("$ZodCheckNumberFormat",(t,e)=>{Se.init(t,e),e.format=e.format||"float64";let r=e.format?.includes("int"),n=r?"int":"number",[o,s]=Ci[e.format];t._zod.onattach.push(i=>{let a=i._zod.bag;a.format=e.format,a.minimum=o,a.maximum=s,r&&(a.pattern=Kd)}),t._zod.check=i=>{let a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:e.format,code:"invalid_type",input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}a<o&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:t,continue:!e.abort}),a>s&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:t})}});var np=_("$ZodCheckMaxLength",(t,e)=>{var r;Se.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!En(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<o&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let o=n.value;if(o.length<=e.maximum)return;let i=Rn(o);n.issues.push({origin:i,code:"too_big",maximum:e.maximum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),op=_("$ZodCheckMinLength",(t,e)=>{var r;Se.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!En(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>o&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let o=n.value;if(o.length>=e.minimum)return;let i=Rn(o);n.issues.push({origin:i,code:"too_small",minimum:e.minimum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),sp=_("$ZodCheckLengthEquals",(t,e)=>{var r;Se.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!En(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag;o.minimum=e.length,o.maximum=e.length,o.length=e.length}),t._zod.check=n=>{let o=n.value,s=o.length;if(s===e.length)return;let i=Rn(o),a=s>e.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),On=_("$ZodCheckStringFormat",(t,e)=>{var r,n;Se.init(t,e),t._zod.onattach.push(o=>{let s=o._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=o=>{e.pattern.lastIndex=0,!e.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:e.format,input:o.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),ip=_("$ZodCheckRegex",(t,e)=>{On.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),ap=_("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Xd),On.init(t,e)}),cp=_("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Qd),On.init(t,e)}),up=_("$ZodCheckIncludes",(t,e)=>{Se.init(t,e);let r=Ut(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(o=>{let s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),t._zod.check=o=>{o.value.includes(e.includes,e.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:o.value,inst:t,continue:!e.abort})}}),lp=_("$ZodCheckStartsWith",(t,e)=>{Se.init(t,e);let r=new RegExp(`^${Ut(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),dp=_("$ZodCheckEndsWith",(t,e)=>{Se.init(t,e);let r=new RegExp(`.*${Ut(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});var pp=_("$ZodCheckOverwrite",(t,e)=>{Se.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});var qo=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let n=e.split(`
`).filter(i=>i),o=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(let i of s)this.content.push(i)}compile(){let e=Function,r=this?.args,o=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...r,o.join(`
`))}};var mp={major:4,minor:0,patch:0};var te=_("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=mp;let n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(let o of n)for(let s of o._zod.onattach)s(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let o=(s,i,a)=>{let c=br(s),u;for(let l of i){if(l._zod.def.when){if(!l._zod.def.when(s))continue}else if(c)continue;let d=s.issues.length,h=l._zod.check(s);if(h instanceof Promise&&a?.async===!1)throw new It;if(u||h instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await h,s.issues.length!==d&&(c||(c=br(s,d)))});else{if(s.issues.length===d)continue;c||(c=br(s,d))}}return u?u.then(()=>s):s};t._zod.run=(s,i)=>{let a=t._zod.parse(s,i);if(a instanceof Promise){if(i.async===!1)throw new It;return a.then(c=>o(c,n,i))}return o(a,n,i)}}t["~standard"]={validate:o=>{try{let s=$r(t,o);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return kr(t,o).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),Zn=_("$ZodString",(t,e)=>{te.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??Gd(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),se=_("$ZodStringFormat",(t,e)=>{On.init(t,e),Zn.init(t,e)}),Yi=_("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=Nd),se.init(t,e)}),Xi=_("$ZodUUID",(t,e)=>{if(e.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Bi(n))}else e.pattern??(e.pattern=Bi());se.init(t,e)}),Qi=_("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=Od),se.init(t,e)}),ea=_("$ZodURL",(t,e)=>{se.init(t,e),t._zod.check=r=>{try{let n=r.value,o=new URL(n),s=o.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:qd.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&s.endsWith("/")?r.value=s.slice(0,-1):r.value=s;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),ta=_("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=Zd()),se.init(t,e)}),ra=_("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=Id),se.init(t,e)}),na=_("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=Sd),se.init(t,e)}),oa=_("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=zd),se.init(t,e)}),sa=_("$ZodULID",(t,e)=>{e.pattern??(e.pattern=Td),se.init(t,e)}),ia=_("$ZodXID",(t,e)=>{e.pattern??(e.pattern=Pd),se.init(t,e)}),aa=_("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=Ed),se.init(t,e)}),wp=_("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=Bd(e)),se.init(t,e)}),Sp=_("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Vd),se.init(t,e)}),zp=_("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=Hd(e)),se.init(t,e)}),Tp=_("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=Rd),se.init(t,e)}),ca=_("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=jd),se.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv4"})}),ua=_("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Cd),se.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),la=_("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Ad),se.init(t,e)}),da=_("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=Md),se.init(t,e),t._zod.check=r=>{let[n,o]=r.value.split("/");try{if(!o)throw new Error;let s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function Pp(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}var pa=_("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=Dd),se.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{Pp(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function uv(t){if(!Gi.test(t))return!1;let e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return Pp(r)}var fa=_("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=Gi),se.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{uv(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),ma=_("$ZodE164",(t,e)=>{e.pattern??(e.pattern=Ld),se.init(t,e)});function lv(t,e=null){try{let r=t.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let o=JSON.parse(atob(n));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||e&&(!("alg"in o)||o.alg!==e))}catch{return!1}}var ha=_("$ZodJWT",(t,e)=>{se.init(t,e),t._zod.check=r=>{lv(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}});var Uo=_("$ZodNumber",(t,e)=>{te.init(t,e),t._zod.pattern=t._zod.bag.pattern??Jd,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}let o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;let s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:t,...s?{received:s}:{}}),r}}),ga=_("$ZodNumber",(t,e)=>{rp.init(t,e),Uo.init(t,e)}),ya=_("$ZodBoolean",(t,e)=>{te.init(t,e),t._zod.pattern=Wd,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}let o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:t}),r}});var _a=_("$ZodNull",(t,e)=>{te.init(t,e),t._zod.pattern=Yd,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{let o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:t}),r}});var va=_("$ZodUnknown",(t,e)=>{te.init(t,e),t._zod.parse=r=>r}),xa=_("$ZodNever",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)});function hp(t,e,r){t.issues.length&&e.issues.push(..._t(r,t.issues)),e.value[r]=t.value}var ba=_("$ZodArray",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:t}),r;r.value=Array(o.length);let s=[];for(let i=0;i<o.length;i++){let a=o[i],c=e.element._zod.run({value:a,issues:[]},n);c instanceof Promise?s.push(c.then(u=>hp(u,r,i))):hp(c,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function Lo(t,e,r){t.issues.length&&e.issues.push(..._t(r,t.issues)),e.value[r]=t.value}function gp(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(..._t(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}var Vo=_("$ZodObject",(t,e)=>{te.init(t,e);let r=Pn(()=>{let d=Object.keys(e.shape);for(let f of d)if(!(e.shape[f]instanceof te))throw new Error(`Invalid element at key "${f}": expected a Zod schema`);let h=ji(e.shape);return{shape:e.shape,keys:d,keySet:new Set(d),numKeys:d.length,optionalKeys:new Set(h)}});oe(t._zod,"propValues",()=>{let d=e.shape,h={};for(let f in d){let p=d[f]._zod;if(p.values){h[f]??(h[f]=new Set);for(let m of p.values)h[f].add(m)}}return h});let n=d=>{let h=new qo(["shape","payload","ctx"]),f=r.value,p=x=>{let k=xr(x);return`shape[${k}]._zod.run({ value: input[${k}], issues: [] }, ctx)`};h.write("const input = payload.value;");let m=Object.create(null),g=0;for(let x of f.keys)m[x]=`key_${g++}`;h.write("const newResult = {}");for(let x of f.keys)if(f.optionalKeys.has(x)){let k=m[x];h.write(`const ${k} = ${p(x)};`);let S=xr(x);h.write(`
        if (${k}.issues.length) {
          if (input[${S}] === undefined) {
            if (${S} in input) {
              newResult[${S}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${k}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${S}, ...iss.path] : [${S}],
              }))
            );
          }
        } else if (${k}.value === undefined) {
          if (${S} in input) newResult[${S}] = undefined;
        } else {
          newResult[${S}] = ${k}.value;
        }
        `)}else{let k=m[x];h.write(`const ${k} = ${p(x)};`),h.write(`
          if (${k}.issues.length) payload.issues = payload.issues.concat(${k}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${xr(x)}, ...iss.path] : [${xr(x)}]
          })));`),h.write(`newResult[${xr(x)}] = ${k}.value`)}h.write("payload.value = newResult;"),h.write("return payload;");let v=h.compile();return(x,k)=>v(d,x,k)},o,s=Jr,i=!Zo.jitless,c=i&&Oi.value,u=e.catchall,l;t._zod.parse=(d,h)=>{l??(l=r.value);let f=d.value;if(!s(f))return d.issues.push({expected:"object",code:"invalid_type",input:f,inst:t}),d;let p=[];if(i&&c&&h?.async===!1&&h.jitless!==!0)o||(o=n(e.shape)),d=o(d,h);else{d.value={};let k=l.shape;for(let S of l.keys){let O=k[S],ue=O._zod.run({value:f[S],issues:[]},h),We=O._zod.optin==="optional"&&O._zod.optout==="optional";ue instanceof Promise?p.push(ue.then(qr=>We?gp(qr,d,S,f):Lo(qr,d,S))):We?gp(ue,d,S,f):Lo(ue,d,S)}}if(!u)return p.length?Promise.all(p).then(()=>d):d;let m=[],g=l.keySet,v=u._zod,x=v.def.type;for(let k of Object.keys(f)){if(g.has(k))continue;if(x==="never"){m.push(k);continue}let S=v.run({value:f[k],issues:[]},h);S instanceof Promise?p.push(S.then(O=>Lo(O,d,k))):Lo(S,d,k)}return m.length&&d.issues.push({code:"unrecognized_keys",keys:m,input:f,inst:t}),p.length?Promise.all(p).then(()=>d):d}});function yp(t,e,r,n){for(let o of t)if(o.issues.length===0)return e.value=o.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(o=>o.issues.map(s=>at(s,n,Ge())))}),e}var Fo=_("$ZodUnion",(t,e)=>{te.init(t,e),oe(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),oe(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),oe(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),oe(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){let r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>In(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let o=!1,s=[];for(let i of e.options){let a=i._zod.run({value:r.value,issues:[]},n);if(a instanceof Promise)s.push(a),o=!0;else{if(a.issues.length===0)return a;s.push(a)}}return o?Promise.all(s).then(i=>yp(i,r,t,n)):yp(s,r,t,n)}}),$a=_("$ZodDiscriminatedUnion",(t,e)=>{Fo.init(t,e);let r=t._zod.parse;oe(t._zod,"propValues",()=>{let o={};for(let s of e.options){let i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(let[a,c]of Object.entries(i)){o[a]||(o[a]=new Set);for(let u of c)o[a].add(u)}}return o});let n=Pn(()=>{let o=e.options,s=new Map;for(let i of o){let a=i._zod.propValues[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(let c of a){if(s.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);s.set(c,i)}}return s});t._zod.parse=(o,s)=>{let i=o.value;if(!Jr(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:t}),o;let a=n.value.get(i?.[e.discriminator]);return a?a._zod.run(o,s):e.unionFallback?r(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[e.discriminator],inst:t}),o)}}),ka=_("$ZodIntersection",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=r.value,s=e.left._zod.run({value:o,issues:[]},n),i=e.right._zod.run({value:o,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([c,u])=>_p(r,c,u)):_p(r,s,i)}});function Wi(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Wr(t)&&Wr(e)){let r=Object.keys(e),n=Object.keys(t).filter(s=>r.indexOf(s)!==-1),o={...t,...e};for(let s of n){let i=Wi(t[s],e[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<t.length;n++){let o=t[n],s=e[n],i=Wi(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function _p(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),br(t))return t;let n=Wi(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}var wa=_("$ZodRecord",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Wr(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:t}),r;let s=[];if(e.keyType._zod.values){let i=e.keyType._zod.values;r.value={};for(let c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let u=e.valueType._zod.run({value:o[c],issues:[]},n);u instanceof Promise?s.push(u.then(l=>{l.issues.length&&r.issues.push(..._t(c,l.issues)),r.value[c]=l.value})):(u.issues.length&&r.issues.push(..._t(c,u.issues)),r.value[c]=u.value)}let a;for(let c in o)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:t,keys:a})}else{r.value={};for(let i of Reflect.ownKeys(o)){if(i==="__proto__")continue;let a=e.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(u=>at(u,n,Ge())),input:i,path:[i],inst:t}),r.value[a.value]=a.value;continue}let c=e.valueType._zod.run({value:o[i],issues:[]},n);c instanceof Promise?s.push(c.then(u=>{u.issues.length&&r.issues.push(..._t(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(..._t(i,c.issues)),r.value[a.value]=c.value)}}return s.length?Promise.all(s).then(()=>r):r}});var Sa=_("$ZodEnum",(t,e)=>{te.init(t,e);let r=Tn(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>Zi.has(typeof n)).map(n=>typeof n=="string"?Ut(n):n.toString()).join("|")})$`),t._zod.parse=(n,o)=>{let s=n.value;return t._zod.values.has(s)||n.issues.push({code:"invalid_value",values:r,input:s,inst:t}),n}}),za=_("$ZodLiteral",(t,e)=>{te.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?Ut(r):r?r.toString():String(r)).join("|")})$`),t._zod.parse=(r,n)=>{let o=r.value;return t._zod.values.has(o)||r.issues.push({code:"invalid_value",values:e.values,input:o,inst:t}),r}});var Ta=_("$ZodTransform",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=e.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(r.value=i,r));if(o instanceof Promise)throw new It;return r.value=o,r}}),Pa=_("$ZodOptional",(t,e)=>{te.init(t,e),t._zod.optin="optional",t._zod.optout="optional",oe(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),oe(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${In(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),Ea=_("$ZodNullable",(t,e)=>{te.init(t,e),oe(t._zod,"optin",()=>e.innerType._zod.optin),oe(t._zod,"optout",()=>e.innerType._zod.optout),oe(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${In(r.source)}|null)$`):void 0}),oe(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),Ia=_("$ZodDefault",(t,e)=>{te.init(t,e),t._zod.optin="optional",oe(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>vp(s,e)):vp(o,e)}});function vp(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}var Ra=_("$ZodPrefault",(t,e)=>{te.init(t,e),t._zod.optin="optional",oe(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),Na=_("$ZodNonOptional",(t,e)=>{te.init(t,e),oe(t._zod,"values",()=>{let r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>xp(s,t)):xp(o,t)}});function xp(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}var Oa=_("$ZodCatch",(t,e)=>{te.init(t,e),t._zod.optin="optional",oe(t._zod,"optout",()=>e.innerType._zod.optout),oe(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.value,s.issues.length&&(r.value=e.catchValue({...r,error:{issues:s.issues.map(i=>at(i,n,Ge()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=e.catchValue({...r,error:{issues:o.issues.map(s=>at(s,n,Ge()))},input:r.value}),r.issues=[]),r)}});var Za=_("$ZodPipe",(t,e)=>{te.init(t,e),oe(t._zod,"values",()=>e.in._zod.values),oe(t._zod,"optin",()=>e.in._zod.optin),oe(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(r,n)=>{let o=e.in._zod.run(r,n);return o instanceof Promise?o.then(s=>bp(s,e,n)):bp(o,e,n)}});function bp(t,e,r){return br(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}var ja=_("$ZodReadonly",(t,e)=>{te.init(t,e),oe(t._zod,"propValues",()=>e.innerType._zod.propValues),oe(t._zod,"values",()=>e.innerType._zod.values),oe(t._zod,"optin",()=>e.innerType._zod.optin),oe(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then($p):$p(o)}});function $p(t){return t.value=Object.freeze(t.value),t}var Ca=_("$ZodCustom",(t,e)=>{Se.init(t,e),te.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{let n=r.value,o=e.fn(n);if(o instanceof Promise)return o.then(s=>kp(s,r,n,t));kp(o,r,n,t)}});function kp(t,e,r,n){if(!t){let o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),e.issues.push(Ai(o))}}var dv=t=>{let e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},pv=()=>{let t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${dv(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${Ao(n.values[0])}`:`Invalid option: expected one of ${jo(n.values,"|")}`;case"too_big":{let o=n.inclusive?"<=":"<",s=e(n.origin);return s?`Too big: expected ${n.origin??"value"} to have ${o}${n.maximum.toString()} ${s.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${o}${n.maximum.toString()}`}case"too_small":{let o=n.inclusive?">=":">",s=e(n.origin);return s?`Too small: expected ${n.origin} to have ${o}${n.minimum.toString()} ${s.unit}`:`Too small: expected ${n.origin} to be ${o}${n.minimum.toString()}`}case"invalid_format":{let o=n;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${jo(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function Ep(){return{localeError:pv()}}var jn=class{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){let n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){let r=e._zod.parent;if(r){let n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}};function Ip(){return new jn}var Vt=Ip();function Aa(t,e){return new t({type:"string",...C(e)})}function Ma(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...C(e)})}function Ho(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...C(e)})}function Da(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...C(e)})}function qa(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...C(e)})}function La(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...C(e)})}function Ua(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...C(e)})}function Va(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...C(e)})}function Fa(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...C(e)})}function Ha(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...C(e)})}function Ba(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...C(e)})}function Ga(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...C(e)})}function Ka(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...C(e)})}function Ja(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...C(e)})}function Wa(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...C(e)})}function Ya(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...C(e)})}function Xa(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...C(e)})}function Qa(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...C(e)})}function ec(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...C(e)})}function tc(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...C(e)})}function rc(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...C(e)})}function nc(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...C(e)})}function oc(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...C(e)})}function Rp(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...C(e)})}function Np(t,e){return new t({type:"string",format:"date",check:"string_format",...C(e)})}function Op(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...C(e)})}function Zp(t,e){return new t({type:"string",format:"duration",check:"string_format",...C(e)})}function sc(t,e){return new t({type:"number",checks:[],...C(e)})}function ic(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...C(e)})}function ac(t,e){return new t({type:"boolean",...C(e)})}function cc(t,e){return new t({type:"null",...C(e)})}function uc(t){return new t({type:"unknown"})}function lc(t,e){return new t({type:"never",...C(e)})}function Bo(t,e){return new Ki({check:"less_than",...C(e),value:t,inclusive:!1})}function Cn(t,e){return new Ki({check:"less_than",...C(e),value:t,inclusive:!0})}function Go(t,e){return new Ji({check:"greater_than",...C(e),value:t,inclusive:!1})}function An(t,e){return new Ji({check:"greater_than",...C(e),value:t,inclusive:!0})}function Ko(t,e){return new tp({check:"multiple_of",...C(e),value:t})}function Jo(t,e){return new np({check:"max_length",...C(e),maximum:t})}function Yr(t,e){return new op({check:"min_length",...C(e),minimum:t})}function Wo(t,e){return new sp({check:"length_equals",...C(e),length:t})}function dc(t,e){return new ip({check:"string_format",format:"regex",...C(e),pattern:t})}function pc(t){return new ap({check:"string_format",format:"lowercase",...C(t)})}function fc(t){return new cp({check:"string_format",format:"uppercase",...C(t)})}function mc(t,e){return new up({check:"string_format",format:"includes",...C(e),includes:t})}function hc(t,e){return new lp({check:"string_format",format:"starts_with",...C(e),prefix:t})}function gc(t,e){return new dp({check:"string_format",format:"ends_with",...C(e),suffix:t})}function wr(t){return new pp({check:"overwrite",tx:t})}function yc(t){return wr(e=>e.normalize(t))}function _c(){return wr(t=>t.trim())}function vc(){return wr(t=>t.toLowerCase())}function xc(){return wr(t=>t.toUpperCase())}function jp(t,e,r){return new t({type:"array",element:e,...C(r)})}function bc(t,e,r){let n=C(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function $c(t,e,r){return new t({type:"custom",check:"custom",fn:e,...C(r)})}var Yo=class{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??Vt,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,r={path:[],schemaPath:[]}){var n;let o=e._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},i=this.seen.get(e);if(i)return i.count++,r.schemaPath.includes(e)&&(i.cycle=r.path),i.schema;let a={schema:{},count:1,cycle:void 0,path:r.path};this.seen.set(e,a);let c=e._zod.toJSONSchema?.();if(c)a.schema=c;else{let d={...r,schemaPath:[...r.schemaPath,e],path:r.path},h=e._zod.parent;if(h)a.ref=h,this.process(h,d),this.seen.get(h).isParent=!0;else{let f=a.schema;switch(o.type){case"string":{let p=f;p.type="string";let{minimum:m,maximum:g,format:v,patterns:x,contentEncoding:k}=e._zod.bag;if(typeof m=="number"&&(p.minLength=m),typeof g=="number"&&(p.maxLength=g),v&&(p.format=s[v]??v,p.format===""&&delete p.format),k&&(p.contentEncoding=k),x&&x.size>0){let S=[...x];S.length===1?p.pattern=S[0].source:S.length>1&&(a.schema.allOf=[...S.map(O=>({...this.target==="draft-7"?{type:"string"}:{},pattern:O.source}))])}break}case"number":{let p=f,{minimum:m,maximum:g,format:v,multipleOf:x,exclusiveMaximum:k,exclusiveMinimum:S}=e._zod.bag;typeof v=="string"&&v.includes("int")?p.type="integer":p.type="number",typeof S=="number"&&(p.exclusiveMinimum=S),typeof m=="number"&&(p.minimum=m,typeof S=="number"&&(S>=m?delete p.minimum:delete p.exclusiveMinimum)),typeof k=="number"&&(p.exclusiveMaximum=k),typeof g=="number"&&(p.maximum=g,typeof k=="number"&&(k<=g?delete p.maximum:delete p.exclusiveMaximum)),typeof x=="number"&&(p.multipleOf=x);break}case"boolean":{let p=f;p.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{f.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{f.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{let p=f,{minimum:m,maximum:g}=e._zod.bag;typeof m=="number"&&(p.minItems=m),typeof g=="number"&&(p.maxItems=g),p.type="array",p.items=this.process(o.element,{...d,path:[...d.path,"items"]});break}case"object":{let p=f;p.type="object",p.properties={};let m=o.shape;for(let x in m)p.properties[x]=this.process(m[x],{...d,path:[...d.path,"properties",x]});let g=new Set(Object.keys(m)),v=new Set([...g].filter(x=>{let k=o.shape[x]._zod;return this.io==="input"?k.optin===void 0:k.optout===void 0}));v.size>0&&(p.required=Array.from(v)),o.catchall?._zod.def.type==="never"?p.additionalProperties=!1:o.catchall?o.catchall&&(p.additionalProperties=this.process(o.catchall,{...d,path:[...d.path,"additionalProperties"]})):this.io==="output"&&(p.additionalProperties=!1);break}case"union":{let p=f;p.anyOf=o.options.map((m,g)=>this.process(m,{...d,path:[...d.path,"anyOf",g]}));break}case"intersection":{let p=f,m=this.process(o.left,{...d,path:[...d.path,"allOf",0]}),g=this.process(o.right,{...d,path:[...d.path,"allOf",1]}),v=k=>"allOf"in k&&Object.keys(k).length===1,x=[...v(m)?m.allOf:[m],...v(g)?g.allOf:[g]];p.allOf=x;break}case"tuple":{let p=f;p.type="array";let m=o.items.map((x,k)=>this.process(x,{...d,path:[...d.path,"prefixItems",k]}));if(this.target==="draft-2020-12"?p.prefixItems=m:p.items=m,o.rest){let x=this.process(o.rest,{...d,path:[...d.path,"items"]});this.target==="draft-2020-12"?p.items=x:p.additionalItems=x}o.rest&&(p.items=this.process(o.rest,{...d,path:[...d.path,"items"]}));let{minimum:g,maximum:v}=e._zod.bag;typeof g=="number"&&(p.minItems=g),typeof v=="number"&&(p.maxItems=v);break}case"record":{let p=f;p.type="object",p.propertyNames=this.process(o.keyType,{...d,path:[...d.path,"propertyNames"]}),p.additionalProperties=this.process(o.valueType,{...d,path:[...d.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{let p=f,m=Tn(o.entries);m.every(g=>typeof g=="number")&&(p.type="number"),m.every(g=>typeof g=="string")&&(p.type="string"),p.enum=m;break}case"literal":{let p=f,m=[];for(let g of o.values)if(g===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof g=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");m.push(Number(g))}else m.push(g);if(m.length!==0)if(m.length===1){let g=m[0];p.type=g===null?"null":typeof g,p.const=g}else m.every(g=>typeof g=="number")&&(p.type="number"),m.every(g=>typeof g=="string")&&(p.type="string"),m.every(g=>typeof g=="boolean")&&(p.type="string"),m.every(g=>g===null)&&(p.type="null"),p.enum=m;break}case"file":{let p=f,m={type:"string",format:"binary",contentEncoding:"binary"},{minimum:g,maximum:v,mime:x}=e._zod.bag;g!==void 0&&(m.minLength=g),v!==void 0&&(m.maxLength=v),x?x.length===1?(m.contentMediaType=x[0],Object.assign(p,m)):p.anyOf=x.map(k=>({...m,contentMediaType:k})):Object.assign(p,m);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let p=this.process(o.innerType,d);f.anyOf=[p,{type:"null"}];break}case"nonoptional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"success":{let p=f;p.type="boolean";break}case"default":{this.process(o.innerType,d),a.ref=o.innerType,f.default=JSON.parse(JSON.stringify(o.defaultValue));break}case"prefault":{this.process(o.innerType,d),a.ref=o.innerType,this.io==="input"&&(f._prefault=JSON.parse(JSON.stringify(o.defaultValue)));break}case"catch":{this.process(o.innerType,d),a.ref=o.innerType;let p;try{p=o.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}f.default=p;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let p=f,m=e._zod.pattern;if(!m)throw new Error("Pattern not found in template literal");p.type="string",p.pattern=m.source;break}case"pipe":{let p=this.io==="input"?o.in._zod.def.type==="transform"?o.out:o.in:o.out;this.process(p,d),a.ref=p;break}case"readonly":{this.process(o.innerType,d),a.ref=o.innerType,f.readOnly=!0;break}case"promise":{this.process(o.innerType,d),a.ref=o.innerType;break}case"optional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"lazy":{let p=e._zod.innerType;this.process(p,d),a.ref=p;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}default:}}}let u=this.metadataRegistry.get(e);return u&&Object.assign(a.schema,u),this.io==="input"&&be(e)&&(delete a.schema.examples,delete a.schema.default),this.io==="input"&&a.schema._prefault&&((n=a.schema).default??(n.default=a.schema._prefault)),delete a.schema._prefault,this.seen.get(e).schema}emit(e,r){let n={cycles:r?.cycles??"ref",reused:r?.reused??"inline",external:r?.external??void 0},o=this.seen.get(e);if(!o)throw new Error("Unprocessed schema. This is a bug in Zod.");let s=l=>{let d=this.target==="draft-2020-12"?"$defs":"definitions";if(n.external){let m=n.external.registry.get(l[0])?.id,g=n.external.uri??(x=>x);if(m)return{ref:g(m)};let v=l[1].defId??l[1].schema.id??`schema${this.counter++}`;return l[1].defId=v,{defId:v,ref:`${g("__shared")}#/${d}/${v}`}}if(l[1]===o)return{ref:"#"};let f=`#/${d}/`,p=l[1].schema.id??`__schema${this.counter++}`;return{defId:p,ref:f+p}},i=l=>{if(l[1].schema.$ref)return;let d=l[1],{ref:h,defId:f}=s(l);d.def={...d.schema},f&&(d.defId=f);let p=d.schema;for(let m in p)delete p[m];p.$ref=h};if(n.cycles==="throw")for(let l of this.seen.entries()){let d=l[1];if(d.cycle)throw new Error(`Cycle detected: #/${d.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let l of this.seen.entries()){let d=l[1];if(e===l[0]){i(l);continue}if(n.external){let f=n.external.registry.get(l[0])?.id;if(e!==l[0]&&f){i(l);continue}}if(this.metadataRegistry.get(l[0])?.id){i(l);continue}if(d.cycle){i(l);continue}if(d.count>1&&n.reused==="ref"){i(l);continue}}let a=(l,d)=>{let h=this.seen.get(l),f=h.def??h.schema,p={...f};if(h.ref===null)return;let m=h.ref;if(h.ref=null,m){a(m,d);let g=this.seen.get(m).schema;g.$ref&&d.target==="draft-7"?(f.allOf=f.allOf??[],f.allOf.push(g)):(Object.assign(f,g),Object.assign(f,p))}h.isParent||this.override({zodSchema:l,jsonSchema:f,path:h.path??[]})};for(let l of[...this.seen.entries()].reverse())a(l[0],{target:this.target});let c={};if(this.target==="draft-2020-12"?c.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?c.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),n.external?.uri){let l=n.external.registry.get(e)?.id;if(!l)throw new Error("Schema is missing an `id` property");c.$id=n.external.uri(l)}Object.assign(c,o.def);let u=n.external?.defs??{};for(let l of this.seen.entries()){let d=l[1];d.def&&d.defId&&(u[d.defId]=d.def)}n.external||Object.keys(u).length>0&&(this.target==="draft-2020-12"?c.$defs=u:c.definitions=u);try{return JSON.parse(JSON.stringify(c))}catch{throw new Error("Error converting schema to JSON.")}}};function kc(t,e){if(t instanceof jn){let n=new Yo(e),o={};for(let a of t._idmap.entries()){let[c,u]=a;n.process(u)}let s={},i={registry:t,uri:e?.uri,defs:o};for(let a of t._idmap.entries()){let[c,u]=a;s[c]=n.emit(u,{...e,external:i})}if(Object.keys(o).length>0){let a=n.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[a]:o}}return{schemas:s}}let r=new Yo(e);return r.process(t),r.emit(t,e)}function be(t,e){let r=e??{seen:new Set};if(r.seen.has(t))return!1;r.seen.add(t);let o=t._zod.def;switch(o.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return be(o.element,r);case"object":{for(let s in o.shape)if(be(o.shape[s],r))return!0;return!1}case"union":{for(let s of o.options)if(be(s,r))return!0;return!1}case"intersection":return be(o.left,r)||be(o.right,r);case"tuple":{for(let s of o.items)if(be(s,r))return!0;return!!(o.rest&&be(o.rest,r))}case"record":return be(o.keyType,r)||be(o.valueType,r);case"map":return be(o.keyType,r)||be(o.valueType,r);case"set":return be(o.valueType,r);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return be(o.innerType,r);case"lazy":return be(o.getter(),r);case"default":return be(o.innerType,r);case"prefault":return be(o.innerType,r);case"custom":return!1;case"transform":return!0;case"pipe":return be(o.in,r)||be(o.out,r);case"success":return!1;case"catch":return!1;default:}throw new Error(`Unknown schema type: ${o.type}`)}var Gv=_("ZodMiniType",(t,e)=>{if(!t._zod)throw new Error("Uninitialized schema in ZodMiniType.");te.init(t,e),t.def=e,t.parse=(r,n)=>Li(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>$r(t,r,n),t.parseAsync=async(r,n)=>Vi(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>kr(t,r,n),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Ke(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t))});var Kv=_("ZodMiniObject",(t,e)=>{Vo.init(t,e),Gv.init(t,e),B.defineLazy(t,"shape",()=>e.shape)});function wc(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new Kv(r)}function Qe(t){return!!t._zod}function zr(t){let e=Object.values(t);if(e.length===0)return wc({});let r=e.every(Qe),n=e.every(o=>!Qe(o));if(r)return wc(t);if(n)return Ti(t);throw new Error("Mixed Zod versions detected in object shape.")}function Ft(t,e){return Qe(t)?$r(t,e):t.safeParse(e)}async function Xo(t,e){return Qe(t)?await kr(t,e):await t.safeParseAsync(e)}function Ht(t){if(!t)return;let e;if(Qe(t)?e=t._zod?.def?.shape:e=t.shape,!!e){if(typeof e=="function")try{return e()}catch{return}return e}}function Xr(t){if(t){if(typeof t=="object"){let e=t,r=t;if(!e._def&&!r._zod){let n=Object.values(t);if(n.length>0&&n.every(o=>typeof o=="object"&&o!==null&&(o._def!==void 0||o._zod!==void 0||typeof o.parse=="function")))return zr(t)}}if(Qe(t)){let r=t._zod?.def;if(r&&(r.type==="object"||r.shape!==void 0))return t}else if(t.shape!==void 0)return t}}function Qo(t){if(t&&typeof t=="object"){if("message"in t&&typeof t.message=="string")return t.message;if("issues"in t&&Array.isArray(t.issues)&&t.issues.length>0){let e=t.issues[0];if(e&&typeof e=="object"&&"message"in e)return String(e.message)}try{return JSON.stringify(t)}catch{return String(t)}}return String(t)}function Ap(t){return t.description}function Mp(t){if(Qe(t))return t._zod?.def?.type==="optional";let e=t;return typeof t.isOptional=="function"?t.isOptional():e._def?.typeName==="ZodOptional"}function es(t){if(Qe(t)){let s=t._zod?.def;if(s){if(s.value!==void 0)return s.value;if(Array.isArray(s.values)&&s.values.length>0)return s.values[0]}}let r=t._def;if(r){if(r.value!==void 0)return r.value;if(Array.isArray(r.values)&&r.values.length>0)return r.values[0]}let n=t.value;if(n!==void 0)return n}var Mn={};ki(Mn,{ZodISODate:()=>qp,ZodISODateTime:()=>Dp,ZodISODuration:()=>Up,ZodISOTime:()=>Lp,date:()=>zc,datetime:()=>Sc,duration:()=>Pc,time:()=>Tc});var Dp=_("ZodISODateTime",(t,e)=>{wp.init(t,e),pe.init(t,e)});function Sc(t){return Rp(Dp,t)}var qp=_("ZodISODate",(t,e)=>{Sp.init(t,e),pe.init(t,e)});function zc(t){return Np(qp,t)}var Lp=_("ZodISOTime",(t,e)=>{zp.init(t,e),pe.init(t,e)});function Tc(t){return Op(Lp,t)}var Up=_("ZodISODuration",(t,e)=>{Tp.init(t,e),pe.init(t,e)});function Pc(t){return Zp(Up,t)}var Vp=(t,e)=>{Mo.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>Di(t,r)},flatten:{value:r=>Mi(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},kE=_("ZodError",Vp),Dn=_("ZodError",Vp,{Parent:Error});var Fp=qi(Dn),Hp=Ui(Dn),Bp=Fi(Dn),Gp=Hi(Dn);var ye=_("ZodType",(t,e)=>(te.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Ke(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>Fp(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>Bp(t,r,n),t.parseAsync=async(r,n)=>Hp(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>Gp(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(Hx(r,n)),t.superRefine=r=>t.check(Bx(r)),t.overwrite=r=>t.check(wr(r)),t.optional=()=>ge(t),t.nullable=()=>Wp(t),t.nullish=()=>ge(Wp(t)),t.nonoptional=r=>Mx(t,r),t.array=()=>G(t),t.or=r=>ie([t,r]),t.and=r=>rs(t,r),t.transform=r=>Ic(t,tf(r)),t.default=r=>jx(t,r),t.prefault=r=>Ax(t,r),t.catch=r=>qx(t,r),t.pipe=r=>Ic(t,r),t.readonly=()=>Vx(t),t.describe=r=>{let n=t.clone();return Vt.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return Vt.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return Vt.get(t);let n=t.clone();return Vt.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Yp=_("_ZodString",(t,e)=>{Zn.init(t,e),ye.init(t,e);let r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(dc(...n)),t.includes=(...n)=>t.check(mc(...n)),t.startsWith=(...n)=>t.check(hc(...n)),t.endsWith=(...n)=>t.check(gc(...n)),t.min=(...n)=>t.check(Yr(...n)),t.max=(...n)=>t.check(Jo(...n)),t.length=(...n)=>t.check(Wo(...n)),t.nonempty=(...n)=>t.check(Yr(1,...n)),t.lowercase=n=>t.check(pc(n)),t.uppercase=n=>t.check(fc(n)),t.trim=()=>t.check(_c()),t.normalize=(...n)=>t.check(yc(...n)),t.toLowerCase=()=>t.check(vc()),t.toUpperCase=()=>t.check(xc())}),nx=_("ZodString",(t,e)=>{Zn.init(t,e),Yp.init(t,e),t.email=r=>t.check(Ma(ox,r)),t.url=r=>t.check(Va(sx,r)),t.jwt=r=>t.check(oc(xx,r)),t.emoji=r=>t.check(Fa(ix,r)),t.guid=r=>t.check(Ho(Kp,r)),t.uuid=r=>t.check(Da(ts,r)),t.uuidv4=r=>t.check(qa(ts,r)),t.uuidv6=r=>t.check(La(ts,r)),t.uuidv7=r=>t.check(Ua(ts,r)),t.nanoid=r=>t.check(Ha(ax,r)),t.guid=r=>t.check(Ho(Kp,r)),t.cuid=r=>t.check(Ba(cx,r)),t.cuid2=r=>t.check(Ga(ux,r)),t.ulid=r=>t.check(Ka(lx,r)),t.base64=r=>t.check(tc(yx,r)),t.base64url=r=>t.check(rc(_x,r)),t.xid=r=>t.check(Ja(dx,r)),t.ksuid=r=>t.check(Wa(px,r)),t.ipv4=r=>t.check(Ya(fx,r)),t.ipv6=r=>t.check(Xa(mx,r)),t.cidrv4=r=>t.check(Qa(hx,r)),t.cidrv6=r=>t.check(ec(gx,r)),t.e164=r=>t.check(nc(vx,r)),t.datetime=r=>t.check(Sc(r)),t.date=r=>t.check(zc(r)),t.time=r=>t.check(Tc(r)),t.duration=r=>t.check(Pc(r))});function y(t){return Aa(nx,t)}var pe=_("ZodStringFormat",(t,e)=>{se.init(t,e),Yp.init(t,e)}),ox=_("ZodEmail",(t,e)=>{Qi.init(t,e),pe.init(t,e)});var Kp=_("ZodGUID",(t,e)=>{Yi.init(t,e),pe.init(t,e)});var ts=_("ZodUUID",(t,e)=>{Xi.init(t,e),pe.init(t,e)});var sx=_("ZodURL",(t,e)=>{ea.init(t,e),pe.init(t,e)});var ix=_("ZodEmoji",(t,e)=>{ta.init(t,e),pe.init(t,e)});var ax=_("ZodNanoID",(t,e)=>{ra.init(t,e),pe.init(t,e)});var cx=_("ZodCUID",(t,e)=>{na.init(t,e),pe.init(t,e)});var ux=_("ZodCUID2",(t,e)=>{oa.init(t,e),pe.init(t,e)});var lx=_("ZodULID",(t,e)=>{sa.init(t,e),pe.init(t,e)});var dx=_("ZodXID",(t,e)=>{ia.init(t,e),pe.init(t,e)});var px=_("ZodKSUID",(t,e)=>{aa.init(t,e),pe.init(t,e)});var fx=_("ZodIPv4",(t,e)=>{ca.init(t,e),pe.init(t,e)});var mx=_("ZodIPv6",(t,e)=>{ua.init(t,e),pe.init(t,e)});var hx=_("ZodCIDRv4",(t,e)=>{la.init(t,e),pe.init(t,e)});var gx=_("ZodCIDRv6",(t,e)=>{da.init(t,e),pe.init(t,e)});var yx=_("ZodBase64",(t,e)=>{pa.init(t,e),pe.init(t,e)});var _x=_("ZodBase64URL",(t,e)=>{fa.init(t,e),pe.init(t,e)});var vx=_("ZodE164",(t,e)=>{ma.init(t,e),pe.init(t,e)});var xx=_("ZodJWT",(t,e)=>{ha.init(t,e),pe.init(t,e)});var Xp=_("ZodNumber",(t,e)=>{Uo.init(t,e),ye.init(t,e),t.gt=(n,o)=>t.check(Go(n,o)),t.gte=(n,o)=>t.check(An(n,o)),t.min=(n,o)=>t.check(An(n,o)),t.lt=(n,o)=>t.check(Bo(n,o)),t.lte=(n,o)=>t.check(Cn(n,o)),t.max=(n,o)=>t.check(Cn(n,o)),t.int=n=>t.check(Jp(n)),t.safe=n=>t.check(Jp(n)),t.positive=n=>t.check(Go(0,n)),t.nonnegative=n=>t.check(An(0,n)),t.negative=n=>t.check(Bo(0,n)),t.nonpositive=n=>t.check(Cn(0,n)),t.multipleOf=(n,o)=>t.check(Ko(n,o)),t.step=(n,o)=>t.check(Ko(n,o)),t.finite=()=>t;let r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function ee(t){return sc(Xp,t)}var bx=_("ZodNumberFormat",(t,e)=>{ga.init(t,e),Xp.init(t,e)});function Jp(t){return ic(bx,t)}var $x=_("ZodBoolean",(t,e)=>{ya.init(t,e),ye.init(t,e)});function $e(t){return ac($x,t)}var kx=_("ZodNull",(t,e)=>{_a.init(t,e),ye.init(t,e)});function Rc(t){return cc(kx,t)}var wx=_("ZodUnknown",(t,e)=>{va.init(t,e),ye.init(t,e)});function fe(){return uc(wx)}var Sx=_("ZodNever",(t,e)=>{xa.init(t,e),ye.init(t,e)});function zx(t){return lc(Sx,t)}var Tx=_("ZodArray",(t,e)=>{ba.init(t,e),ye.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Yr(r,n)),t.nonempty=r=>t.check(Yr(1,r)),t.max=(r,n)=>t.check(Jo(r,n)),t.length=(r,n)=>t.check(Wo(r,n)),t.unwrap=()=>t.element});function G(t,e){return jp(Tx,t,e)}var Qp=_("ZodObject",(t,e)=>{Vo.init(t,e),ye.init(t,e),B.defineLazy(t,"shape",()=>e.shape),t.keyof=()=>Ue(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:fe()}),t.loose=()=>t.clone({...t._zod.def,catchall:fe()}),t.strict=()=>t.clone({...t._zod.def,catchall:zx()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>B.extend(t,r),t.merge=r=>B.merge(t,r),t.pick=r=>B.pick(t,r),t.omit=r=>B.omit(t,r),t.partial=(...r)=>B.partial(rf,t,r[0]),t.required=(...r)=>B.required(nf,t,r[0])});function P(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new Qp(r)}function je(t,e){return new Qp({type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},catchall:fe(),...B.normalizeParams(e)})}var ef=_("ZodUnion",(t,e)=>{Fo.init(t,e),ye.init(t,e),t.options=e.options});function ie(t,e){return new ef({type:"union",options:t,...B.normalizeParams(e)})}var Px=_("ZodDiscriminatedUnion",(t,e)=>{ef.init(t,e),$a.init(t,e)});function Nc(t,e,r){return new Px({type:"union",options:e,discriminator:t,...B.normalizeParams(r)})}var Ex=_("ZodIntersection",(t,e)=>{ka.init(t,e),ye.init(t,e)});function rs(t,e){return new Ex({type:"intersection",left:t,right:e})}var Ix=_("ZodRecord",(t,e)=>{wa.init(t,e),ye.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function me(t,e,r){return new Ix({type:"record",keyType:t,valueType:e,...B.normalizeParams(r)})}var Ec=_("ZodEnum",(t,e)=>{Sa.init(t,e),ye.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);let r=new Set(Object.keys(e.entries));t.extract=(n,o)=>{let s={};for(let i of n)if(r.has(i))s[i]=e.entries[i];else throw new Error(`Key ${i} not found in enum`);return new Ec({...e,checks:[],...B.normalizeParams(o),entries:s})},t.exclude=(n,o)=>{let s={...e.entries};for(let i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new Ec({...e,checks:[],...B.normalizeParams(o),entries:s})}});function Ue(t,e){let r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new Ec({type:"enum",entries:r,...B.normalizeParams(e)})}var Rx=_("ZodLiteral",(t,e)=>{za.init(t,e),ye.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function R(t,e){return new Rx({type:"literal",values:Array.isArray(t)?t:[t],...B.normalizeParams(e)})}var Nx=_("ZodTransform",(t,e)=>{Ta.init(t,e),ye.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=s=>{if(typeof s=="string")r.issues.push(B.issue(s,r.value,e));else{let i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=t),i.continue??(i.continue=!0),r.issues.push(B.issue(i))}};let o=e.transform(r.value,r);return o instanceof Promise?o.then(s=>(r.value=s,r)):(r.value=o,r)}});function tf(t){return new Nx({type:"transform",transform:t})}var rf=_("ZodOptional",(t,e)=>{Pa.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType});function ge(t){return new rf({type:"optional",innerType:t})}var Ox=_("ZodNullable",(t,e)=>{Ea.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Wp(t){return new Ox({type:"nullable",innerType:t})}var Zx=_("ZodDefault",(t,e)=>{Ia.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function jx(t,e){return new Zx({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var Cx=_("ZodPrefault",(t,e)=>{Ra.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Ax(t,e){return new Cx({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var nf=_("ZodNonOptional",(t,e)=>{Na.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Mx(t,e){return new nf({type:"nonoptional",innerType:t,...B.normalizeParams(e)})}var Dx=_("ZodCatch",(t,e)=>{Oa.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function qx(t,e){return new Dx({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}var Lx=_("ZodPipe",(t,e)=>{Za.init(t,e),ye.init(t,e),t.in=e.in,t.out=e.out});function Ic(t,e){return new Lx({type:"pipe",in:t,out:e})}var Ux=_("ZodReadonly",(t,e)=>{ja.init(t,e),ye.init(t,e)});function Vx(t){return new Ux({type:"readonly",innerType:t})}var of=_("ZodCustom",(t,e)=>{Ca.init(t,e),ye.init(t,e)});function Fx(t){let e=new Se({check:"custom"});return e._zod.check=t,e}function sf(t,e){return bc(of,t??(()=>!0),e)}function Hx(t,e={}){return $c(of,t,e)}function Bx(t){let e=Fx(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(B.issue(n,r.value,e._zod.def));else{let o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=e),o.continue??(o.continue=!e._zod.def.abort),r.issues.push(B.issue(o))}},t(r.value,r)));return e}function Oc(t,e){return Ic(tf(t),e)}Ge(Ep());var jc="2025-11-25";var af=[jc,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Bt="io.modelcontextprotocol/related-task",os="2.0",ze=sf(t=>t!==null&&(typeof t=="object"||typeof t=="function")),cf=ie([y(),ee().int()]),uf=y(),AE=je({ttl:ie([ee(),Rc()]).optional(),pollInterval:ee().optional()}),Gx=P({ttl:ee().optional()}),Kx=P({taskId:y()}),Cc=je({progressToken:cf.optional(),[Bt]:Kx.optional()}),Je=P({_meta:Cc.optional()}),qn=Je.extend({task:Gx.optional()}),lf=t=>qn.safeParse(t).success,Te=P({method:y(),params:Je.loose().optional()}),et=P({_meta:Cc.optional()}),tt=P({method:y(),params:et.loose().optional()}),Pe=je({_meta:Cc.optional()}),ss=ie([y(),ee().int()]),df=P({jsonrpc:R(os),id:ss,...Te.shape}).strict(),Ac=t=>df.safeParse(t).success,pf=P({jsonrpc:R(os),...tt.shape}).strict(),ff=t=>pf.safeParse(t).success,Mc=P({jsonrpc:R(os),id:ss,result:Pe}).strict(),Ln=t=>Mc.safeParse(t).success;var Z;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(Z||(Z={}));var Dc=P({jsonrpc:R(os),id:ss.optional(),error:P({code:ee().int(),message:y(),data:fe().optional()})}).strict();var mf=t=>Dc.safeParse(t).success;var hf=ie([df,pf,Mc,Dc]),ME=ie([Mc,Dc]),is=Pe.strict(),Jx=et.extend({requestId:ss.optional(),reason:y().optional()}),as=tt.extend({method:R("notifications/cancelled"),params:Jx}),Wx=P({src:y(),mimeType:y().optional(),sizes:G(y()).optional(),theme:Ue(["light","dark"]).optional()}),Un=P({icons:G(Wx).optional()}),Qr=P({name:y(),title:y().optional()}),gf=Qr.extend({...Qr.shape,...Un.shape,version:y(),websiteUrl:y().optional(),description:y().optional()}),Yx=rs(P({applyDefaults:$e().optional()}),me(y(),fe())),Xx=Oc(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,rs(P({form:Yx.optional(),url:ze.optional()}),me(y(),fe()).optional())),Qx=je({list:ze.optional(),cancel:ze.optional(),requests:je({sampling:je({createMessage:ze.optional()}).optional(),elicitation:je({create:ze.optional()}).optional()}).optional()}),eb=je({list:ze.optional(),cancel:ze.optional(),requests:je({tools:je({call:ze.optional()}).optional()}).optional()}),tb=P({experimental:me(y(),ze).optional(),sampling:P({context:ze.optional(),tools:ze.optional()}).optional(),elicitation:Xx.optional(),roots:P({listChanged:$e().optional()}).optional(),tasks:Qx.optional()}),rb=Je.extend({protocolVersion:y(),capabilities:tb,clientInfo:gf}),qc=Te.extend({method:R("initialize"),params:rb});var nb=P({experimental:me(y(),ze).optional(),logging:ze.optional(),completions:ze.optional(),prompts:P({listChanged:$e().optional()}).optional(),resources:P({subscribe:$e().optional(),listChanged:$e().optional()}).optional(),tools:P({listChanged:$e().optional()}).optional(),tasks:eb.optional()}),ob=Pe.extend({protocolVersion:y(),capabilities:nb,serverInfo:gf,instructions:y().optional()}),Lc=tt.extend({method:R("notifications/initialized"),params:et.optional()});var cs=Te.extend({method:R("ping"),params:Je.optional()}),sb=P({progress:ee(),total:ge(ee()),message:ge(y())}),ib=P({...et.shape,...sb.shape,progressToken:cf}),us=tt.extend({method:R("notifications/progress"),params:ib}),ab=Je.extend({cursor:uf.optional()}),Vn=Te.extend({params:ab.optional()}),Fn=Pe.extend({nextCursor:uf.optional()}),cb=Ue(["working","input_required","completed","failed","cancelled"]),Hn=P({taskId:y(),status:cb,ttl:ie([ee(),Rc()]),createdAt:y(),lastUpdatedAt:y(),pollInterval:ge(ee()),statusMessage:ge(y())}),en=Pe.extend({task:Hn}),ub=et.merge(Hn),Bn=tt.extend({method:R("notifications/tasks/status"),params:ub}),ls=Te.extend({method:R("tasks/get"),params:Je.extend({taskId:y()})}),ds=Pe.merge(Hn),ps=Te.extend({method:R("tasks/result"),params:Je.extend({taskId:y()})}),DE=Pe.loose(),fs=Vn.extend({method:R("tasks/list")}),ms=Fn.extend({tasks:G(Hn)}),hs=Te.extend({method:R("tasks/cancel"),params:Je.extend({taskId:y()})}),yf=Pe.merge(Hn),_f=P({uri:y(),mimeType:ge(y()),_meta:me(y(),fe()).optional()}),vf=_f.extend({text:y()}),Uc=y().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),xf=_f.extend({blob:Uc}),Gn=Ue(["user","assistant"]),tn=P({audience:G(Gn).optional(),priority:ee().min(0).max(1).optional(),lastModified:Mn.datetime({offset:!0}).optional()}),bf=P({...Qr.shape,...Un.shape,uri:y(),description:ge(y()),mimeType:ge(y()),annotations:tn.optional(),_meta:ge(je({}))}),lb=P({...Qr.shape,...Un.shape,uriTemplate:y(),description:ge(y()),mimeType:ge(y()),annotations:tn.optional(),_meta:ge(je({}))}),gs=Vn.extend({method:R("resources/list")}),db=Fn.extend({resources:G(bf)}),ys=Vn.extend({method:R("resources/templates/list")}),pb=Fn.extend({resourceTemplates:G(lb)}),Vc=Je.extend({uri:y()}),fb=Vc,_s=Te.extend({method:R("resources/read"),params:fb}),mb=Pe.extend({contents:G(ie([vf,xf]))}),hb=tt.extend({method:R("notifications/resources/list_changed"),params:et.optional()}),gb=Vc,yb=Te.extend({method:R("resources/subscribe"),params:gb}),_b=Vc,vb=Te.extend({method:R("resources/unsubscribe"),params:_b}),xb=et.extend({uri:y()}),bb=tt.extend({method:R("notifications/resources/updated"),params:xb}),$b=P({name:y(),description:ge(y()),required:ge($e())}),kb=P({...Qr.shape,...Un.shape,description:ge(y()),arguments:ge(G($b)),_meta:ge(je({}))}),vs=Vn.extend({method:R("prompts/list")}),wb=Fn.extend({prompts:G(kb)}),Sb=Je.extend({name:y(),arguments:me(y(),y()).optional()}),xs=Te.extend({method:R("prompts/get"),params:Sb}),Fc=P({type:R("text"),text:y(),annotations:tn.optional(),_meta:me(y(),fe()).optional()}),Hc=P({type:R("image"),data:Uc,mimeType:y(),annotations:tn.optional(),_meta:me(y(),fe()).optional()}),Bc=P({type:R("audio"),data:Uc,mimeType:y(),annotations:tn.optional(),_meta:me(y(),fe()).optional()}),zb=P({type:R("tool_use"),name:y(),id:y(),input:me(y(),fe()),_meta:me(y(),fe()).optional()}),Tb=P({type:R("resource"),resource:ie([vf,xf]),annotations:tn.optional(),_meta:me(y(),fe()).optional()}),Pb=bf.extend({type:R("resource_link")}),Gc=ie([Fc,Hc,Bc,Pb,Tb]),Eb=P({role:Gn,content:Gc}),Ib=Pe.extend({description:y().optional(),messages:G(Eb)}),Rb=tt.extend({method:R("notifications/prompts/list_changed"),params:et.optional()}),Nb=P({title:y().optional(),readOnlyHint:$e().optional(),destructiveHint:$e().optional(),idempotentHint:$e().optional(),openWorldHint:$e().optional()}),Ob=P({taskSupport:Ue(["required","optional","forbidden"]).optional()}),$f=P({...Qr.shape,...Un.shape,description:y().optional(),inputSchema:P({type:R("object"),properties:me(y(),ze).optional(),required:G(y()).optional()}).catchall(fe()),outputSchema:P({type:R("object"),properties:me(y(),ze).optional(),required:G(y()).optional()}).catchall(fe()).optional(),annotations:Nb.optional(),execution:Ob.optional(),_meta:me(y(),fe()).optional()}),bs=Vn.extend({method:R("tools/list")}),Zb=Fn.extend({tools:G($f)}),$s=Pe.extend({content:G(Gc).default([]),structuredContent:me(y(),fe()).optional(),isError:$e().optional()}),qE=$s.or(Pe.extend({toolResult:fe()})),jb=qn.extend({name:y(),arguments:me(y(),fe()).optional()}),rn=Te.extend({method:R("tools/call"),params:jb}),Cb=tt.extend({method:R("notifications/tools/list_changed"),params:et.optional()}),LE=P({autoRefresh:$e().default(!0),debounceMs:ee().int().nonnegative().default(300)}),Kn=Ue(["debug","info","notice","warning","error","critical","alert","emergency"]),Ab=Je.extend({level:Kn}),Kc=Te.extend({method:R("logging/setLevel"),params:Ab}),Mb=et.extend({level:Kn,logger:y().optional(),data:fe()}),Db=tt.extend({method:R("notifications/message"),params:Mb}),qb=P({name:y().optional()}),Lb=P({hints:G(qb).optional(),costPriority:ee().min(0).max(1).optional(),speedPriority:ee().min(0).max(1).optional(),intelligencePriority:ee().min(0).max(1).optional()}),Ub=P({mode:Ue(["auto","required","none"]).optional()}),Vb=P({type:R("tool_result"),toolUseId:y().describe("The unique identifier for the corresponding tool call."),content:G(Gc).default([]),structuredContent:P({}).loose().optional(),isError:$e().optional(),_meta:me(y(),fe()).optional()}),Fb=Nc("type",[Fc,Hc,Bc]),ns=Nc("type",[Fc,Hc,Bc,zb,Vb]),Hb=P({role:Gn,content:ie([ns,G(ns)]),_meta:me(y(),fe()).optional()}),Bb=qn.extend({messages:G(Hb),modelPreferences:Lb.optional(),systemPrompt:y().optional(),includeContext:Ue(["none","thisServer","allServers"]).optional(),temperature:ee().optional(),maxTokens:ee().int(),stopSequences:G(y()).optional(),metadata:ze.optional(),tools:G($f).optional(),toolChoice:Ub.optional()}),Gb=Te.extend({method:R("sampling/createMessage"),params:Bb}),Jc=Pe.extend({model:y(),stopReason:ge(Ue(["endTurn","stopSequence","maxTokens"]).or(y())),role:Gn,content:Fb}),Wc=Pe.extend({model:y(),stopReason:ge(Ue(["endTurn","stopSequence","maxTokens","toolUse"]).or(y())),role:Gn,content:ie([ns,G(ns)])}),Kb=P({type:R("boolean"),title:y().optional(),description:y().optional(),default:$e().optional()}),Jb=P({type:R("string"),title:y().optional(),description:y().optional(),minLength:ee().optional(),maxLength:ee().optional(),format:Ue(["email","uri","date","date-time"]).optional(),default:y().optional()}),Wb=P({type:Ue(["number","integer"]),title:y().optional(),description:y().optional(),minimum:ee().optional(),maximum:ee().optional(),default:ee().optional()}),Yb=P({type:R("string"),title:y().optional(),description:y().optional(),enum:G(y()),default:y().optional()}),Xb=P({type:R("string"),title:y().optional(),description:y().optional(),oneOf:G(P({const:y(),title:y()})),default:y().optional()}),Qb=P({type:R("string"),title:y().optional(),description:y().optional(),enum:G(y()),enumNames:G(y()).optional(),default:y().optional()}),e$=ie([Yb,Xb]),t$=P({type:R("array"),title:y().optional(),description:y().optional(),minItems:ee().optional(),maxItems:ee().optional(),items:P({type:R("string"),enum:G(y())}),default:G(y()).optional()}),r$=P({type:R("array"),title:y().optional(),description:y().optional(),minItems:ee().optional(),maxItems:ee().optional(),items:P({anyOf:G(P({const:y(),title:y()}))}),default:G(y()).optional()}),n$=ie([t$,r$]),o$=ie([Qb,e$,n$]),s$=ie([o$,Kb,Jb,Wb]),i$=qn.extend({mode:R("form").optional(),message:y(),requestedSchema:P({type:R("object"),properties:me(y(),s$),required:G(y()).optional()})}),a$=qn.extend({mode:R("url"),message:y(),elicitationId:y(),url:y().url()}),c$=ie([i$,a$]),u$=Te.extend({method:R("elicitation/create"),params:c$}),l$=et.extend({elicitationId:y()}),d$=tt.extend({method:R("notifications/elicitation/complete"),params:l$}),ks=Pe.extend({action:Ue(["accept","decline","cancel"]),content:Oc(t=>t===null?void 0:t,me(y(),ie([y(),ee(),$e(),G(y())])).optional())}),p$=P({type:R("ref/resource"),uri:y()});var f$=P({type:R("ref/prompt"),name:y()}),m$=Je.extend({ref:ie([f$,p$]),argument:P({name:y(),value:y()}),context:P({arguments:me(y(),y()).optional()}).optional()}),ws=Te.extend({method:R("completion/complete"),params:m$});function kf(t){if(t.params.ref.type!=="ref/prompt")throw new TypeError(`Expected CompleteRequestPrompt, but got ${t.params.ref.type}`)}function wf(t){if(t.params.ref.type!=="ref/resource")throw new TypeError(`Expected CompleteRequestResourceTemplate, but got ${t.params.ref.type}`)}var h$=Pe.extend({completion:je({values:G(y()).max(100),total:ge(ee().int()),hasMore:ge($e())})}),g$=P({uri:y().startsWith("file://"),name:y().optional(),_meta:me(y(),fe()).optional()}),y$=Te.extend({method:R("roots/list"),params:Je.optional()}),Yc=Pe.extend({roots:G(g$)}),_$=tt.extend({method:R("notifications/roots/list_changed"),params:et.optional()}),UE=ie([cs,qc,ws,Kc,xs,vs,gs,ys,_s,yb,vb,rn,bs,ls,ps,fs,hs]),VE=ie([as,us,Lc,_$,Bn]),FE=ie([is,Jc,Wc,ks,Yc,ds,ms,en]),HE=ie([cs,Gb,u$,y$,ls,ps,fs,hs]),BE=ie([as,us,Db,bb,hb,Cb,Rb,Bn,d$]),GE=ie([is,ob,h$,Ib,wb,db,pb,mb,$s,Zb,ds,ms,en]),I=class t extends Error{constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}static fromError(e,r,n){if(e===Z.UrlElicitationRequired&&n){let o=n;if(o.elicitations)return new Zc(o.elicitations,r)}return new t(e,r,n)}},Zc=class extends I{constructor(e,r=`URL elicitation${e.length>1?"s":""} required`){super(Z.UrlElicitationRequired,r,{elicitations:e})}get elicitations(){return this.data?.elicitations??[]}};function Gt(t){return t==="completed"||t==="failed"||t==="cancelled"}var zf=Symbol("Let zodToJsonSchema decide on which parser to use");var Sf={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},Tf=t=>typeof t=="string"?{...Sf,name:t}:{...Sf,...t};var Pf=t=>{let e=Tf(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,o])=>[o._def,{def:o._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Xc(t,e,r,n){n?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function K(t,e,r,n,o){t[e]=r,Xc(t,e,n,o)}var Ss=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")};function he(t){if(t.target!=="openAi")return{};let e=[...t.basePath,t.definitionPath,t.openAiAnyTypeName];return t.flags.hasReferencedOpenAiAnyType=!0,{$ref:t.$refStrategy==="relative"?Ss(e,t.currentPath):e.join("/")}}function Ef(t,e){let r={type:"array"};return t.type?._def&&t.type?._def?.typeName!==$.ZodAny&&(r.items=A(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&K(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&K(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(K(r,"minItems",t.exactLength.value,t.exactLength.message,e),K(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function If(t,e){let r={type:"integer",format:"int64"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?K(r,"minimum",n.value,n.message,e):K(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),K(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?K(r,"maximum",n.value,n.message,e):K(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),K(r,"maximum",n.value,n.message,e));break;case"multipleOf":K(r,"multipleOf",n.value,n.message,e);break}return r}function Rf(){return{type:"boolean"}}function zs(t,e){return A(t.type._def,e)}var Nf=(t,e)=>A(t.innerType._def,e);function Qc(t,e,r){let n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((o,s)=>Qc(t,e,o))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return v$(t,e)}}var v$=(t,e)=>{let r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(let n of t.checks)switch(n.kind){case"min":K(r,"minimum",n.value,n.message,e);break;case"max":K(r,"maximum",n.value,n.message,e);break}return r};function Of(t,e){return{...A(t.innerType._def,e),default:t.defaultValue()}}function Zf(t,e){return e.effectStrategy==="input"?A(t.schema._def,e):he(e)}function jf(t){return{type:"string",enum:Array.from(t.values)}}var x$=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function Cf(t,e){let r=[A(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),A(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s),n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,o=[];return r.forEach(s=>{if(x$(s))o.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else{let i=s;if("additionalProperties"in s&&s.additionalProperties===!1){let{additionalProperties:a,...c}=s;i=c}else n=void 0;o.push(i)}}),o.length?{allOf:o,...n}:void 0}function Af(t,e){let r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}var eu,ct={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(eu===void 0&&(eu=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),eu),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Ts(t,e){let r={type:"string"};if(t.checks)for(let n of t.checks)switch(n.kind){case"min":K(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e);break;case"max":K(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":ut(r,"email",n.message,e);break;case"format:idn-email":ut(r,"idn-email",n.message,e);break;case"pattern:zod":Ce(r,ct.email,n.message,e);break}break;case"url":ut(r,"uri",n.message,e);break;case"uuid":ut(r,"uuid",n.message,e);break;case"regex":Ce(r,n.regex,n.message,e);break;case"cuid":Ce(r,ct.cuid,n.message,e);break;case"cuid2":Ce(r,ct.cuid2,n.message,e);break;case"startsWith":Ce(r,RegExp(`^${tu(n.value,e)}`),n.message,e);break;case"endsWith":Ce(r,RegExp(`${tu(n.value,e)}$`),n.message,e);break;case"datetime":ut(r,"date-time",n.message,e);break;case"date":ut(r,"date",n.message,e);break;case"time":ut(r,"time",n.message,e);break;case"duration":ut(r,"duration",n.message,e);break;case"length":K(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e),K(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"includes":{Ce(r,RegExp(tu(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&ut(r,"ipv4",n.message,e),n.version!=="v4"&&ut(r,"ipv6",n.message,e);break}case"base64url":Ce(r,ct.base64url,n.message,e);break;case"jwt":Ce(r,ct.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&Ce(r,ct.ipv4Cidr,n.message,e),n.version!=="v4"&&Ce(r,ct.ipv6Cidr,n.message,e);break}case"emoji":Ce(r,ct.emoji(),n.message,e);break;case"ulid":{Ce(r,ct.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{ut(r,"binary",n.message,e);break}case"contentEncoding:base64":{K(r,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{Ce(r,ct.base64,n.message,e);break}}break}case"nanoid":Ce(r,ct.nanoid,n.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function tu(t,e){return e.patternStrategy==="escape"?$$(t):t}var b$=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function $$(t){let e="";for(let r=0;r<t.length;r++)b$.has(t[r])||(e+="\\"),e+=t[r];return e}function ut(t,e,r,n){t.format||t.anyOf?.some(o=>o.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):K(t,"format",e,r,n)}function Ce(t,e,r,n){t.pattern||t.allOf?.some(o=>o.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:Mf(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):K(t,"pattern",Mf(e,n),r,n)}function Mf(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;let r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},n=r.i?t.source.toLowerCase():t.source,o="",s=!1,i=!1,a=!1;for(let c=0;c<n.length;c++){if(s){o+=n[c],s=!1;continue}if(r.i){if(i){if(n[c].match(/[a-z]/)){a?(o+=n[c],o+=`${n[c-2]}-${n[c]}`.toUpperCase(),a=!1):n[c+1]==="-"&&n[c+2]?.match(/[a-z]/)?(o+=n[c],a=!0):o+=`${n[c]}${n[c].toUpperCase()}`;continue}}else if(n[c].match(/[a-z]/)){o+=`[${n[c]}${n[c].toUpperCase()}]`;continue}}if(r.m){if(n[c]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(n[c]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&n[c]==="."){o+=i?`${n[c]}\r
`:`[${n[c]}\r
]`;continue}o+=n[c],n[c]==="\\"?s=!0:i&&n[c]==="]"?i=!1:!i&&n[c]==="["&&(i=!0)}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return o}function Ps(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===$.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((n,o)=>({...n,[o]:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",o]})??he(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};let r={type:"object",additionalProperties:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(t.keyType?._def.typeName===$.ZodString&&t.keyType._def.checks?.length){let{type:n,...o}=Ts(t.keyType._def,e);return{...r,propertyNames:o}}else{if(t.keyType?._def.typeName===$.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===$.ZodBranded&&t.keyType._def.type._def.typeName===$.ZodString&&t.keyType._def.type._def.checks?.length){let{type:n,...o}=zs(t.keyType._def,e);return{...r,propertyNames:o}}}return r}function Df(t,e){if(e.mapStrategy==="record")return Ps(t,e);let r=A(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||he(e),n=A(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||he(e);return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function qf(t){let e=t.values,n=Object.keys(t.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),o=Array.from(new Set(n.map(s=>typeof s)));return{type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:n}}function Lf(t){return t.target==="openAi"?void 0:{not:he({...t,currentPath:[...t.currentPath,"not"]})}}function Uf(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Jn={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Ff(t,e){if(e.target==="openApi3")return Vf(t,e);let r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in Jn&&(!n._def.checks||!n._def.checks.length))){let n=r.reduce((o,s)=>{let i=Jn[s._def.typeName];return i&&!o.includes(i)?[...o,i]:o},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=r.reduce((o,s)=>{let i=typeof s._def.value;switch(i){case"string":case"number":case"boolean":return[...o,i];case"bigint":return[...o,"integer"];case"object":if(s._def.value===null)return[...o,"null"];default:return o}},[]);if(n.length===r.length){let o=n.filter((s,i,a)=>a.indexOf(s)===i);return{type:o.length>1?o:o[0],enum:r.reduce((s,i)=>s.includes(i._def.value)?s:[...s,i._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,o)=>[...n,...o._def.values.filter(s=>!n.includes(s))],[])};return Vf(t,e)}var Vf=(t,e)=>{let r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,o)=>A(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${o}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function Hf(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Jn[t.innerType._def.typeName],nullable:!0}:{type:[Jn[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let n=A(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let r=A(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function Bf(t,e){let r={type:"number"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"int":r.type="integer",Xc(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?K(r,"minimum",n.value,n.message,e):K(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),K(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?K(r,"maximum",n.value,n.message,e):K(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),K(r,"maximum",n.value,n.message,e));break;case"multipleOf":K(r,"multipleOf",n.value,n.message,e);break}return r}function Gf(t,e){let r=e.target==="openAi",n={type:"object",properties:{}},o=[],s=t.shape();for(let a in s){let c=s[a];if(c===void 0||c._def===void 0)continue;let u=w$(c);u&&r&&(c._def.typeName==="ZodOptional"&&(c=c._def.innerType),c.isNullable()||(c=c.nullable()),u=!1);let l=A(c._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});l!==void 0&&(n.properties[a]=l,u||o.push(a))}o.length&&(n.required=o);let i=k$(t,e);return i!==void 0&&(n.additionalProperties=i),n}function k$(t,e){if(t.catchall._def.typeName!=="ZodNever")return A(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function w$(t){try{return t.isOptional()}catch{return!0}}var Kf=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return A(t.innerType._def,e);let r=A(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:he(e)},r]}:he(e)};var Jf=(t,e)=>{if(e.pipeStrategy==="input")return A(t.in._def,e);if(e.pipeStrategy==="output")return A(t.out._def,e);let r=A(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=A(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(o=>o!==void 0)}};function Wf(t,e){return A(t.type._def,e)}function Yf(t,e){let n={type:"array",uniqueItems:!0,items:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&K(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&K(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function Xf(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>A(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:A(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>A(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function Qf(t){return{not:he(t)}}function em(t){return he(t)}var tm=(t,e)=>A(t.innerType._def,e);var rm=(t,e,r)=>{switch(e){case $.ZodString:return Ts(t,r);case $.ZodNumber:return Bf(t,r);case $.ZodObject:return Gf(t,r);case $.ZodBigInt:return If(t,r);case $.ZodBoolean:return Rf();case $.ZodDate:return Qc(t,r);case $.ZodUndefined:return Qf(r);case $.ZodNull:return Uf(r);case $.ZodArray:return Ef(t,r);case $.ZodUnion:case $.ZodDiscriminatedUnion:return Ff(t,r);case $.ZodIntersection:return Cf(t,r);case $.ZodTuple:return Xf(t,r);case $.ZodRecord:return Ps(t,r);case $.ZodLiteral:return Af(t,r);case $.ZodEnum:return jf(t);case $.ZodNativeEnum:return qf(t);case $.ZodNullable:return Hf(t,r);case $.ZodOptional:return Kf(t,r);case $.ZodMap:return Df(t,r);case $.ZodSet:return Yf(t,r);case $.ZodLazy:return()=>t.getter()._def;case $.ZodPromise:return Wf(t,r);case $.ZodNaN:case $.ZodNever:return Lf(r);case $.ZodEffects:return Zf(t,r);case $.ZodAny:return he(r);case $.ZodUnknown:return em(r);case $.ZodDefault:return Of(t,r);case $.ZodBranded:return zs(t,r);case $.ZodReadonly:return tm(t,r);case $.ZodCatch:return Nf(t,r);case $.ZodPipeline:return Jf(t,r);case $.ZodFunction:case $.ZodVoid:case $.ZodSymbol:return;default:return(n=>{})(e)}};function A(t,e,r=!1){let n=e.seen.get(t);if(e.override){let a=e.override?.(t,e,n,r);if(a!==zf)return a}if(n&&!r){let a=S$(n,e);if(a!==void 0)return a}let o={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,o);let s=rm(t,t.typeName,e),i=typeof s=="function"?A(s(),e):s;if(i&&z$(t,e,i),e.postProcess){let a=e.postProcess(i,t,e);return o.jsonSchema=i,a}return o.jsonSchema=i,i}var S$=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:Ss(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),he(e)):e.$refStrategy==="seen"?he(e):void 0}},z$=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r);var ru=(t,e)=>{let r=Pf(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((c,[u,l])=>({...c,[u]:A(l._def,{...r,currentPath:[...r.basePath,r.definitionPath,u]},!0)??he(r)}),{}):void 0,o=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,s=A(t._def,o===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,o]},!1)??he(r),i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(s.title=i),r.flags.hasReferencedOpenAiAnyType&&(n||(n={}),n[r.openAiAnyTypeName]||(n[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let a=o===void 0?n?{...s,[r.definitionPath]:n}:s:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:{...n,[o]:s}};return r.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a};function T$(t){return!t||t==="jsonSchema7"||t==="draft-7"?"draft-7":t==="jsonSchema2019-09"||t==="draft-2020-12"?"draft-2020-12":"draft-7"}function nu(t,e){return Qe(t)?kc(t,{target:T$(e?.target),io:e?.pipeStrategy??"input"}):ru(t,{strictUnions:e?.strictUnions??!0,pipeStrategy:e?.pipeStrategy??"input"})}function ou(t){let r=Ht(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=es(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function su(t,e){let r=Ft(t,e);if(!r.success)throw r.error;return r.data}var P$=6e4,Es=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(as,r=>{this._oncancel(r)}),this.setNotificationHandler(us,r=>{this._onprogress(r)}),this.setRequestHandler(cs,r=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(ls,async(r,n)=>{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new I(Z.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(ps,async(r,n)=>{let o=async()=>{let s=r.params.taskId;if(this._taskMessageQueue){let a;for(;a=await this._taskMessageQueue.dequeue(s,n.sessionId);){if(a.type==="response"||a.type==="error"){let c=a.message,u=c.id,l=this._requestResolvers.get(u);if(l)if(this._requestResolvers.delete(u),a.type==="response")l(c);else{let d=c,h=new I(d.error.code,d.error.message,d.error.data);l(h)}else{let d=a.type==="response"?"Response":"Error";this._onerror(new Error(`${d} handler missing for request ${u}`))}continue}await this._transport?.send(a.message,{relatedRequestId:n.requestId})}}let i=await this._taskStore.getTask(s,n.sessionId);if(!i)throw new I(Z.InvalidParams,`Task not found: ${s}`);if(!Gt(i.status))return await this._waitForTaskUpdate(s,n.signal),await o();if(Gt(i.status)){let a=await this._taskStore.getTaskResult(s,n.sessionId);return this._clearTaskQueue(s),{...a,_meta:{...a._meta,[Bt]:{taskId:s}}}}return await o()};return await o()}),this.setRequestHandler(fs,async(r,n)=>{try{let{tasks:o,nextCursor:s}=await this._taskStore.listTasks(r.params?.cursor,n.sessionId);return{tasks:o,nextCursor:s,_meta:{}}}catch(o){throw new I(Z.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(hs,async(r,n)=>{try{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new I(Z.InvalidParams,`Task not found: ${r.params.taskId}`);if(Gt(o.status))throw new I(Z.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new I(Z.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...s}}catch(o){throw o instanceof I?o:new I(Z.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(e){if(!e.params.requestId)return;this._requestHandlerAbortControllers.get(e.params.requestId)?.abort(e.params.reason)}_setupTimeout(e,r,n,o,s=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(o,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:s,onTimeout:o})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),I.fromError(Z.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){if(this._transport)throw new Error("Already connected to a transport. Call close() before connecting to a new transport, or use a separate Protocol instance per connection.");this._transport=e;let r=this.transport?.onclose;this._transport.onclose=()=>{r?.(),this._onclose()};let n=this.transport?.onerror;this._transport.onerror=s=>{n?.(s),this._onerror(s)};let o=this._transport?.onmessage;this._transport.onmessage=(s,i)=>{o?.(s,i),Ln(s)||mf(s)?this._onresponse(s):Ac(s)?this._onrequest(s,i):ff(s)?this._onnotification(s):this._onerror(new Error(`Unknown message type: ${JSON.stringify(s)}`))},await this._transport.start()}_onclose(){let e=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();for(let n of this._requestHandlerAbortControllers.values())n.abort();this._requestHandlerAbortControllers.clear();let r=I.fromError(Z.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let n of e.values())n(r)}_onerror(e){this.onerror?.(e)}_onnotification(e){let r=this._notificationHandlers.get(e.method)??this.fallbackNotificationHandler;r!==void 0&&Promise.resolve().then(()=>r(e)).catch(n=>this._onerror(new Error(`Uncaught error in notification handler: ${n}`)))}_onrequest(e,r){let n=this._requestHandlers.get(e.method)??this.fallbackRequestHandler,o=this._transport,s=e.params?._meta?.[Bt]?.taskId;if(n===void 0){let l={jsonrpc:"2.0",id:e.id,error:{code:Z.MethodNotFound,message:"Method not found"}};s&&this._taskMessageQueue?this._enqueueTaskMessage(s,{type:"error",message:l,timestamp:Date.now()},o?.sessionId).catch(d=>this._onerror(new Error(`Failed to enqueue error response: ${d}`))):o?.send(l).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}let i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i);let a=lf(e.params)?e.params.task:void 0,c=this._taskStore?this.requestTaskStore(e,o?.sessionId):void 0,u={signal:i.signal,sessionId:o?.sessionId,_meta:e.params?._meta,sendNotification:async l=>{if(i.signal.aborted)return;let d={relatedRequestId:e.id};s&&(d.relatedTask={taskId:s}),await this.notification(l,d)},sendRequest:async(l,d,h)=>{if(i.signal.aborted)throw new I(Z.ConnectionClosed,"Request was cancelled");let f={...h,relatedRequestId:e.id};s&&!f.relatedTask&&(f.relatedTask={taskId:s});let p=f.relatedTask?.taskId??s;return p&&c&&await c.updateTaskStatus(p,"input_required"),await this.request(l,d,f)},authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo,taskId:s,taskStore:c,taskRequestedTtl:a?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{a&&this.assertTaskHandlerCapability(e.method)}).then(()=>n(e,u)).then(async l=>{if(i.signal.aborted)return;let d={result:l,jsonrpc:"2.0",id:e.id};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"response",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)},async l=>{if(i.signal.aborted)return;let d={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(l.code)?l.code:Z.InternalError,message:l.message??"Internal error",...l.data!==void 0&&{data:l.data}}};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"error",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)}).catch(l=>this._onerror(new Error(`Failed to send response: ${l}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,o=Number(r),s=this._progressHandlers.get(o);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(o),a=this._timeoutInfo.get(o);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(c){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),i(c);return}s(n)}_onresponse(e){let r=Number(e.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),Ln(e))n(e);else{let i=new I(e.error.code,e.error.message,e.error.data);n(i)}return}let o=this._responseHandlers.get(r);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let s=!1;if(Ln(e)&&e.result&&typeof e.result=="object"){let i=e.result;if(i.task&&typeof i.task=="object"){let a=i.task;typeof a.taskId=="string"&&(s=!0,this._taskProgressTokens.set(a.taskId,r))}}if(s||this._progressHandlers.delete(r),Ln(e))o(e);else{let i=I.fromError(e.error.code,e.error.message,e.error.data);o(i)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(e,r,n){let{task:o}=n??{};if(!o){try{yield{type:"result",result:await this.request(e,r,n)}}catch(i){yield{type:"error",error:i instanceof I?i:new I(Z.InternalError,String(i))}}return}let s;try{let i=await this.request(e,en,n);if(i.task)s=i.task.taskId,yield{type:"taskCreated",task:i.task};else throw new I(Z.InternalError,"Task creation did not return a task");for(;;){let a=await this.getTask({taskId:s},n);if(yield{type:"taskStatus",task:a},Gt(a.status)){a.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)}:a.status==="failed"?yield{type:"error",error:new I(Z.InternalError,`Task ${s} failed`)}:a.status==="cancelled"&&(yield{type:"error",error:new I(Z.InternalError,`Task ${s} was cancelled`)});return}if(a.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)};return}let c=a.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(u=>setTimeout(u,c)),n?.signal?.throwIfAborted()}}catch(i){yield{type:"error",error:i instanceof I?i:new I(Z.InternalError,String(i))}}}request(e,r,n){let{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,l)=>{let d=x=>{l(x)};if(!this._transport){d(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(x){d(x);return}n?.signal?.throwIfAborted();let h=this._requestMessageId++,f={...e,jsonrpc:"2.0",id:h};n?.onprogress&&(this._progressHandlers.set(h,n.onprogress),f.params={...e.params,_meta:{...e.params?._meta||{},progressToken:h}}),a&&(f.params={...f.params,task:a}),c&&(f.params={...f.params,_meta:{...f.params?._meta||{},[Bt]:c}});let p=x=>{this._responseHandlers.delete(h),this._progressHandlers.delete(h),this._cleanupTimeout(h),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:h,reason:String(x)}},{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(S=>this._onerror(new Error(`Failed to send cancellation: ${S}`)));let k=x instanceof I?x:new I(Z.RequestTimeout,String(x));l(k)};this._responseHandlers.set(h,x=>{if(!n?.signal?.aborted){if(x instanceof Error)return l(x);try{let k=Ft(r,x.result);k.success?u(k.data):l(k.error)}catch(k){l(k)}}}),n?.signal?.addEventListener("abort",()=>{p(n?.signal?.reason)});let m=n?.timeout??P$,g=()=>p(I.fromError(Z.RequestTimeout,"Request timed out",{timeout:m}));this._setupTimeout(h,m,n?.maxTotalTimeout,g,n?.resetTimeoutOnProgress??!1);let v=c?.taskId;if(v){let x=k=>{let S=this._responseHandlers.get(h);S?S(k):this._onerror(new Error(`Response handler missing for side-channeled request ${h}`))};this._requestResolvers.set(h,x),this._enqueueTaskMessage(v,{type:"request",message:f,timestamp:Date.now()}).catch(k=>{this._cleanupTimeout(h),l(k)})}else this._transport.send(f,{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(x=>{this._cleanupTimeout(h),l(x)})})}async getTask(e,r){return this.request({method:"tasks/get",params:e},ds,r)}async getTaskResult(e,r,n){return this.request({method:"tasks/result",params:e},r,n)}async listTasks(e,r){return this.request({method:"tasks/list",params:e},ms,r)}async cancelTask(e,r){return this.request({method:"tasks/cancel",params:e},yf,r)}async notification(e,r){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let n=r?.relatedTask?.taskId;if(n){let a={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...e.params?._meta||{},[Bt]:r.relatedTask}}};await this._enqueueTaskMessage(n,{type:"notification",message:a,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(e.method)&&!e.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let a={...e,jsonrpc:"2.0"};r?.relatedTask&&(a={...a,params:{...a.params,_meta:{...a.params?._meta||{},[Bt]:r.relatedTask}}}),this._transport?.send(a,r).catch(c=>this._onerror(c))});return}let i={...e,jsonrpc:"2.0"};r?.relatedTask&&(i={...i,params:{...i.params,_meta:{...i.params?._meta||{},[Bt]:r.relatedTask}}}),await this._transport.send(i,r)}setRequestHandler(e,r){let n=ou(e);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(o,s)=>{let i=su(e,o);return Promise.resolve(r(i,s))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){let n=ou(e);this._notificationHandlers.set(n,o=>{let s=su(e,o);return Promise.resolve(r(s))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){let r=this._taskProgressTokens.get(e);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,r,n){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,r,n,o)}async _clearTaskQueue(e,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(e,r);for(let o of n)if(o.type==="request"&&Ac(o.message)){let s=o.message.id,i=this._requestResolvers.get(s);i?(i(new I(Z.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,r){let n=this._options?.defaultTaskPollInterval??1e3;try{let o=await this._taskStore?.getTask(e);o?.pollInterval&&(n=o.pollInterval)}catch{}return new Promise((o,s)=>{if(r.aborted){s(new I(Z.InvalidRequest,"Request cancelled"));return}let i=setTimeout(o,n);r.addEventListener("abort",()=>{clearTimeout(i),s(new I(Z.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async o=>{if(!e)throw new Error("No request provided");return await n.createTask(o,e.id,{method:e.method,params:e.params},r)},getTask:async o=>{let s=await n.getTask(o,r);if(!s)throw new I(Z.InvalidParams,"Failed to retrieve task: Task not found");return s},storeTaskResult:async(o,s,i)=>{await n.storeTaskResult(o,s,i,r);let a=await n.getTask(o,r);if(a){let c=Bn.parse({method:"notifications/tasks/status",params:a});await this.notification(c),Gt(a.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>n.getTaskResult(o,r),updateTaskStatus:async(o,s,i)=>{let a=await n.getTask(o,r);if(!a)throw new I(Z.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(Gt(a.status))throw new I(Z.InvalidParams,`Cannot update task "${o}" from terminal status "${a.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(o,s,i,r);let c=await n.getTask(o,r);if(c){let u=Bn.parse({method:"notifications/tasks/status",params:c});await this.notification(u),Gt(c.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>n.listTasks(o,r)}}};function nm(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function om(t,e){let r={...t};for(let n in e){let o=n,s=e[o];if(s===void 0)continue;let i=r[o];nm(i)&&nm(s)?r[o]={...i,...s}:r[o]=s}return r}var Fg=ud(Fl(),1),Hg=ud(Vg(),1);function vT(){let t=new Fg.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,Hg.default)(t),t}var di=class{constructor(e){this._ajv=e??vT()}getValidator(e){let r="$id"in e&&typeof e.$id=="string"?this._ajv.getSchema(e.$id)??this._ajv.compile(e):this._ajv.compile(e);return n=>r(n)?{valid:!0,data:n,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(r.errors)}}};var pi=class{constructor(e){this._server=e}requestStream(e,r,n){return this._server.requestStream(e,r,n)}async getTask(e,r){return this._server.getTask({taskId:e},r)}async getTaskResult(e,r,n){return this._server.getTaskResult({taskId:e},r,n)}async listTasks(e,r){return this._server.listTasks(e?{cursor:e}:void 0,r)}async cancelTask(e,r){return this._server.cancelTask({taskId:e},r)}};function Bg(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!t.tools?.call)throw new Error(`${r} does not support task creation for tools/call (required for ${e})`);break;default:break}}function Gg(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!t.sampling?.createMessage)throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!t.elicitation?.create)throw new Error(`${r} does not support task creation for elicitation/create (required for ${e})`);break;default:break}}var fi=class extends Es{constructor(e,r){super(r),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(Kn.options.map((n,o)=>[n,o])),this.isMessageIgnored=(n,o)=>{let s=this._loggingLevels.get(o);return s?this.LOG_LEVEL_SEVERITY.get(n)<this.LOG_LEVEL_SEVERITY.get(s):!1},this._capabilities=r?.capabilities??{},this._instructions=r?.instructions,this._jsonSchemaValidator=r?.jsonSchemaValidator??new di,this.setRequestHandler(qc,n=>this._oninitialize(n)),this.setNotificationHandler(Lc,()=>this.oninitialized?.()),this._capabilities.logging&&this.setRequestHandler(Kc,async(n,o)=>{let s=o.sessionId||o.requestInfo?.headers["mcp-session-id"]||void 0,{level:i}=n.params,a=Kn.safeParse(i);return a.success&&this._loggingLevels.set(s,a.data),{}})}get experimental(){return this._experimental||(this._experimental={tasks:new pi(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=om(this._capabilities,e)}setRequestHandler(e,r){let o=Ht(e)?.method;if(!o)throw new Error("Schema is missing a method literal");let s;if(Qe(o)){let a=o;s=a._zod?.def?.value??a.value}else{let a=o;s=a._def?.value??a.value}if(typeof s!="string")throw new Error("Schema method literal must be a string");if(s==="tools/call"){let a=async(c,u)=>{let l=Ft(rn,c);if(!l.success){let p=l.error instanceof Error?l.error.message:String(l.error);throw new I(Z.InvalidParams,`Invalid tools/call request: ${p}`)}let{params:d}=l.data,h=await Promise.resolve(r(c,u));if(d.task){let p=Ft(en,h);if(!p.success){let m=p.error instanceof Error?p.error.message:String(p.error);throw new I(Z.InvalidParams,`Invalid task creation result: ${m}`)}return p.data}let f=Ft($s,h);if(!f.success){let p=f.error instanceof Error?f.error.message:String(f.error);throw new I(Z.InvalidParams,`Invalid tools/call result: ${p}`)}return f.data};return super.setRequestHandler(e,a)}return super.setRequestHandler(e,r)}assertCapabilityForMethod(e){switch(e){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw new Error(`Client does not support URL elicitation (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"completion/complete":if(!this._capabilities.completions)throw new Error(`Server does not support completions (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Server does not support tasks capability (required for ${e})`);break;case"ping":case"initialize":break}}assertTaskCapability(e){Gg(this._clientCapabilities?.tasks?.requests,e,"Client")}assertTaskHandlerCapability(e){this._capabilities&&Bg(this._capabilities.tasks?.requests,e,"Server")}async _oninitialize(e){let r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:af.includes(r)?r:jc,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},is)}async createMessage(e,r){if((e.tools||e.toolChoice)&&!this._clientCapabilities?.sampling?.tools)throw new Error("Client does not support sampling tools capability.");if(e.messages.length>0){let n=e.messages[e.messages.length-1],o=Array.isArray(n.content)?n.content:[n.content],s=o.some(u=>u.type==="tool_result"),i=e.messages.length>1?e.messages[e.messages.length-2]:void 0,a=i?Array.isArray(i.content)?i.content:[i.content]:[],c=a.some(u=>u.type==="tool_use");if(s){if(o.some(u=>u.type!=="tool_result"))throw new Error("The last message must contain only tool_result content if any is present");if(!c)throw new Error("tool_result blocks are not matching any tool_use from the previous message")}if(c){let u=new Set(a.filter(d=>d.type==="tool_use").map(d=>d.id)),l=new Set(o.filter(d=>d.type==="tool_result").map(d=>d.toolUseId));if(u.size!==l.size||![...u].every(d=>l.has(d)))throw new Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}return e.tools?this.request({method:"sampling/createMessage",params:e},Wc,r):this.request({method:"sampling/createMessage",params:e},Jc,r)}async elicitInput(e,r){switch(e.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support url elicitation.");let o=e;return this.request({method:"elicitation/create",params:o},ks,r)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw new Error("Client does not support form elicitation.");let o=e.mode==="form"?e:{...e,mode:"form"},s=await this.request({method:"elicitation/create",params:o},ks,r);if(s.action==="accept"&&s.content&&o.requestedSchema)try{let a=this._jsonSchemaValidator.getValidator(o.requestedSchema)(s.content);if(!a.valid)throw new I(Z.InvalidParams,`Elicitation response content does not match requested schema: ${a.errorMessage}`)}catch(i){throw i instanceof I?i:new I(Z.InternalError,`Error validating elicitation response: ${i instanceof Error?i.message:String(i)}`)}return s}}}createElicitationCompletionNotifier(e,r){if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support URL elicitation (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:e}},r)}async listRoots(e,r){return this.request({method:"roots/list",params:e},Yc,r)}async sendLoggingMessage(e,r){if(this._capabilities.logging&&!this.isMessageIgnored(e.level,r))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var Jg=Symbol.for("mcp.completable");function Xl(t){return!!t&&typeof t=="object"&&Jg in t}function Wg(t){return t[Jg]?.complete}var Kg;(function(t){t.Completable="McpCompletable"})(Kg||(Kg={}));var xT=/^[A-Za-z0-9._-]{1,128}$/;function bT(t){let e=[];if(t.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(t.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${t.length})`]};if(t.includes(" ")&&e.push("Tool name contains spaces, which may cause parsing issues"),t.includes(",")&&e.push("Tool name contains commas, which may cause parsing issues"),(t.startsWith("-")||t.endsWith("-"))&&e.push("Tool name starts or ends with a dash, which may cause parsing issues in some contexts"),(t.startsWith(".")||t.endsWith("."))&&e.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts"),!xT.test(t)){let r=t.split("").filter(n=>!/[A-Za-z0-9._-]/.test(n)).filter((n,o,s)=>s.indexOf(n)===o);return e.push(`Tool name contains invalid characters: ${r.map(n=>`"${n}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:e}}return{isValid:!0,warnings:e}}function $T(t,e){if(e.length>0){console.warn(`Tool name validation warning for "${t}":`);for(let r of e)console.warn(`  - ${r}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function Ql(t){let e=bT(t);return $T(t,e.warnings),e.isValid}var mi=class{constructor(e){this._mcpServer=e}registerToolTask(e,r,n){let o={taskSupport:"required",...r.execution};if(o.taskSupport==="forbidden")throw new Error(`Cannot register task-based tool '${e}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(e,r.title,r.description,r.inputSchema,r.outputSchema,r.annotations,o,r._meta,n)}};var hi=class{constructor(e,r){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new fi(e,r)}get experimental(){return this._experimental||(this._experimental={tasks:new mi(this)}),this._experimental}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(rr(bs)),this.server.assertCanSetRequestHandler(rr(rn)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(bs,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,r])=>{let n={name:e,title:r.title,description:r.description,inputSchema:(()=>{let o=Xr(r.inputSchema);return o?nu(o,{strictUnions:!0,pipeStrategy:"input"}):kT})(),annotations:r.annotations,execution:r.execution,_meta:r._meta};if(r.outputSchema){let o=Xr(r.outputSchema);o&&(n.outputSchema=nu(o,{strictUnions:!0,pipeStrategy:"output"}))}return n})})),this.server.setRequestHandler(rn,async(e,r)=>{try{let n=this._registeredTools[e.params.name];if(!n)throw new I(Z.InvalidParams,`Tool ${e.params.name} not found`);if(!n.enabled)throw new I(Z.InvalidParams,`Tool ${e.params.name} disabled`);let o=!!e.params.task,s=n.execution?.taskSupport,i="createTask"in n.handler;if((s==="required"||s==="optional")&&!i)throw new I(Z.InternalError,`Tool ${e.params.name} has taskSupport '${s}' but was not registered with registerToolTask`);if(s==="required"&&!o)throw new I(Z.MethodNotFound,`Tool ${e.params.name} requires task augmentation (taskSupport: 'required')`);if(s==="optional"&&!o&&i)return await this.handleAutomaticTaskPolling(n,e,r);let a=await this.validateToolInput(n,e.params.arguments,e.params.name),c=await this.executeToolHandler(n,a,r);return o||await this.validateToolOutput(n,c,e.params.name),c}catch(n){if(n instanceof I&&n.code===Z.UrlElicitationRequired)throw n;return this.createToolError(n instanceof Error?n.message:String(n))}}),this._toolHandlersInitialized=!0)}createToolError(e){return{content:[{type:"text",text:e}],isError:!0}}async validateToolInput(e,r,n){if(!e.inputSchema)return;let s=Xr(e.inputSchema)??e.inputSchema,i=await Xo(s,r);if(!i.success){let a="error"in i?i.error:"Unknown error",c=Qo(a);throw new I(Z.InvalidParams,`Input validation error: Invalid arguments for tool ${n}: ${c}`)}return i.data}async validateToolOutput(e,r,n){if(!e.outputSchema||!("content"in r)||r.isError)return;if(!r.structuredContent)throw new I(Z.InvalidParams,`Output validation error: Tool ${n} has an output schema but no structured content was provided`);let o=Xr(e.outputSchema),s=await Xo(o,r.structuredContent);if(!s.success){let i="error"in s?s.error:"Unknown error",a=Qo(i);throw new I(Z.InvalidParams,`Output validation error: Invalid structured content for tool ${n}: ${a}`)}}async executeToolHandler(e,r,n){let o=e.handler;if("createTask"in o){if(!n.taskStore)throw new Error("No task store provided.");let i={...n,taskStore:n.taskStore};if(e.inputSchema){let a=o;return await Promise.resolve(a.createTask(r,i))}else{let a=o;return await Promise.resolve(a.createTask(i))}}if(e.inputSchema){let i=o;return await Promise.resolve(i(r,n))}else{let i=o;return await Promise.resolve(i(n))}}async handleAutomaticTaskPolling(e,r,n){if(!n.taskStore)throw new Error("No task store provided for task-capable tool.");let o=await this.validateToolInput(e,r.params.arguments,r.params.name),s=e.handler,i={...n,taskStore:n.taskStore},a=o?await Promise.resolve(s.createTask(o,i)):await Promise.resolve(s.createTask(i)),c=a.task.taskId,u=a.task,l=u.pollInterval??5e3;for(;u.status!=="completed"&&u.status!=="failed"&&u.status!=="cancelled";){await new Promise(h=>setTimeout(h,l));let d=await n.taskStore.getTask(c);if(!d)throw new I(Z.InternalError,`Task ${c} not found during polling`);u=d}return await n.taskStore.getTaskResult(c)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(rr(ws)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(ws,async e=>{switch(e.params.ref.type){case"ref/prompt":return kf(e),this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return wf(e),this.handleResourceCompletion(e,e.params.ref);default:throw new I(Z.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,r){let n=this._registeredPrompts[r.name];if(!n)throw new I(Z.InvalidParams,`Prompt ${r.name} not found`);if(!n.enabled)throw new I(Z.InvalidParams,`Prompt ${r.name} disabled`);if(!n.argsSchema)return zo;let s=Ht(n.argsSchema)?.[e.params.argument.name];if(!Xl(s))return zo;let i=Wg(s);if(!i)return zo;let a=await i(e.params.argument.value,e.params.context);return Xg(a)}async handleResourceCompletion(e,r){let n=Object.values(this._registeredResourceTemplates).find(i=>i.resourceTemplate.uriTemplate.toString()===r.uri);if(!n){if(this._registeredResources[r.uri])return zo;throw new I(Z.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let o=n.resourceTemplate.completeCallback(e.params.argument.name);if(!o)return zo;let s=await o(e.params.argument.value,e.params.context);return Xg(s)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(rr(gs)),this.server.assertCanSetRequestHandler(rr(ys)),this.server.assertCanSetRequestHandler(rr(_s)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(gs,async(e,r)=>{let n=Object.entries(this._registeredResources).filter(([s,i])=>i.enabled).map(([s,i])=>({uri:s,name:i.name,...i.metadata})),o=[];for(let s of Object.values(this._registeredResourceTemplates)){if(!s.resourceTemplate.listCallback)continue;let i=await s.resourceTemplate.listCallback(r);for(let a of i.resources)o.push({...s.metadata,...a})}return{resources:[...n,...o]}}),this.server.setRequestHandler(ys,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([r,n])=>({name:r,uriTemplate:n.resourceTemplate.uriTemplate.toString(),...n.metadata}))})),this.server.setRequestHandler(_s,async(e,r)=>{let n=new URL(e.params.uri),o=this._registeredResources[n.toString()];if(o){if(!o.enabled)throw new I(Z.InvalidParams,`Resource ${n} disabled`);return o.readCallback(n,r)}for(let s of Object.values(this._registeredResourceTemplates)){let i=s.resourceTemplate.uriTemplate.match(n.toString());if(i)return s.readCallback(n,i,r)}throw new I(Z.InvalidParams,`Resource ${n} not found`)}),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(rr(vs)),this.server.assertCanSetRequestHandler(rr(xs)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(vs,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,r])=>({name:e,title:r.title,description:r.description,arguments:r.argsSchema?ST(r.argsSchema):void 0}))})),this.server.setRequestHandler(xs,async(e,r)=>{let n=this._registeredPrompts[e.params.name];if(!n)throw new I(Z.InvalidParams,`Prompt ${e.params.name} not found`);if(!n.enabled)throw new I(Z.InvalidParams,`Prompt ${e.params.name} disabled`);if(n.argsSchema){let o=Xr(n.argsSchema),s=await Xo(o,e.params.arguments);if(!s.success){let c="error"in s?s.error:"Unknown error",u=Qo(c);throw new I(Z.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${u}`)}let i=s.data,a=n.callback;return await Promise.resolve(a(i,r))}else{let o=n.callback;return await Promise.resolve(o(r))}}),this._promptHandlersInitialized=!0)}resource(e,r,...n){let o;typeof n[0]=="object"&&(o=n.shift());let s=n[0];if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let i=this._createRegisteredResource(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let i=this._createRegisteredResourceTemplate(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}}registerResource(e,r,n,o){if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let s=this._createRegisteredResource(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let s=this._createRegisteredResourceTemplate(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}}_createRegisteredResource(e,r,n,o,s){let i={name:e,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:a=>{typeof a.uri<"u"&&a.uri!==n&&(delete this._registeredResources[n],a.uri&&(this._registeredResources[a.uri]=i)),typeof a.name<"u"&&(i.name=a.name),typeof a.title<"u"&&(i.title=a.title),typeof a.metadata<"u"&&(i.metadata=a.metadata),typeof a.callback<"u"&&(i.readCallback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendResourceListChanged()}};return this._registeredResources[n]=i,i}_createRegisteredResourceTemplate(e,r,n,o,s){let i={resourceTemplate:n,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:u=>{typeof u.name<"u"&&u.name!==e&&(delete this._registeredResourceTemplates[e],u.name&&(this._registeredResourceTemplates[u.name]=i)),typeof u.title<"u"&&(i.title=u.title),typeof u.template<"u"&&(i.resourceTemplate=u.template),typeof u.metadata<"u"&&(i.metadata=u.metadata),typeof u.callback<"u"&&(i.readCallback=u.callback),typeof u.enabled<"u"&&(i.enabled=u.enabled),this.sendResourceListChanged()}};this._registeredResourceTemplates[e]=i;let a=n.uriTemplate.variableNames;return Array.isArray(a)&&a.some(u=>!!n.completeCallback(u))&&this.setCompletionRequestHandler(),i}_createRegisteredPrompt(e,r,n,o,s){let i={title:r,description:n,argsSchema:o===void 0?void 0:zr(o),callback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:a=>{typeof a.name<"u"&&a.name!==e&&(delete this._registeredPrompts[e],a.name&&(this._registeredPrompts[a.name]=i)),typeof a.title<"u"&&(i.title=a.title),typeof a.description<"u"&&(i.description=a.description),typeof a.argsSchema<"u"&&(i.argsSchema=zr(a.argsSchema)),typeof a.callback<"u"&&(i.callback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=i,o&&Object.values(o).some(c=>{let u=c instanceof qe?c._def?.innerType:c;return Xl(u)})&&this.setCompletionRequestHandler(),i}_createRegisteredTool(e,r,n,o,s,i,a,c,u){Ql(e);let l={title:r,description:n,inputSchema:Yg(o),outputSchema:Yg(s),annotations:i,execution:a,_meta:c,handler:u,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:d=>{typeof d.name<"u"&&d.name!==e&&(typeof d.name=="string"&&Ql(d.name),delete this._registeredTools[e],d.name&&(this._registeredTools[d.name]=l)),typeof d.title<"u"&&(l.title=d.title),typeof d.description<"u"&&(l.description=d.description),typeof d.paramsSchema<"u"&&(l.inputSchema=zr(d.paramsSchema)),typeof d.outputSchema<"u"&&(l.outputSchema=zr(d.outputSchema)),typeof d.callback<"u"&&(l.handler=d.callback),typeof d.annotations<"u"&&(l.annotations=d.annotations),typeof d._meta<"u"&&(l._meta=d._meta),typeof d.enabled<"u"&&(l.enabled=d.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...r){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let n,o,s,i;if(typeof r[0]=="string"&&(n=r.shift()),r.length>1){let c=r[0];ed(c)?(o=r.shift(),r.length>1&&typeof r[0]=="object"&&r[0]!==null&&!ed(r[0])&&(i=r.shift())):typeof c=="object"&&c!==null&&(i=r.shift())}let a=r[0];return this._createRegisteredTool(e,void 0,n,o,s,i,{taskSupport:"forbidden"},void 0,a)}registerTool(e,r,n){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let{title:o,description:s,inputSchema:i,outputSchema:a,annotations:c,_meta:u}=r;return this._createRegisteredTool(e,o,s,i,a,c,{taskSupport:"forbidden"},u,n)}prompt(e,...r){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let n;typeof r[0]=="string"&&(n=r.shift());let o;r.length>1&&(o=r.shift());let s=r[0],i=this._createRegisteredPrompt(e,void 0,n,o,s);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(e,r,n){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let{title:o,description:s,argsSchema:i}=r,a=this._createRegisteredPrompt(e,o,s,i,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),a}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(e,r){return this.server.sendLoggingMessage(e,r)}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}};var kT={type:"object",properties:{}};function Qg(t){return t!==null&&typeof t=="object"&&"parse"in t&&typeof t.parse=="function"&&"safeParse"in t&&typeof t.safeParse=="function"}function wT(t){return"_def"in t||"_zod"in t||Qg(t)}function ed(t){return typeof t!="object"||t===null||wT(t)?!1:Object.keys(t).length===0?!0:Object.values(t).some(Qg)}function Yg(t){if(t)return ed(t)?zr(t):t}function ST(t){let e=Ht(t);return e?Object.entries(e).map(([r,n])=>{let o=Ap(n),s=Mp(n);return{name:r,description:o,required:!s}}):[]}function rr(t){let r=Ht(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=es(r);if(typeof n=="string")return n;throw new Error("Schema method literal must be a string")}function Xg(t){return{completion:{values:t.slice(0,100),total:t.length,hasMore:t.length>100}}}var zo={completion:{values:[],hasMore:!1}};import ty from"node:process";var gi=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),zT(r)}clear(){this._buffer=void 0}};function zT(t){return hf.parse(JSON.parse(t))}function ey(t){return JSON.stringify(t)+`
`}var yi=class{constructor(e=ty.stdin,r=ty.stdout){this._stdin=e,this._stdout=r,this._readBuffer=new gi,this._started=!1,this._ondata=n=>{this._readBuffer.append(n),this.processReadBuffer()},this._onerror=n=>{this.onerror?.(n)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(;;)try{let e=this._readBuffer.readMessage();if(e===null)break;this.onmessage?.(e)}catch(e){this.onerror?.(e)}}async close(){this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),this.onclose?.()}send(e){return new Promise(r=>{let n=ey(e);this._stdout.write(n)?r():this._stdout.once("drain",r)})}};import NT from"fs";import py from"path";import Ct from"fs";import bn from"path";import TT from"crypto";function ae(){return new Date().toISOString()}function Ar(t){return bn.join(t,".speclock")}function ry(t){let e=Ar(t);Ct.mkdirSync(e,{recursive:!0}),Ct.mkdirSync(bn.join(e,"patches"),{recursive:!0}),Ct.mkdirSync(bn.join(e,"context"),{recursive:!0})}function ny(t){return bn.join(Ar(t),"brain.json")}function oy(t){return bn.join(Ar(t),"events.log")}function xe(t){return`${t}_${TT.randomBytes(6).toString("hex")}`}function sy(t,e,r){let n=ae(),o=bn.basename(t);return{version:2,project:{id:xe("sl"),name:o,root:t,createdAt:n,updatedAt:n},goal:{text:"",updatedAt:n},specLock:{items:[]},decisions:[],notes:[],facts:{deploy:{provider:"unknown",autoDeploy:!1,branch:"",url:"",notes:""},repo:{defaultBranch:r||"",hasGit:!!e}},sessions:{current:null,history:[]},state:{head:{gitBranch:"",gitCommit:"",capturedAt:n},recentChanges:[],reverts:[]},events:{lastEventId:"",count:0}}}function PT(t){if(t.version>=2)return t;if(t.notes||(t.notes=[]),t.sessions||(t.sessions={current:null,history:[]}),t.specLock&&t.specLock.items)for(let e of t.specLock.items)e.active===void 0&&(e.active=!0);return t.facts&&t.facts.deploy&&t.facts.deploy.url===void 0&&(t.facts.deploy.url=""),delete t.importance,t.version=2,t}function To(t){let e=ny(t);if(!Ct.existsSync(e))return null;let r=Ct.readFileSync(e,"utf8"),n=JSON.parse(r);return n.version<2&&(n=PT(n),nr(t,n)),n}function nr(t,e){e.project.updatedAt=ae();let r=ny(t);Ct.writeFileSync(r,JSON.stringify(e,null,2))}function Mr(t,e){let r=JSON.stringify(e);Ct.appendFileSync(oy(t),`${r}
`)}function Po(t,e={}){let r=oy(t);if(!Ct.existsSync(r))return[];let n=Ct.readFileSync(r,"utf8").trim();if(!n)return[];let o=n.split(`
`).map(s=>{try{return JSON.parse(s)}catch{return null}}).filter(Boolean);return e.type&&(o=o.filter(s=>s.type===e.type)),e.since&&(o=o.filter(s=>s.at>=e.since)),o.reverse(),e.limit&&e.limit>0&&(o=o.slice(0,e.limit)),o}function Dr(t,e){t.events.lastEventId=e,t.events.count+=1}function iy(t,e){t.state.recentChanges.unshift(e),t.state.recentChanges.length>20&&(t.state.recentChanges=t.state.recentChanges.slice(0,20))}import ET from"fs";import IT from"path";import{spawnSync as RT}from"child_process";function St(t,e){try{let r=RT("git",e,{cwd:t,stdio:["ignore","pipe","pipe"],timeout:1e4});return r.status!==0?{ok:!1,stdout:"",stderr:r.stderr?String(r.stderr).trim():"git error"}:{ok:!0,stdout:String(r.stdout).trim(),stderr:""}}catch(r){return{ok:!1,stdout:"",stderr:r.message||"git error"}}}function ay(t){let e=IT.join(t,".git");return ET.existsSync(e)?St(t,["rev-parse","--is-inside-work-tree"]).ok:!1}function td(t){let e=St(t,["rev-parse","--abbrev-ref","HEAD"]),r=St(t,["rev-parse","HEAD"]);return!e.ok||!r.ok?{gitBranch:"",gitCommit:""}:{gitBranch:e.stdout,gitCommit:r.stdout}}function cy(t){let e=St(t,["symbolic-ref","refs/remotes/origin/HEAD"]);if(e.ok){let n=e.stdout.split("/");return n[n.length-1]||""}return td(t).gitBranch||""}function uy(t){let e=St(t,["diff"]);return e.ok?e.stdout:null}function _i(t){let e=St(t,["rev-parse","--abbrev-ref","HEAD"]),r=St(t,["rev-parse","--short","HEAD"]),n=St(t,["status","--porcelain"]),o=e.ok?e.stdout:"",s=r.ok?r.stdout:"",i=[];if(n.ok&&n.stdout){let a=n.stdout.split(`
`).filter(Boolean);for(let c of a.slice(0,50)){let u=c.substring(0,2).trim(),l=c.substring(3);i.push({status:u,file:l})}}return{branch:o,commit:s,changedFiles:i}}function ly(t,e){let r=St(t,["tag",e]);return r.ok?{ok:!0,tag:e,error:""}:{ok:!1,tag:"",error:r.stderr}}function dy(t){let e=St(t,["diff","--stat"]);return e.ok?e.stdout:""}function At(t,e,r){Dr(e,r.eventId),Mr(t,r),nr(t,e)}function OT(t,e,r){let n=py.join(Ar(t),"patches",`${e}.patch`);return NT.writeFileSync(n,r),py.join(".speclock","patches",`${e}.patch`)}function ke(t){ry(t);let e=To(t);if(!e){let r=ay(t),n=r?cy(t):"";if(e=sy(t,r,n),r){let i=td(t);e.state.head.gitBranch=i.gitBranch,e.state.head.gitCommit=i.gitCommit,e.state.head.capturedAt=ae()}let o=xe("evt"),s={eventId:o,type:"init",at:ae(),files:[],summary:"Initialized SpecLock",patchPath:""};Dr(e,o),Mr(t,s),nr(t,e)}return e}function fy(t,e){let r=ke(t);r.goal.text=e,r.goal.updatedAt=ae();let o={eventId:xe("evt"),type:"goal_updated",at:ae(),files:[],summary:`Goal set: ${e.substring(0,80)}`,patchPath:""};return At(t,r,o),r}function my(t,e,r,n){let o=ke(t),s=xe("lock");o.specLock.items.unshift({id:s,text:e,createdAt:ae(),source:n||"user",tags:r||[],active:!0});let a={eventId:xe("evt"),type:"lock_added",at:ae(),files:[],summary:`Lock added: ${e.substring(0,80)}`,patchPath:""};return At(t,o,a),{brain:o,lockId:s}}function hy(t,e){let r=ke(t),n=r.specLock.items.find(i=>i.id===e);if(!n)return{brain:r,removed:!1,error:`Lock not found: ${e}`};n.active=!1;let s={eventId:xe("evt"),type:"lock_removed",at:ae(),files:[],summary:`Lock removed: ${n.text.substring(0,80)}`,patchPath:""};return At(t,r,s),{brain:r,removed:!0,lockText:n.text}}function gy(t,e,r,n){let o=ke(t),s=xe("dec");o.decisions.unshift({id:s,text:e,createdAt:ae(),source:n||"user",tags:r||[]});let a={eventId:xe("evt"),type:"decision_added",at:ae(),files:[],summary:`Decision: ${e.substring(0,80)}`,patchPath:""};return At(t,o,a),{brain:o,decId:s}}function yy(t,e,r=!0){let n=ke(t),o=xe("note");n.notes.unshift({id:o,text:e,createdAt:ae(),pinned:r});let i={eventId:xe("evt"),type:"note_added",at:ae(),files:[],summary:`Note: ${e.substring(0,80)}`,patchPath:""};return At(t,n,i),{brain:n,noteId:o}}function _y(t,e){let r=ke(t),n=r.facts.deploy;e.provider!==void 0&&(n.provider=e.provider),typeof e.autoDeploy=="boolean"&&(n.autoDeploy=e.autoDeploy),e.branch!==void 0&&(n.branch=e.branch),e.url!==void 0&&(n.url=e.url),e.notes!==void 0&&(n.notes=e.notes);let s={eventId:xe("evt"),type:"fact_updated",at:ae(),files:[],summary:"Updated deploy facts",patchPath:""};return At(t,r,s),r}function vy(t,e,r=[]){let n=ke(t),o=xe("evt"),s="";if(n.facts.repo.hasGit){let a=uy(t);a&&a.trim().length>0&&(s=OT(t,o,a))}let i={eventId:o,type:"manual_change",at:ae(),files:r,summary:e,patchPath:s};return iy(n,{eventId:o,summary:e,files:r,at:i.at}),At(t,n,i),{brain:n,eventId:o}}var ZT=[["remove","delete","drop","eliminate","destroy","kill","purge","wipe"],["add","create","introduce","insert","new"],["change","modify","alter","update","mutate","transform","rewrite"],["break","breaking","incompatible","destabilize"],["public","external","exposed","user-facing","client-facing"],["private","internal","hidden","encapsulated"],["database","db","schema","table","migration","sql"],["api","endpoint","route","rest","graphql"],["test","testing","spec","coverage","assertion"],["deploy","deployment","release","ship","publish","production"],["security","auth","authentication","authorization","token","credential"],["dependency","package","library","module","import"],["refactor","restructure","reorganize","cleanup"],["disable","deactivate","turn-off","switch-off"],["enable","activate","turn-on","switch-on"]],jT=["no","not","never","without","dont","don't","cannot","can't","shouldn't","mustn't","avoid","prevent","prohibit","forbid","disallow"],CT=["remove","delete","drop","destroy","kill","purge","wipe","break","disable","revert","rollback","undo"];function vi(t){let e=new Set(t);for(let r of t)for(let n of ZT)if(n.includes(r))for(let o of n)e.add(o);return[...e]}function rd(t){let e=t.toLowerCase();return jT.some(r=>e.includes(r))}function AT(t){let e=t.toLowerCase();return CT.some(r=>e.includes(r))}function xy(t,e){let n=ke(t).specLock.items.filter(l=>l.active!==!1);if(n.length===0)return{hasConflict:!1,conflictingLocks:[],analysis:"No active locks. No constraints to check against."};let o=e.toLowerCase(),s=o.split(/\s+/).filter(l=>l.length>2),i=vi(s),a=AT(o),c=[];for(let l of n){let d=l.text.toLowerCase(),h=d.split(/\s+/).filter(ue=>ue.length>2),f=vi(h),p=s.filter(ue=>h.includes(ue)),m=i.filter(ue=>f.includes(ue)),g=m.filter(ue=>!p.includes(ue)),v=rd(d),x=rd(o),k=v&&!x&&m.length>0,S=0,O=[];if(p.length>0&&(S+=p.length*30,O.push(`direct keyword match: ${p.join(", ")}`)),g.length>0&&(S+=g.length*15,O.push(`synonym match: ${g.join(", ")}`)),k&&(S+=40,O.push("lock prohibits this action (negation detected)")),a&&m.length>0&&(S+=20,O.push("destructive action against locked constraint")),S=Math.min(S,100),S>=15){let ue=S>=70?"HIGH":S>=40?"MEDIUM":"LOW";c.push({id:l.id,text:l.text,matchedKeywords:[...new Set([...p,...g])],confidence:S,level:ue,reasons:O})}}if(c.length===0)return{hasConflict:!1,conflictingLocks:[],analysis:`Checked against ${n.length} active lock(s). No conflicts detected (keyword + synonym + negation analysis). Proceed with caution.`};c.sort((l,d)=>d.confidence-l.confidence);let u=c.map(l=>`- [${l.level}] "${l.text}" (confidence: ${l.confidence}%)
  Reasons: ${l.reasons.join("; ")}`).join(`
`);return{hasConflict:!0,conflictingLocks:c,analysis:`Potential conflict with ${c.length} lock(s):
${u}
Review before proceeding.`}}function by(t){let e=ke(t),r=[];for(let i of e.decisions){let a=i.text.toLowerCase();/\b(always|must|only|exclusively|never|required)\b/.test(a)&&r.push({text:i.text,source:"decision",sourceId:i.id,reason:"Decision contains strong commitment language \u2014 consider promoting to a lock"})}for(let i of e.notes){let a=i.text.toLowerCase();/\b(never|must not|do not|don't|avoid|prohibit|forbidden)\b/.test(a)&&r.push({text:i.text,source:"note",sourceId:i.id,reason:"Note contains prohibitive language \u2014 consider promoting to a lock"})}let n=e.specLock.items.filter(i=>i.active).map(i=>i.text.toLowerCase()),o=[{keyword:"api",suggestion:"No breaking changes to public API"},{keyword:"database",suggestion:"No destructive database migrations without backup"},{keyword:"deploy",suggestion:"All deployments must pass CI checks"},{keyword:"security",suggestion:"No secrets or credentials in source code"},{keyword:"test",suggestion:"No merging without passing tests"}],s=[e.goal.text,...e.decisions.map(i=>i.text),...e.notes.map(i=>i.text)].join(" ").toLowerCase();for(let i of o)s.includes(i.keyword)&&(n.some(c=>c.includes(i.keyword))||r.push({text:i.suggestion,source:"pattern",sourceId:null,reason:`Project mentions "${i.keyword}" but has no lock protecting it`}));return{suggestions:r,totalLocks:e.specLock.items.filter(i=>i.active).length}}function $y(t){let e=ke(t),r=e.specLock.items.filter(i=>i.active!==!1);if(r.length===0)return{drifts:[],status:"no_locks",message:"No active locks to check against."};let n=[];for(let i of e.state.recentChanges){let c=i.summary.toLowerCase().split(/\s+/).filter(l=>l.length>2),u=vi(c);for(let l of r){let d=l.text.toLowerCase(),h=d.split(/\s+/).filter(g=>g.length>2),f=vi(h),p=u.filter(g=>f.includes(g)),m=rd(d);p.length>=2&&m&&n.push({lockId:l.id,lockText:l.text,changeEventId:i.eventId,changeSummary:i.summary,changeAt:i.at,matchedTerms:p,severity:p.length>=3?"high":"medium"})}}for(let i of e.state.reverts)n.push({lockId:null,lockText:"(git revert detected)",changeEventId:i.eventId,changeSummary:`Git ${i.kind} to ${i.target.substring(0,12)}`,changeAt:i.at,matchedTerms:["revert"],severity:"high"});let o=n.length===0?"clean":"drift_detected",s=n.length===0?`All clear. ${r.length} lock(s) checked against ${e.state.recentChanges.length} recent change(s). No drift detected.`:`WARNING: ${n.length} potential drift(s) detected. Review immediately.`;return{drifts:n,status:o,message:s}}function MT(t,e="unknown"){let r=ke(t);if(r.sessions.current){let i=r.sessions.current;i.endedAt=ae(),i.summary=i.summary||"Session auto-closed (new session started)",r.sessions.history.unshift(i),r.sessions.history.length>50&&(r.sessions.history=r.sessions.history.slice(0,50))}let n={id:xe("ses"),startedAt:ae(),endedAt:null,summary:"",toolUsed:e,eventsInSession:0};r.sessions.current=n;let s={eventId:xe("evt"),type:"session_started",at:ae(),files:[],summary:`Session started (${e})`,patchPath:""};return At(t,r,s),{brain:r,session:n}}function ky(t,e){let r=ke(t);if(!r.sessions.current)return{brain:r,ended:!1,error:"No active session to end."};let n=r.sessions.current;n.endedAt=ae(),n.summary=e;let o=Po(t,{since:n.startedAt});n.eventsInSession=o.length,r.sessions.history.unshift(n),r.sessions.history.length>50&&(r.sessions.history=r.sessions.history.slice(0,50)),r.sessions.current=null;let i={eventId:xe("evt"),type:"session_ended",at:ae(),files:[],summary:`Session ended: ${e.substring(0,100)}`,patchPath:""};return At(t,r,i),{brain:r,ended:!0,session:n}}function wy(t,e="unknown"){let{brain:r,session:n}=MT(t,e),o=r.sessions.history.length>0?r.sessions.history[0]:null,s=0,i=[];if(o&&o.endedAt){let a=Po(t,{since:o.endedAt});s=a.length;let c=a.filter(u=>u.type==="revert_detected");c.length>0&&i.push(`${c.length} revert(s) detected since last session. Verify current state before proceeding.`)}return{brain:r,session:n,lastSession:o,changesSinceLastSession:s,warnings:i}}import DT from"fs";import qT from"path";function nd(t){let e=ke(t),r=e.facts.repo.hasGit?_i(t):null,n=e.specLock.items.filter(o=>o.active!==!1);return{project:{name:e.project.name,root:e.project.root,branch:r?r.branch:"",commit:r?r.commit:""},goal:e.goal.text||"",locks:n.slice(0,15).map(o=>({id:o.id,text:o.text,createdAt:o.createdAt,source:o.source})),decisions:e.decisions.slice(0,12).map(o=>({id:o.id,text:o.text,createdAt:o.createdAt,source:o.source})),deployFacts:{...e.facts.deploy},recentChanges:e.state.recentChanges.slice(0,20),reverts:e.state.reverts.slice(0,10),lastSession:e.sessions.history.length>0?e.sessions.history[0]:null,currentSession:e.sessions.current||null,notes:e.notes.filter(o=>o.pinned).slice(0,10).map(o=>({id:o.id,text:o.text})),generatedAt:ae()}}function od(t){let e=ke(t),r=nd(t),n=qT.join(Ar(t),"context","latest.md"),o=[];if(o.push("# SpecLock Context Pack"),o.push(`> Generated: ${r.generatedAt}`),o.push(`> Project: **${r.project.name}**`),r.project.branch&&o.push(`> Repo: branch \`${r.project.branch}\` @ \`${r.project.commit}\``),o.push(""),o.push("## Goal"),o.push(r.goal||"*(No goal set \u2014 consider setting one)*"),o.push(""),o.push("## SpecLock (Non-Negotiables)"),r.locks.length>0){o.push("> **These constraints MUST be followed. Do not violate any lock.**");for(let c of r.locks)o.push(`- **[LOCK]** ${c.text} _(${c.source}, ${c.createdAt.substring(0,10)})_`)}else o.push("- *(No locks defined \u2014 consider adding constraints)*");if(o.push(""),o.push("## Key Decisions"),r.decisions.length>0)for(let c of r.decisions)o.push(`- **[DEC]** ${c.text} _(${c.source}, ${c.createdAt.substring(0,10)})_`);else o.push("- *(No decisions recorded)*");if(o.push(""),r.deployFacts.provider!=="unknown"&&(o.push("## Deploy Facts"),o.push(`- Provider: **${r.deployFacts.provider}**`),r.deployFacts.branch&&o.push(`- Branch: \`${r.deployFacts.branch}\``),o.push(`- Auto-deploy: ${r.deployFacts.autoDeploy?"Yes":"No"}`),r.deployFacts.url&&o.push(`- URL: ${r.deployFacts.url}`),r.deployFacts.notes&&o.push(`- Notes: ${r.deployFacts.notes}`),o.push("")),o.push("## Recent Changes"),r.recentChanges.length>0)for(let c of r.recentChanges.slice(0,20)){let u=c.files&&c.files.length>0?` (${c.files.join(", ")})`:"";o.push(`- [${c.at.substring(0,19)}] ${c.summary}${u}`)}else o.push("- *(No changes tracked yet)*");if(o.push(""),r.reverts.length>0){o.push("## \u26A0 Reverts Detected"),o.push("> **WARNING: Git reverts/checkouts were detected. Verify current state before proceeding.**");for(let c of r.reverts)o.push(`- [REVERT] ${c.kind} to \`${c.target.substring(0,12)}\` at ${c.at.substring(0,19)}`);o.push("")}if(r.lastSession&&(o.push("## Last Session"),o.push(`- Tool: **${r.lastSession.toolUsed}**`),o.push(`- Ended: ${r.lastSession.endedAt||"still active"}`),r.lastSession.summary&&o.push(`- Summary: ${r.lastSession.summary}`),o.push(`- Events in session: ${r.lastSession.eventsInSession||0}`),o.push("")),r.notes.length>0){o.push("## Pinned Notes");for(let c of r.notes)o.push(`- **[NOTE]** ${c.text}`);o.push("")}o.push("## Agent Instructions"),o.push("1. Follow ALL SpecLock items strictly \u2014 they are non-negotiable."),o.push("2. Do not contradict recorded decisions without explicit user approval."),o.push("3. If you detect drift from constraints, stop and flag it."),o.push("4. Call `speclock_detect_drift` proactively to check for constraint violations."),o.push("5. Call `speclock_get_context` to refresh this context at any time."),o.push("6. Call `speclock_session_summary` before ending your session."),o.push(""),o.push("---"),o.push("*Powered by [SpecLock](https://github.com/sgroy10/speclock) \u2014 Developed by Sandeep Roy*"),o.push("");let s=o.join(`
`);DT.writeFileSync(n,s);let i=xe("evt"),a={eventId:i,type:"context_generated",at:ae(),files:[".speclock/context/latest.md"],summary:"Generated context pack",patchPath:""};return Dr(e,i),Mr(t,a),nr(t,e),s}function LT(t){let e={project:null};for(let r=2;r<t.length;r++)t[r]==="--project"&&t[r+1]&&(e.project=t[r+1],r++);return e}var UT=LT(process.argv),ce=UT.project||process.env.SPECLOCK_PROJECT_ROOT||process.cwd(),sd="1.1.0",id="Sandeep Roy",ve=new hi({name:"speclock",version:sd},{instructions:`SpecLock is an AI continuity engine. Developed by ${id}. Call speclock_session_briefing at the start of a new session, and speclock_session_summary before ending. Use speclock_get_context to refresh your project understanding at any time.`});ve.tool("speclock_init","Initialize SpecLock in the current project directory. Creates .speclock/ with brain.json, events.log, and supporting directories.",{},async()=>{let t=ke(ce);return{content:[{type:"text",text:`SpecLock initialized for "${t.project.name}" at ${t.project.root}`}]}});ve.tool("speclock_get_context","THE KEY TOOL. Returns the full structured context pack including goal, locks, decisions, recent changes, deploy facts, reverts, session history, and notes. Call this at the start of every session or whenever you need to refresh your understanding of the project.",{format:Q.enum(["markdown","json"]).optional().default("markdown").describe("Output format: markdown (readable) or json (structured)")},async({format:t})=>{if(t==="json"){let r=nd(ce);return{content:[{type:"text",text:JSON.stringify(r,null,2)}]}}return{content:[{type:"text",text:od(ce)}]}});ve.tool("speclock_set_goal","Set or update the project goal. This is the high-level objective that guides all work.",{text:Q.string().min(1).describe("The project goal text")},async({text:t})=>(fy(ce,t),{content:[{type:"text",text:`Goal set: "${t}"`}]}));ve.tool("speclock_add_lock","Add a non-negotiable constraint (SpecLock). These are rules that must NEVER be violated during development.",{text:Q.string().min(1).describe("The constraint text"),tags:Q.array(Q.string()).optional().default([]).describe("Category tags"),source:Q.enum(["user","agent"]).optional().default("agent").describe("Who created this lock")},async({text:t,tags:e,source:r})=>{let{lockId:n}=my(ce,t,e,r);return{content:[{type:"text",text:`Lock added (${n}): "${t}"`}]}});ve.tool("speclock_remove_lock","Remove (deactivate) a SpecLock by its ID. The lock is soft-deleted and kept in history.",{lockId:Q.string().min(1).describe("The lock ID to remove")},async({lockId:t})=>{let e=hy(ce,t);return e.removed?{content:[{type:"text",text:`Lock removed: "${e.lockText}"`}]}:{content:[{type:"text",text:e.error}],isError:!0}});ve.tool("speclock_add_decision","Record an architectural or design decision. Decisions guide future work and prevent contradictory changes.",{text:Q.string().min(1).describe("The decision text"),tags:Q.array(Q.string()).optional().default([]),source:Q.enum(["user","agent"]).optional().default("agent")},async({text:t,tags:e,source:r})=>{let{decId:n}=gy(ce,t,e,r);return{content:[{type:"text",text:`Decision recorded (${n}): "${t}"`}]}});ve.tool("speclock_add_note","Add a pinned note for reference. Notes persist across sessions as reminders.",{text:Q.string().min(1).describe("The note text"),pinned:Q.boolean().optional().default(!0).describe("Whether to pin this note in context")},async({text:t,pinned:e})=>{let{noteId:r}=yy(ce,t,e);return{content:[{type:"text",text:`Note added (${r}): "${t}"`}]}});ve.tool("speclock_set_deploy_facts","Record deployment configuration facts (provider, branch, auto-deploy settings).",{provider:Q.string().optional().describe("Deploy provider (vercel, railway, aws, netlify, etc.)"),branch:Q.string().optional().describe("Deploy branch"),autoDeploy:Q.boolean().optional().describe("Whether auto-deploy is enabled"),url:Q.string().optional().describe("Deployment URL"),notes:Q.string().optional().describe("Additional deploy notes")},async t=>(_y(ce,t),{content:[{type:"text",text:"Deploy facts updated."}]}));ve.tool("speclock_log_change","Manually log a significant change. Use this when you make an important modification that should be tracked in the context.",{summary:Q.string().min(1).describe("Brief description of the change"),files:Q.array(Q.string()).optional().default([]).describe("Files affected")},async({summary:t,files:e})=>{let{eventId:r}=vy(ce,t,e);return{content:[{type:"text",text:`Change logged (${r}): "${t}"`}]}});ve.tool("speclock_get_changes","Get recent file changes tracked by SpecLock.",{limit:Q.number().int().min(1).max(100).optional().default(20)},async({limit:t})=>{let e=To(ce);if(!e)return{content:[{type:"text",text:"SpecLock not initialized. Run speclock_init first."}],isError:!0};let r=e.state.recentChanges.slice(0,t);if(r.length===0)return{content:[{type:"text",text:"No changes tracked yet."}]};let n=r.map(o=>{let s=o.files&&o.files.length>0?` (${o.files.join(", ")})`:"";return`- [${o.at.substring(0,19)}] ${o.summary}${s}`}).join(`
`);return{content:[{type:"text",text:`Recent changes (${r.length}):
${n}`}]}});ve.tool("speclock_get_events","Get the event log, optionally filtered by type. Event types: init, goal_updated, lock_added, lock_removed, decision_added, note_added, fact_updated, file_created, file_changed, file_deleted, revert_detected, context_generated, session_started, session_ended, manual_change, checkpoint_created.",{type:Q.string().optional().describe("Filter by event type"),limit:Q.number().int().min(1).max(200).optional().default(50),since:Q.string().optional().describe("ISO timestamp; only return events after this time")},async({type:t,limit:e,since:r})=>{let n=Po(ce,{type:t,limit:e,since:r});if(n.length===0)return{content:[{type:"text",text:"No events found."}]};let o=n.map(s=>`- [${s.at.substring(0,19)}] ${s.type}: ${s.summary||""}`).join(`
`);return{content:[{type:"text",text:`Events (${n.length}):
${o}`}]}});ve.tool("speclock_check_conflict","Check if a proposed action conflicts with any active SpecLock. Use before making significant changes.",{proposedAction:Q.string().min(1).describe("Description of the action you plan to take")},async({proposedAction:t})=>({content:[{type:"text",text:xy(ce,t).analysis}]}));ve.tool("speclock_session_briefing","Start a new session and get a full briefing. Returns context pack plus what happened since the last session. Call this at the very beginning of a new conversation.",{toolName:Q.enum(["claude-code","cursor","codex","windsurf","cline","unknown"]).optional().default("unknown").describe("Which AI tool is being used")},async({toolName:t})=>{let e=wy(ce,t),r=od(ce),n=[];if(n.push("# SpecLock Session Briefing"),n.push(`Session started (${t}). ID: ${e.session.id}`),n.push(""),e.lastSession&&(n.push("## Last Session"),n.push(`- Tool: **${e.lastSession.toolUsed}**`),n.push(`- Ended: ${e.lastSession.endedAt||"unknown"}`),e.lastSession.summary&&n.push(`- Summary: ${e.lastSession.summary}`),n.push(`- Events: ${e.lastSession.eventsInSession||0}`),n.push(`- Changes since then: ${e.changesSinceLastSession}`),n.push("")),e.warnings.length>0){n.push("## \u26A0 Warnings");for(let o of e.warnings)n.push(`- ${o}`);n.push("")}return n.push("---"),n.push(r),{content:[{type:"text",text:n.join(`
`)}]}});ve.tool("speclock_session_summary","End the current session and record what was accomplished. Call this before ending a conversation.",{summary:Q.string().min(1).describe("Summary of what was accomplished in this session")},async({summary:t})=>{let e=ky(ce,t);if(!e.ended)return{content:[{type:"text",text:e.error}],isError:!0};let r=e.session;return{content:[{type:"text",text:`Session ended. Duration: ${r.startedAt&&r.endedAt?Math.round((new Date(r.endedAt)-new Date(r.startedAt))/6e4):0} min. Events: ${r.eventsInSession}. Summary: "${t}"`}]}});ve.tool("speclock_checkpoint","Create a named git tag checkpoint for easy rollback.",{name:Q.string().min(1).describe("Checkpoint name (alphanumeric, hyphens, underscores)")},async({name:t})=>{let r=`sl_${t.replace(/[^a-zA-Z0-9_-]/g,"_")}_${Date.now()}`,n=ly(ce,r);if(!n.ok)return{content:[{type:"text",text:`Failed to create checkpoint: ${n.error}`}],isError:!0};let o=To(ce);if(o){let s=xe("evt"),i={eventId:s,type:"checkpoint_created",at:ae(),files:[],summary:`Checkpoint: ${r}`,patchPath:""};Dr(o,s),Mr(ce,i),nr(ce,o)}return{content:[{type:"text",text:`Checkpoint created: ${r}`}]}});ve.tool("speclock_repo_status","Get current git repository status including branch, commit, changed files, and diff summary.",{},async()=>{let t=_i(ce),e=dy(ce),r=[`Branch: ${t.branch}`,`Commit: ${t.commit}`,"",`Changed files (${t.changedFiles.length}):`];if(t.changedFiles.length>0)for(let n of t.changedFiles)r.push(`  ${n.status} ${n.file}`);else r.push("  (clean working tree)");return e&&(r.push(""),r.push("Diff summary:"),r.push(e)),{content:[{type:"text",text:r.join(`
`)}]}});ve.tool("speclock_suggest_locks","Analyze project decisions, notes, and patterns to suggest new SpecLock constraints. Returns auto-generated lock suggestions based on commitment language, prohibitive patterns, and common best practices.",{},async()=>{let t=by(ce);if(t.suggestions.length===0)return{content:[{type:"text",text:`No suggestions at this time. You have ${t.totalLocks} active lock(s). Add more decisions and notes to get AI-powered lock suggestions.`}]};let e=t.suggestions.map((r,n)=>`${n+1}. **"${r.text}"**
   Source: ${r.source}${r.sourceId?` (${r.sourceId})`:""}
   Reason: ${r.reason}`).join(`

`);return{content:[{type:"text",text:`## Lock Suggestions (${t.suggestions.length})

Current active locks: ${t.totalLocks}

${e}

To add any suggestion as a lock, call \`speclock_add_lock\` with the text.`}]}});ve.tool("speclock_detect_drift","Scan recent changes and events against active SpecLock constraints to detect potential violations or drift. Use this proactively to ensure project integrity.",{},async()=>{let t=$y(ce);if(t.status==="no_locks")return{content:[{type:"text",text:t.message}]};if(t.status==="clean")return{content:[{type:"text",text:t.message}]};let e=t.drifts.map(r=>`- [${r.severity.toUpperCase()}] Change: "${r.changeSummary}" (${r.changeAt.substring(0,19)})
  Lock: "${r.lockText}"
  Matched: ${r.matchedTerms.join(", ")}`).join(`

`);return{content:[{type:"text",text:`## Drift Report

${t.message}

${e}

Review each drift and take corrective action if needed.`}]}});ve.tool("speclock_health","Get a health check of the SpecLock setup including completeness score, missing recommended items, and multi-agent session timeline.",{},async()=>{let t=ke(ce),e=t.specLock.items.filter(a=>a.active!==!1),r=0,n=[];t.goal.text?(r+=20,n.push("[PASS] Goal is set")):n.push("[MISS] No project goal set"),e.length>0?(r+=25,n.push(`[PASS] ${e.length} active lock(s)`)):n.push("[MISS] No SpecLock constraints defined"),t.decisions.length>0?(r+=15,n.push(`[PASS] ${t.decisions.length} decision(s) recorded`)):n.push("[MISS] No decisions recorded"),t.notes.length>0?(r+=10,n.push(`[PASS] ${t.notes.length} note(s)`)):n.push("[MISS] No notes added"),t.sessions.history.length>0?(r+=15,n.push(`[PASS] ${t.sessions.history.length} session(s) in history`)):n.push("[MISS] No session history yet"),t.state.recentChanges.length>0?(r+=10,n.push(`[PASS] ${t.state.recentChanges.length} change(s) tracked`)):n.push("[MISS] No changes tracked"),t.facts.deploy.provider!=="unknown"?(r+=5,n.push("[PASS] Deploy facts configured")):n.push("[MISS] Deploy facts not configured");let o={};for(let a of t.sessions.history){let c=a.toolUsed||"unknown";o[c]||(o[c]={count:0,lastUsed:"",summaries:[]}),o[c].count++,(!o[c].lastUsed||a.endedAt>o[c].lastUsed)&&(o[c].lastUsed=a.endedAt||a.startedAt),a.summary&&o[c].summaries.length<3&&o[c].summaries.push(a.summary.substring(0,80))}let s="";Object.keys(o).length>0&&(s=`

## Multi-Agent Timeline
`+Object.entries(o).map(([a,c])=>`- **${a}**: ${c.count} session(s), last active ${c.lastUsed?c.lastUsed.substring(0,16):"unknown"}
  Recent: ${c.summaries.length>0?c.summaries.map(u=>`"${u}"`).join(", "):"(no summaries)"}`).join(`
`));let i=r>=80?"A":r>=60?"B":r>=40?"C":r>=20?"D":"F";return{content:[{type:"text",text:`## SpecLock Health Check

Score: **${r}/100** (Grade: ${i})
Events: ${t.events.count} | Reverts: ${t.state.reverts.length}

### Checks
${n.join(`
`)}${s}

---
*SpecLock v${sd} \u2014 Developed by ${id}*`}]}});function VT(){return ve}var FT=typeof import.meta.url>"u";if(!FT){let t=new yi;ve.connect(t).then(()=>{process.stderr.write(`SpecLock MCP v${sd} running (stdio) \u2014 Developed by ${id}. Root: ${ce}${Sy.EOL}`)}).catch(e=>{process.stderr.write(`SpecLock fatal: ${e.message}${Sy.EOL}`),process.exit(1)})}export{VT as default};
//# sourceMappingURL=module.js.map
